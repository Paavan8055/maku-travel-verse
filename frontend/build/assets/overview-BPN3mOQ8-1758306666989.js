import{r as f,s as g,l as u,j as e,B as j,R as p,a as n,f as i,g as l,e as c}from"./index-B3Fp9pX--1758306666989.js";import{U as N}from"./users-Bzs_S0Lp-1758306666989.js";import{B as v}from"./building-CgZCT1_4-1758306666989.js";import{C as y}from"./credit-card-BqiIPhj6-1758306666989.js";import{T as b}from"./trending-up-92MsR2-B-1758306666989.js";const w=()=>{const[s,d]=f.useState(null),[o,a]=f.useState(!0),[m,r]=f.useState(null),x=async()=>{try{a(!0),r(null);const{data:t,error:h}=await g.functions.invoke("admin-metrics");if(h)throw h;if(!t.success)throw new Error(t.error||"Failed to fetch admin metrics");d(t.data),u.info("Admin metrics loaded successfully")}catch(t){const h=t instanceof Error?t.message:"Failed to fetch admin metrics";r(h),u.error("Error fetching admin metrics:",t)}finally{a(!1)}};return f.useEffect(()=>{x()},[]),{metrics:s,loading:o,error:m,refetch:x}},E=()=>{const{metrics:s,loading:d,error:o,refetch:a}=w();return d?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):o?e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-destructive mb-4",children:"Error Loading Dashboard"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:o}),e.jsx(j,{onClick:a,children:"Try Again"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard Overview"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor key metrics and system performance"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Last updated: ",s!=null&&s.lastUpdated?new Date(s.lastUpdated).toLocaleString():"Never"]}),e.jsxs(j,{variant:"outline",size:"sm",onClick:a,className:"gap-2",children:[e.jsx(p,{className:d?"h-4 w-4 animate-spin":"h-4 w-4"}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(n,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(N,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(c,{children:e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.totalUsers)||0})})]}),e.jsxs(n,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Total Bookings"}),e.jsx(v,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(c,{children:e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.totalBookings)||0})})]}),e.jsxs(n,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Total Revenue"}),e.jsx(y,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(c,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["$",((s==null?void 0:s.totalRevenue)||0).toLocaleString()]})})]}),e.jsxs(n,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Active Properties"}),e.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(c,{children:e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.activeProperties)||0})})]})]}),e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(l,{children:"System Overview"})}),e.jsxs(c,{className:"space-y-4",children:[e.jsx("p",{children:"Welcome to the MAKU Travel admin dashboard. Monitor system health and key metrics here."}),(()=>{const m=Array.isArray(s==null?void 0:s.recentBookings)?s.recentBookings:typeof(s==null?void 0:s.recentBookings)=="string"?(()=>{try{return JSON.parse(s.recentBookings)}catch{return[]}})():[];return m.length>0?e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Recent Bookings"}),e.jsx("div",{className:"space-y-2",children:m.slice(0,5).map((r,x)=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-muted/50 rounded",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-sm",children:r.booking_reference||"N/A"}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:r.booking_type||"Unknown"})]}),e.jsxs("div",{className:"text-sm",children:[r.currency||"USD"," ",r.total_amount||"0.00"]})]},r.id||x))})]}):e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Recent Bookings"}),e.jsx("p",{className:"text-muted-foreground",children:"No recent bookings found."})]})})()]})]})]})};export{E as default};
