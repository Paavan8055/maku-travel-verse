import{r as o,y as _,j as e,af as f,B as D,i as n,t as i,Q as u,G as g,a2 as k,k as A,l as L,m as $,n as F,ac as P,ae as T,I as N,a7 as w}from"./index-BuFvfeSJ-1758786228561.js";import{L as m}from"./label-DYU-yWis-1758786228561.js";import{T as U}from"./textarea-Uko5zEQl-1758786228561.js";import{S as z}from"./switch-N83iNywX-1758786228561.js";import{D as C}from"./database-DFXX4YlU-1758786228561.js";import{S as B}from"./server-CV8qdYMI-1758786228561.js";import"./index-CJWzJC_R-1758786228561.js";const M=()=>{const[a,j]=o.useState([]),[b,y]=o.useState(!0),[d,v]=o.useState({}),{toast:x}=_(),p=async()=>{try{const{data:s,error:r}=await w.from("api_configuration").select("*").order("created_at",{ascending:!1});if(r)throw r;j(s||[])}catch(s){x({title:"Failed to load environment configuration",description:s instanceof Error?s.message:"Unknown error",variant:"destructive"})}finally{y(!1)}},l=async(s,r)=>{v(t=>({...t,[s]:!0}));try{const{error:t}=await w.from("api_configuration").update(r).eq("id",s);if(t)throw t;j(c=>c.map(h=>h.id===s?{...h,...r}:h)),x({title:"Configuration updated",description:"Environment settings saved successfully"})}catch(t){x({title:"Failed to update configuration",description:t instanceof Error?t.message:"Unknown error",variant:"destructive"})}finally{v(t=>({...t,[s]:!1}))}},S=s=>{switch(s){case"production":return"bg-destructive text-destructive-foreground";case"staging":return"bg-warning text-warning-foreground";case"test":return"bg-secondary text-secondary-foreground";default:return"bg-muted text-muted-foreground"}},E=s=>{switch(s.toLowerCase()){case"amadeus":case"sabre":case"hotelbeds":return g;case"stripe":return u;case"database":return C;default:return B}};return o.useEffect(()=>{p()},[]),b?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(f,{className:"w-6 h-6 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Environment Configuration"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage API configurations across different environments"})]}),e.jsxs(D,{onClick:p,variant:"outline",size:"sm",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(n,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Total Configs"}),e.jsx("p",{className:"text-2xl font-bold",children:a.length})]})]})})}),e.jsx(n,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Active Configs"}),e.jsx("p",{className:"text-2xl font-bold text-success",children:a.filter(s=>s.is_active).length})]})]})})}),e.jsx(n,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Environments"}),e.jsx("p",{className:"text-2xl font-bold",children:new Set(a.map(s=>s.environment)).size})]})]})})})]}),e.jsx("div",{className:"grid gap-6",children:a.length===0?e.jsx(n,{children:e.jsx(i,{className:"py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(k,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No configurations found"}),e.jsx("p",{className:"text-muted-foreground",children:"Environment configurations will appear here when they are created"})]})})}):a.map(s=>{const r=E(s.provider);return e.jsxs(n,{children:[e.jsx(A,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"w-6 h-6"}),e.jsxs("div",{children:[e.jsx(L,{children:s.provider.toUpperCase()}),e.jsxs($,{children:[s.provider," API configuration"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(F,{className:S(s.environment),children:s.environment}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{checked:s.is_active,onCheckedChange:t=>l(s.id,{is_active:t}),disabled:d[s.id]}),e.jsx(m,{children:"Active"})]})]})]})}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs(P,{children:[e.jsx(u,{className:"w-4 h-4"}),e.jsx(T,{children:"Configuration data is encrypted and secure. Only authorized administrators can view sensitive values."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:`env-${s.id}`,children:"Environment"}),e.jsx(N,{id:`env-${s.id}`,value:s.environment,onChange:t=>l(s.id,{environment:t.target.value}),disabled:d[s.id]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:`provider-${s.id}`,children:"Provider"}),e.jsx(N,{id:`provider-${s.id}`,value:s.provider,onChange:t=>l(s.id,{provider:t.target.value}),disabled:d[s.id]})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:`config-${s.id}`,children:"Configuration Data"}),e.jsx(U,{id:`config-${s.id}`,value:JSON.stringify(s.config_data,null,2),onChange:t=>{try{const c=JSON.parse(t.target.value);l(s.id,{config_data:c})}catch{}},rows:6,className:"font-mono text-sm",disabled:d[s.id]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Created: ",new Date(s.created_at).toLocaleString()]}),e.jsxs("p",{children:["Updated: ",new Date(s.updated_at).toLocaleString()]})]})]})]},s.id)})})]})};export{M as EnvironmentConfiguration};
