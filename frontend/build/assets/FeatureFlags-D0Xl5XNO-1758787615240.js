import{c as b,r,t as F,j as e,ac as u,B as c,k as h,l as j,n as C,o as _,v as k,p as S,U as A,X as E,a9 as U,ab as D,a2 as g}from"./index-sjMrv3Ur-1758787615240.js";import{S as L}from"./switch-Ds2-NbwT-1758787615240.js";import{L as B}from"./label-BgKM8khV-1758787615240.js";import{P as f}from"./plus-CjgYYBK0-1758787615240.js";import{P}from"./percent-BeZVyLOD-1758787615240.js";import"./index-Ds7e5B5O-1758787615240.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p=b("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]),H=()=>{const[l,d]=r.useState([]),[N,v]=r.useState(!0),[o,m]=r.useState({}),{toast:i}=F(),x=async()=>{try{const{data:s,error:a}=await g.from("feature_flags").select("*").order("created_at",{ascending:!1});if(a)throw a;d(s||[])}catch(s){i({title:"Failed to load feature flags",description:s instanceof Error?s.message:"Unknown error",variant:"destructive"})}finally{v(!1)}},w=async(s,a)=>{m(t=>({...t,[s]:!0}));try{const{error:t}=await g.from("feature_flags").update({enabled:a}).eq("id",s);if(t)throw t;d(y=>y.map(n=>n.id===s?{...n,enabled:a}:n)),i({title:"Feature flag updated",description:`Flag ${a?"enabled":"disabled"} successfully`})}catch(t){i({title:"Failed to update feature flag",description:t instanceof Error?t.message:"Unknown error",variant:"destructive"})}finally{m(t=>({...t,[s]:!1}))}};return r.useEffect(()=>{x()},[]),N?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(u,{className:"w-6 h-6 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Feature Flags"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage feature rollouts and A/B testing"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{onClick:x,variant:"outline",size:"sm",children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(c,{size:"sm",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"New Flag"]})]})]}),l.length===0?e.jsx(h,{children:e.jsx(j,{className:"py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(p,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No feature flags configured"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first feature flag to start managing feature rollouts"}),e.jsxs(c,{children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Create Feature Flag"]})]})})}):e.jsx("div",{className:"grid gap-4",children:l.map(s=>e.jsxs(h,{children:[e.jsx(C,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-5 h-5"}),s.flag_name]}),e.jsx(k,{children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(S,{variant:s.enabled?"default":"secondary",children:s.enabled?"Enabled":"Disabled"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{id:`flag-${s.id}`,checked:s.enabled,onCheckedChange:a=>w(s.id,a),disabled:o[s.id]}),e.jsx(B,{htmlFor:`flag-${s.id}`,children:o[s.id]?"Updating...":"Active"})]})]})]})}),e.jsxs(j,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:["Rollout: ",s.rollout_percentage,"%"]})]}),s.target_users&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:["Targeted users: ",Array.isArray(s.target_users)?s.target_users.length:"Custom"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:["Created: ",new Date(s.created_at).toLocaleDateString()]})]})]}),s.conditions&&e.jsx(U,{className:"mt-4",children:e.jsxs(D,{children:[e.jsx("strong",{children:"Conditions:"})," ",JSON.stringify(s.conditions)]})})]})]},s.id))})]})};export{H as FeatureFlags};
