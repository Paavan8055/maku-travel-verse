var xe=Object.defineProperty;var ve=(n,e,t)=>e in n?xe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var g=(n,e,t)=>ve(n,typeof e!="symbol"?e+"":e,t);import{a7 as D,r as y,y as le,j as i,n as I,h as Y,a6 as V,B as Q,af as we,ac as be,ae as De,i as E,k as ke,l as _e,t as P,I as Se}from"./index-BuFvfeSJ-1758786228561.js";import{T as Ae,a as Te,b as q,c as F}from"./tabs-DEiRDxHt-1758786228561.js";import{S as G,a as K,b as Z,c as ee,d as S}from"./select-D-JCiAP4-1758786228561.js";import{T as te,a as se,b as M,c as A,d as ae,e as _}from"./table-Cv2_jGcP-1758786228561.js";import{o as re,e as je,s as O,n as z}from"./types-BekIk3NQ-1758786228561.js";import{u as Ie,a as Me}from"./useEnhancedLogging-BocHBIgH-1758786228561.js";import{u as Ne}from"./usePerformanceOptimizer-BjkAg5pG-1758786228561.js";import{A as Ce}from"./activity-C11w7_sb-1758786228561.js";import{S as $e}from"./search-D1MIMbFs-1758786228561.js";import{t as j,c as Re,n as ue,g as Ee,e as Pe,b as ie,h as ne,i as U}from"./en-US-CC7XSppg-1758786228561.js";import{e as Oe,d as Ue}from"./endOfMonth-DFXtxHJ8-1758786228561.js";import{I as oe}from"./info-Dlbh3Fuy-1758786228561.js";import{C as Le}from"./circle-check-big-BBkEe5Dt-1758786228561.js";import{C as We}from"./circle-x-Cw7Qn9sk-1758786228561.js";import"./index-BdQq_4o_-1758786228561.js";import"./index-CJWzJC_R-1758786228561.js";import"./correlationId-D_3F8vgX-1758786228561.js";function L(n,e){const t=+j(n)-+j(e);return t<0?-1:t>0?1:t}function He(n){return Re(n,Date.now())}function Be(n){return e=>{const s=(n?Math[n]:Math.trunc)(e);return s===0?0:s}}function Ye(n,e){return+j(n)-+j(e)}function qe(n,e){const t=j(n,e==null?void 0:e.in);return t.setHours(23,59,59,999),t}function Fe(n,e){const t=j(n,e==null?void 0:e.in);return+qe(t,e)==+Oe(t,e)}function ze(n,e,t){const[s,a,r]=ue(t==null?void 0:t.in,n,n,e),c=L(a,r),o=Math.abs(Ue(a,r));if(o<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-c*o);let d=L(a,r)===-c;Fe(s)&&o===1&&L(s,r)===1&&(d=!1);const u=c*(o-+d);return u===0?0:u}function Je(n,e,t){const s=Ye(n,e)/1e3;return Be(t==null?void 0:t.roundingMethod)(s)}function Xe(n,e,t){var k,T;const s=Ee(),a=(T=(k=t==null?void 0:t.locale)!=null?k:s.locale)!=null?T:Pe,r=2520,c=L(n,e);if(isNaN(c))throw new RangeError("Invalid time value");const o=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:c}),[d,u]=ue(t==null?void 0:t.in,...c>0?[e,n]:[n,e]),h=Je(u,d),N=(ie(u)-ie(d))/1e3,f=Math.round((h-N)/60);let w;if(f<2)return t!=null&&t.includeSeconds?h<5?a.formatDistance("lessThanXSeconds",5,o):h<10?a.formatDistance("lessThanXSeconds",10,o):h<20?a.formatDistance("lessThanXSeconds",20,o):h<40?a.formatDistance("halfAMinute",0,o):h<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):f===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",f,o);if(f<45)return a.formatDistance("xMinutes",f,o);if(f<90)return a.formatDistance("aboutXHours",1,o);if(f<ne){const v=Math.round(f/60);return a.formatDistance("aboutXHours",v,o)}else{if(f<r)return a.formatDistance("xDays",1,o);if(f<U){const v=Math.round(f/ne);return a.formatDistance("xDays",v,o)}else if(f<U*2)return w=Math.round(f/U),a.formatDistance("aboutXMonths",w,o)}if(w=ze(u,d),w<12){const v=Math.round(f/U);return a.formatDistance("xMonths",v,o)}else{const v=w%12,b=Math.trunc(w/12);return v<3?a.formatDistance("aboutXYears",b,o):v<9?a.formatDistance("overXYears",b,o):a.formatDistance("almostXYears",b+1,o)}}function ce(n,e){return Xe(n,He(n),e)}class Ve{constructor(){g(this,"tools",new Map);g(this,"metrics",new Map);g(this,"categories",new Map)}register(e){this.tools.set(e.definition.name,e),this.metrics.set(e.definition.name,{toolName:e.definition.name,executionCount:0,averageExecutionTime:0,successRate:1,lastExecuted:new Date,errorCounts:{}});const t=e.definition.category||"general";this.categories.has(t)||this.categories.set(t,[]),this.categories.get(t).push(e.definition.name)}unregister(e){return this.tools.delete(e)}get(e){return this.tools.get(e)}getByCategory(e){return(this.categories.get(e)||[]).map(s=>this.tools.get(s)).filter(Boolean)}getAllDefinitions(){return Array.from(this.tools.values()).map(e=>e.definition)}getAvailableTools(e){return this.getAllDefinitions()}updateMetrics(e,t,s,a){const r=this.metrics.get(e);r&&(r.executionCount++,r.averageExecutionTime=(r.averageExecutionTime*(r.executionCount-1)+t)/r.executionCount,r.successRate=(r.successRate*(r.executionCount-1)+(s?1:0))/r.executionCount,r.lastExecuted=new Date,!s&&a&&(r.errorCounts[a]=(r.errorCounts[a]||0)+1))}getMetrics(e){return e?this.metrics.get(e)||this.createEmptyMetrics(e):Array.from(this.metrics.values())}createEmptyMetrics(e){return{toolName:e,executionCount:0,averageExecutionTime:0,successRate:0,lastExecuted:new Date(0),errorCounts:{}}}getOpenAITools(){return this.getAllDefinitions().map(e=>({type:"function",function:{name:e.name,description:e.description,parameters:e.parameters}}))}}const x=new Ve;class de{constructor(){g(this,"maxRetries",3);g(this,"retryDelay",1e3)}async execute(e,t,s){const a=Date.now(),r=x.get(e.function.name);if(!r){const u={id:e.id,success:!1,result:null,error:`Tool '${e.function.name}' not found`,executionTime:Date.now()-a};return this.logExecution(e,u,t),u}let c;try{c=JSON.parse(e.function.arguments)}catch(u){const h={id:e.id,success:!1,result:null,error:`Invalid parameters: ${u.message}`,executionTime:Date.now()-a};return this.logExecution(e,h,t),h}if(r.validate&&!r.validate(c)){const u={id:e.id,success:!1,result:null,error:"Parameter validation failed",executionTime:Date.now()-a};return this.logExecution(e,u,t),u}let o;for(let u=0;u<this.maxRetries;u++)try{const h=await r.execute(c,{...t,standardizedContext:s,attempt:u+1});return h.executionTime=Date.now()-a,s&&s.addToolResult(e.id,h.result,h.success,h.error),this.logExecution(e,h,t),x.updateMetrics(e.function.name,h.executionTime,h.success,h.error),h}catch(h){o=h,u<this.maxRetries-1&&await this.delay(this.retryDelay*Math.pow(2,u))}const d={id:e.id,success:!1,result:null,error:`Tool execution failed after ${this.maxRetries} attempts: ${(o==null?void 0:o.message)||"Unknown error"}`,executionTime:Date.now()-a};return this.logExecution(e,d,t),x.updateMetrics(e.function.name,d.executionTime,!1,d.error),d}async executeMultiple(e,t,s){const a=e.map(r=>this.execute(r,t,s));return Promise.all(a)}logExecution(e,t,s){console.log(`Tool Execution: ${e.function.name}`,{toolCallId:e.id,agentId:s.agentId,success:t.success,executionTime:t.executionTime,error:t.error})}delay(e){return new Promise(t=>setTimeout(t,e))}async executeBatch(e,t,s){const a=[],r=[...e];for(;r.length>0;){const c=[],o=[];for(const u of r){const h=x.get(u.function.name);!h||!h.definition.dependencies||h.definition.dependencies.length===0||h.definition.dependencies.every(f=>a.some(w=>{var k;return w.success&&((k=e.find(T=>T.id===w.id))==null?void 0:k.function.name)===f}))?c.push(u):o.push(u)}if(c.length===0)throw new Error("Circular dependency detected or missing required tools");const d=await this.executeMultiple(c,t,s);a.push(...d),r.splice(0,r.length,...o)}return a}}class Qe{constructor(e,t){g(this,"executor");g(this,"definition");g(this,"executionHistory",[]);this.definition=e,this.executor=t||new de}async execute(e,t,s){const a=[];this.executionHistory=[];try{for(let r=0;r<this.definition.steps.length;r++){const c=this.definition.steps[r];if(c.condition&&!c.condition(a)){console.log(`Skipping step ${r+1}: condition not met`);continue}let o=c.parameters;if(c.mapPreviousResult&&a.length>0){const h=c.mapPreviousResult(a);o={...o,...h}}(r===0||!c.mapPreviousResult)&&(o={...e,...o});const d={id:`chain_${this.definition.id}_step_${r+1}`,type:"function",function:{name:c.toolName,arguments:JSON.stringify(o)}},u=await this.executor.execute(d,t,s);if(a.push(u),this.executionHistory.push([u]),!u.success&&this.definition.rollbackOnFailure)throw await this.rollback(t,s),new Error(`Chain execution failed at step ${r+1}: ${u.error}`);s&&s.setSharedData(`chain_${this.definition.id}_progress`,{currentStep:r+1,totalSteps:this.definition.steps.length,completed:(r+1)/this.definition.steps.length,results:a.map(h=>({success:h.success,error:h.error}))})}return a}catch(r){throw this.definition.rollbackOnFailure&&await this.rollback(t,s),r}}async rollback(e,t){console.log(`Rolling back chain ${this.definition.id}`),t&&t.setSharedData(`chain_${this.definition.id}_rollback`,{timestamp:new Date().toISOString(),steps_rolled_back:this.executionHistory.length})}getProgress(){return{current:this.executionHistory.length,total:this.definition.steps.length,percentage:this.executionHistory.length/this.definition.steps.length*100}}getResults(){return this.executionHistory.flat()}}class Ge{constructor(){g(this,"chains",new Map)}register(e){this.chains.set(e.id,e)}get(e){return this.chains.get(e)}createChain(e,t){const s=this.get(e);return s?new Qe(s,t):null}getAllChains(){return Array.from(this.chains.values())}}const W=new Ge,Ke={definition:{name:"search_flights",description:"Search for flight options between two destinations",parameters:{type:"object",properties:{origin:{type:"string",description:"Origin airport code (IATA)"},destination:{type:"string",description:"Destination airport code (IATA)"},departureDate:{type:"string",description:"Departure date in ISO format (YYYY-MM-DD)"},returnDate:{type:"string",description:"Return date in ISO format (YYYY-MM-DD), optional for one-way"},passengers:{type:"object",description:"Passenger counts",properties:{adults:{type:"number",description:"Number of adults"},children:{type:"number",description:"Number of children"},infants:{type:"number",description:"Number of infants"}}},cabin:{type:"string",description:"Cabin class preference",enum:["economy","premium_economy","business","first"]}},required:["origin","destination","departureDate","passengers"]},category:"travel"},schema:re({origin:O().length(3),destination:O().length(3),departureDate:O(),returnDate:O().optional(),passengers:re({adults:z().min(1),children:z().min(0),infants:z().min(0)}),cabin:je(["economy","premium_economy","business","first"]).optional()}),async execute(n,e){var t;try{const{data:s,error:a}=await D.functions.invoke("unified-search",{body:{type:"flight",query:{origin:n.origin,destination:n.destination,departureDate:n.departureDate,returnDate:n.returnDate,adults:n.passengers.adults,children:n.passengers.children||0,infants:n.passengers.infants||0,cabin:n.cabin||"economy"}}});if(a)throw a;return{id:(e==null?void 0:e.toolCallId)||crypto.randomUUID(),success:!0,result:{flights:s.flights||[],searchId:s.searchId,totalResults:((t=s.flights)==null?void 0:t.length)||0}}}catch(s){return{id:(e==null?void 0:e.toolCallId)||crypto.randomUUID(),success:!1,result:null,error:`Flight search failed: ${s.message}`}}}},Ze={definition:{name:"search_hotels",description:"Search for hotel accommodations in a destination",parameters:{type:"object",properties:{destination:{type:"string",description:"Destination city or hotel name"},checkIn:{type:"string",description:"Check-in date in ISO format (YYYY-MM-DD)"},checkOut:{type:"string",description:"Check-out date in ISO format (YYYY-MM-DD)"},guests:{type:"object",description:"Guest information",properties:{adults:{type:"number",description:"Number of adults"},children:{type:"number",description:"Number of children"},rooms:{type:"number",description:"Number of rooms"}}},filters:{type:"object",description:"Search filters",properties:{minPrice:{type:"number",description:"Minimum price per night"},maxPrice:{type:"number",description:"Maximum price per night"},stars:{type:"array",description:"Hotel star ratings"},amenities:{type:"array",description:"Required amenities"}}}},required:["destination","checkIn","checkOut","guests"]},category:"travel"},async execute(n,e){var t;try{const{data:s,error:a}=await D.functions.invoke("unified-search",{body:{type:"hotel",query:{destination:n.destination,checkIn:n.checkIn,checkOut:n.checkOut,adults:n.guests.adults,children:n.guests.children||0,rooms:n.guests.rooms||1,...n.filters}}});if(a)throw a;return{id:(e==null?void 0:e.toolCallId)||crypto.randomUUID(),success:!0,result:{hotels:s.hotels||[],searchId:s.searchId,totalResults:((t=s.hotels)==null?void 0:t.length)||0}}}catch(s){return{id:(e==null?void 0:e.toolCallId)||crypto.randomUUID(),success:!1,result:null,error:`Hotel search failed: ${s.message}`}}}},et={definition:{name:"get_booking_status",description:"Get the current status of a booking",parameters:{type:"object",properties:{bookingReference:{type:"string",description:"Booking reference number"},bookingType:{type:"string",description:"Type of booking",enum:["flight","hotel","activity","transfer"]}},required:["bookingReference"]},category:"booking"},async execute(n,e){try{const{data:t,error:s}=await D.from("bookings").select(`
          id,
          booking_reference,
          status,
          booking_type,
          total_amount,
          currency,
          booking_data,
          created_at,
          updated_at
        `).eq("booking_reference",n.bookingReference).single();if(s)throw s;return{id:(e==null?void 0:e.toolCallId)||crypto.randomUUID(),success:!0,result:{booking:t,status:t.status,reference:t.booking_reference}}}catch(t){return{id:(e==null?void 0:e.toolCallId)||crypto.randomUUID(),success:!1,result:null,error:`Failed to get booking status: ${t.message}`}}}},tt={definition:{name:"search_activities",description:"Search for activities and experiences in a destination",parameters:{type:"object",properties:{destination:{type:"string",description:"Destination city or location"},dateFrom:{type:"string",description:"Start date for activities (YYYY-MM-DD)"},dateTo:{type:"string",description:"End date for activities (YYYY-MM-DD)"},category:{type:"string",description:"Activity category",enum:["cultural","adventure","nature","food","entertainment","sports"]},participants:{type:"number",description:"Number of participants"}},required:["destination","dateFrom"]},category:"travel"},async execute(n,e){var t;try{const{data:s,error:a}=await D.functions.invoke("unified-search",{body:{type:"activity",query:{destination:n.destination,dateFrom:n.dateFrom,dateTo:n.dateTo,category:n.category,participants:n.participants||1}}});if(a)throw a;return{id:(e==null?void 0:e.toolCallId)||crypto.randomUUID(),success:!0,result:{activities:s.activities||[],searchId:s.searchId,totalResults:((t=s.activities)==null?void 0:t.length)||0}}}catch(s){return{id:(e==null?void 0:e.toolCallId)||crypto.randomUUID(),success:!1,result:null,error:`Activity search failed: ${s.message}`}}}};x.register(Ke);x.register(Ze);x.register(et);x.register(tt);const st={id:"travel_planning",name:"Complete Travel Planning",description:"Search flights, hotels, and activities for a complete trip",steps:[{toolName:"search_flights",parameters:{},mapPreviousResult:()=>({})},{toolName:"search_hotels",parameters:{},condition:n=>n.length>0&&n[0].success,mapPreviousResult:n=>{var t;const e=n[0];if(e.success&&((t=e.result.flights)==null?void 0:t.length)>0){const s=e.result.flights[0];return{destination:s.destination,checkIn:s.departureDate,checkOut:s.returnDate||s.departureDate}}return{}}},{toolName:"search_activities",parameters:{},condition:n=>n.length>1&&n[1].success,mapPreviousResult:n=>{var t;const e=n[1];return e.success&&((t=e.result.hotels)==null?void 0:t.length)>0?{destination:e.result.hotels[0].location,dateFrom:e.result.hotels[0].checkIn,dateTo:e.result.hotels[0].checkOut}:{}}}]};W.register(st);function at(){console.log("Tool system initialized with:",{tools:x.getAllDefinitions().length,chains:W.getAllChains().length})}at();class rt{constructor(e,t,s){g(this,"supabase");g(this,"agentId");g(this,"context");this.supabase=e,this.agentId=t,this.context=s}async logActivity(e,t,s={}){try{await this.supabase.from("user_activity_logs").insert({user_id:e,activity_type:t,item_type:"agent_action",item_id:this.agentId,item_data:s,session_id:crypto.randomUUID()})}catch(a){console.error("Failed to log activity:",a)}}}class it extends rt{constructor(t,s,a){super(t,s,a);g(this,"toolExecutor");this.toolExecutor=new de}async executeToolsWithContext(t,s,a){var o,d;const r={userId:s,agentId:this.agentId,conversationId:((o=this.context)==null?void 0:o.getState().conversationId)||crypto.randomUUID(),sessionId:crypto.randomUUID(),metadata:a},c=await this.toolExecutor.executeMultiple(t,r,this.context);for(const u of c)await this.logActivity(s||"system","tool_execution",{toolName:(d=t.find(h=>h.id===u.id))==null?void 0:d.function.name,success:u.success,executionTime:u.executionTime,error:u.error});return c}async executeWorkflow(t,s,a){var d;const r=W.createChain(t,this.toolExecutor);if(!r)throw new Error(`Workflow '${t}' not found`);const c={userId:a,agentId:this.agentId,conversationId:((d=this.context)==null?void 0:d.getState().conversationId)||crypto.randomUUID(),sessionId:crypto.randomUUID()},o=await r.execute(s,c,this.context);return await this.logActivity(a||"system","workflow_execution",{chainId:t,success:o.every(u=>u.success),totalSteps:o.length,failedSteps:o.filter(u=>!u.success).length}),o}async getCapabilities(){const t=x.getAvailableTools(this.agentId),s=W.getAllChains(),a=x.getMetrics();return{tools:t.map(r=>({name:r.name,description:r.description,category:r.category,parameters:r.parameters})),workflows:s.map(r=>({id:r.id,name:r.name,description:r.description,stepCount:r.steps.length})),metrics:Array.isArray(a)?a:[a]}}async recommendTools(t,s){x.getAllDefinitions();const a=[],r=t.toLowerCase();return(r.includes("flight")||r.includes("fly"))&&a.push("search_flights"),(r.includes("hotel")||r.includes("accommodation"))&&a.push("search_hotels"),(r.includes("activity")||r.includes("experience"))&&a.push("search_activities"),(r.includes("booking")||r.includes("reservation"))&&a.push("get_booking_status"),(s==null?void 0:s.travelType)==="business"&&a.push("search_flights"),a}async validateToolCall(t){const s=x.get(t.function.name);if(!s)return{valid:!1,errors:[`Tool '${t.function.name}' not found`]};try{const a=JSON.parse(t.function.arguments);if(s.schema){const r=s.schema.safeParse(a);if(!r.success)return{valid:!1,errors:r.error.errors.map(c=>`${c.path.join(".")}: ${c.message}`)}}return s.validate&&!s.validate(a)?{valid:!1,errors:["Custom validation failed"]}:{valid:!0,errors:[]}}catch(a){return{valid:!1,errors:[`Invalid JSON parameters: ${a.message}`]}}}}class H{constructor(e,t,s,a){g(this,"state");g(this,"supabase");g(this,"isDirty",!1);this.supabase=s,this.state={conversationId:e,agentId:t,sessionId:crypto.randomUUID(),messages:[],sharedData:{},agentContext:{},userProfile:{},metadata:{createdAt:new Date,updatedAt:new Date,version:1},...a}}addMessage(e){const t=crypto.randomUUID(),s={id:t,timestamp:new Date,...e};return this.state.messages.push(s),this.markDirty(),t}addUserMessage(e,t){return this.addMessage({role:"user",content:e,metadata:t})}addAssistantMessage(e,t,s){return this.addMessage({role:"assistant",content:e,toolCalls:t,metadata:s})}addToolResult(e,t,s=!0,a){const r={id:crypto.randomUUID(),toolCallId:e,result:t,success:s,error:a};return this.addMessage({role:"tool",content:s?JSON.stringify(t):`Error: ${a}`,toolResults:[r]})}getMessages(){return[...this.state.messages]}getMessagesForLLM(){return this.state.messages.map(e=>({role:e.role,content:e.content}))}setSharedData(e,t){this.state.sharedData[e]=t,this.markDirty()}getSharedData(e){return this.state.sharedData[e]}setAgentContext(e,t){this.state.agentContext[e]=t,this.markDirty()}getAgentContext(e){return this.state.agentContext[e]}setUserProfile(e){this.state.userProfile={...this.state.userProfile,...e},this.markDirty()}getUserProfile(){return{...this.state.userProfile}}setCurrentTask(e){this.state.currentTask=e,this.markDirty()}getCurrentTask(){return this.state.currentTask}updateTaskProgress(e,t){this.state.currentTask&&(this.state.currentTask.progress=e,t&&(this.state.currentTask.status=t),this.markDirty())}setTravelContext(e){this.state.travelContext={...this.state.travelContext,...e},this.markDirty()}getTravelContext(){return this.state.travelContext||{}}async shareContext(e,t){const s=t?Object.fromEntries(t.map(a=>[a,this.state.sharedData[a]])):this.state.sharedData;await this.supabase.from("agent_context_memory").upsert({agent_id:e,user_id:this.state.userId,session_id:this.state.sessionId,context_type:"shared_handoff",context_data:{sourceAgentId:this.state.agentId,sharedContext:s,handoffTimestamp:new Date().toISOString(),conversationId:this.state.conversationId}})}async receiveSharedContext(e){const{data:t}=await this.supabase.from("agent_context_memory").select("context_data").eq("agent_id",this.state.agentId).eq("user_id",this.state.userId).eq("context_type","shared_handoff").order("created_at",{ascending:!1}).limit(1);if(t&&t[0]){const{sharedContext:s}=t[0].context_data;this.state.sharedData={...this.state.sharedData,...s},this.markDirty()}}markDirty(){this.isDirty=!0,this.state.metadata.updatedAt=new Date,this.state.metadata.version++}async save(){var e;this.isDirty&&(await this.supabase.from("agent_context_memory").upsert({agent_id:this.state.agentId,user_id:this.state.userId,session_id:this.state.sessionId,context_type:"conversation_state",context_data:this.state,expires_at:(e=this.state.metadata.expiresAt)==null?void 0:e.toISOString()}),this.isDirty=!1)}async load(){const{data:e}=await this.supabase.from("agent_context_memory").select("context_data").eq("agent_id",this.state.agentId).eq("user_id",this.state.userId).eq("session_id",this.state.sessionId).eq("context_type","conversation_state").order("created_at",{ascending:!1}).limit(1);return e&&e[0]?(this.state={...e[0].context_data,metadata:{...e[0].context_data.metadata,createdAt:new Date(e[0].context_data.metadata.createdAt),updatedAt:new Date(e[0].context_data.metadata.updatedAt),expiresAt:e[0].context_data.metadata.expiresAt?new Date(e[0].context_data.metadata.expiresAt):void 0}},this.isDirty=!1,!0):!1}serialize(){return JSON.stringify(this.state)}static deserialize(e,t){const s=JSON.parse(e);return new H(s.conversationId,s.agentId,t,s)}getState(){return Object.freeze({...this.state})}clone(){return new H(this.state.conversationId,this.state.agentId,this.supabase,JSON.parse(JSON.stringify(this.state)))}}class nt{constructor(){g(this,"agents",new Map);g(this,"agentMetadata",new Map);g(this,"messageQueue",[]);g(this,"taskDelegations",new Map);g(this,"contexts",new Map);this.startMessageProcessor()}async createAgent(e,t,s,a){const r=`${e}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,c=new H(`conv-${r}`,r,D,{sessionId:s,userId:a});await c.load(),this.contexts.set(r,c);const o=new it(D,r,c);this.agents.set(r,o);const d={id:r,type:e,specialization:t,capabilities:this.getCapabilitiesByType(e),workload:0,status:"active",createdAt:new Date,lastActivity:new Date};return this.agentMetadata.set(r,d),await o.logActivity(a||"system",`Agent ${r} created with type ${e}`,{specialization:t,capabilities:d.capabilities}),o}async terminateAgent(e){const t=this.agentMetadata.get(e);if(!t)return;const s=this.contexts.get(e);s&&await s.save(),t.status="terminated",this.agentMetadata.set(e,t),this.agents.delete(e),this.contexts.delete(e)}async pauseAgent(e){const t=this.agentMetadata.get(e);t&&(t.status="paused",this.agentMetadata.set(e,t))}async resumeAgent(e){const t=this.agentMetadata.get(e);t&&t.status==="paused"&&(t.status="active",t.lastActivity=new Date,this.agentMetadata.set(e,t))}async sendMessage(e){const t={...e,id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date};this.messageQueue.push(t),await this.processMessage(t)}async delegateTask(e){const t=`task-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,s={...e,id:t,status:"pending"};return this.taskDelegations.set(t,s),await this.sendMessage({fromAgentId:e.delegatedBy,toAgentId:e.assignedTo,messageType:"task-delegation",payload:s,priority:e.priority>2?"high":"normal",sessionId:""}),t}async handoffToSpecialist(e,t,s,a){const r=this.findBestSpecialist(t);if(!r)return null;const c=this.contexts.get(e),o=this.contexts.get(r.id);return c&&o&&await this.transferContext(c,o,s),await this.sendMessage({fromAgentId:e,toAgentId:r.id,messageType:"handoff",payload:{context:s,specialization:t},priority:"normal",sessionId:a}),r.id}findBestSpecialist(e){return Array.from(this.agentMetadata.values()).filter(s=>s.status==="active"&&s.specialization.includes(e)).sort((s,a)=>s.workload-a.workload)[0]||null}getAvailableAgents(){return Array.from(this.agentMetadata.values()).filter(e=>e.status==="active")}getAgentsByType(e){return Array.from(this.agentMetadata.values()).filter(t=>t.type===e&&t.status==="active")}getSystemMetrics(){const e=Array.from(this.agentMetadata.values()),t=e.filter(c=>c.status==="active"),s=e.filter(c=>c.status==="busy"),a=e.reduce((c,o)=>c+o.workload,0),r=e.length>0?a/e.length:0;return{totalAgents:e.length,activeAgents:t.length,busyAgents:s.length,averageWorkload:r,queuedMessages:this.messageQueue.length,activeTasks:Array.from(this.taskDelegations.values()).filter(c=>c.status==="in-progress").length}}async processMessage(e){const t=this.agents.get(e.toAgentId);if(!t)return;const s=this.agentMetadata.get(e.toAgentId);if(!(!s||s.status!=="active"))try{switch(e.messageType){case"task-delegation":await this.handleTaskDelegation(t,e);break;case"handoff":await this.handleHandoff(t,e);break;case"data-sharing":await this.handleDataSharing(t,e);break;case"status-update":await this.handleStatusUpdate(t,e);break}s&&(s.lastActivity=new Date,this.agentMetadata.set(e.toAgentId,s))}catch(a){console.error(`Error processing message ${e.id}:`,a)}}async handleTaskDelegation(e,t){const s=t.payload;s.status="in-progress",this.taskDelegations.set(s.id,s);try{const a=await e.executeToolsWithContext([{id:`tool-${Date.now()}`,type:"function",function:{name:s.taskType,arguments:JSON.stringify(s.parameters)}}],s.delegatedBy);s.status="completed",s.result=a}catch(a){s.status="failed",s.error=a instanceof Error?a.message:"Unknown error"}this.taskDelegations.set(s.id,s)}async handleHandoff(e,t){const s=t.payload;await e.logActivity("system",`Received handoff from ${t.fromAgentId}`,s)}async handleDataSharing(e,t){const s=this.contexts.get(t.toAgentId);s&&(s.setSharedData(`shared_${t.fromAgentId}`,t.payload),await s.save())}async handleStatusUpdate(e,t){await e.logActivity("system",`Status update from ${t.fromAgentId}`,t.payload)}async transferContext(e,t,s){t.setSharedData("handoff_context",{from:e.getState().agentId,data:s,timestamp:new Date().toISOString()}),await t.save()}getCapabilitiesByType(e){return{"travel-expert":["destination-research","itinerary-planning","travel-advice","cultural-insights"],"booking-specialist":["flight-booking","hotel-booking","activity-booking","package-deals"],"payment-handler":["payment-processing","refunds","billing-support","fraud-detection"],"customer-service":["support-chat","issue-resolution","feedback-collection","escalation"],general:["basic-chat","information-lookup","task-routing"]}[e]||["basic-operations"]}startMessageProcessor(){setInterval(()=>{if(this.messageQueue.length>0){const e=this.messageQueue.shift();e&&this.processMessage(e).catch(console.error)}},100)}}class ot{constructor(){g(this,"templates",new Map);g(this,"executions",new Map);g(this,"agents",new Map);this.initializeDefaultTemplates()}registerTemplate(e){this.templates.set(e.id,e)}getTemplate(e){return this.templates.get(e)}getAllTemplates(){return Array.from(this.templates.values())}getTemplatesByCategory(e){return Array.from(this.templates.values()).filter(t=>t.category===e)}async executeWorkflow(e,t,s){if(!this.templates.get(e))throw new Error(`Workflow template ${e} not found`);const r=`exec-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,c={id:r,templateId:e,status:"pending",currentStep:0,parallelTasks:new Map,startedAt:new Date,results:{},context:{...t},assignedAgents:s,errorHistory:[]};return this.executions.set(r,c),this.runWorkflow(r).catch(o=>{console.error(`Workflow ${r} failed:`,o),c.status="failed",c.completedAt=new Date}),r}async pauseWorkflow(e){const t=this.executions.get(e);t&&t.status==="running"&&(t.status="paused")}async resumeWorkflow(e){const t=this.executions.get(e);t&&t.status==="paused"&&(t.status="running",await this.runWorkflow(e))}async cancelWorkflow(e){const t=this.executions.get(e);t&&["pending","running","paused"].includes(t.status)&&(await this.rollbackWorkflow(e),t.status="rolled-back",t.completedAt=new Date)}getExecution(e){return this.executions.get(e)}async runWorkflow(e){var a,r;const t=this.executions.get(e),s=t?this.templates.get(t.templateId):void 0;if(!(!t||!s)){t.status="running";try{for(let c=t.currentStep;c<s.steps.length&&t.status==="running";c++){const o=s.steps[c];if(t.currentStep=c,o.condition&&!await this.evaluateCondition(o.condition,t.context)){(a=o.branches)!=null&&a.false&&await this.executeSteps(o.branches.false,t);continue}const d=((r=o.branches)==null?void 0:r.true)||[o];await this.executeSteps(d,t);const u=s.parallelExecutions.find(h=>h.syncPoint===o.id);u&&await this.executeParallelSteps(u,t)}t.status==="running"&&(t.status="completed",t.completedAt=new Date)}catch(c){await this.handleWorkflowError(t,s,c)}}}async executeSteps(e,t){var s,a;for(const r of e){const c=this.agents.get(t.assignedAgents[0]);if(c)try{const o={id:`call-${Date.now()}`,type:"function",function:{name:r.toolName,arguments:JSON.stringify({...r.parameters,...this.resolveParameters(r.parameters,t.context)})}},d=await c.executeToolsWithContext([o]);if((s=d[0])!=null&&s.success)t.results[r.id]=d[0].result,t.context={...t.context,...d[0].result};else throw new Error(((a=d[0])==null?void 0:a.error)||"Tool execution failed")}catch(o){throw new Error(`Step ${r.id} failed: ${o instanceof Error?o.message:"Unknown error"}`)}}}async executeParallelSteps(e,t){const s=e.steps.map(async r=>{t.parallelTasks.set(r.id,"running");try{await this.executeSteps([r],t),t.parallelTasks.set(r.id,"completed")}catch(c){throw t.parallelTasks.set(r.id,"failed"),c}}),a=e.timeout||3e5;await Promise.race([Promise.all(s),new Promise((r,c)=>setTimeout(()=>c(new Error("Parallel execution timeout")),a))])}async evaluateCondition(e,t){switch(e.type){case"user-preference":return this.evaluateUserPreference(e.expression,t,e.parameters);case"data-validation":return this.evaluateDataValidation(e.expression,t,e.parameters);case"business-rule":return this.evaluateBusinessRule(e.expression,t,e.parameters);case"external-api":return await this.evaluateExternalAPI(e.expression,t,e.parameters);default:return!0}}evaluateUserPreference(e,t,s){const a=t.userPreferences||{},[r,c,o]=e.split(" "),d=a[r];switch(c){case"==":return d===o;case"!=":return d!==o;case">":return Number(d)>Number(o);case"<":return Number(d)<Number(o);case"includes":return Array.isArray(d)&&d.includes(o);default:return!0}}evaluateDataValidation(e,t,s){try{return new Function("context","params",`return ${e}`)(t,s)}catch{return!1}}evaluateBusinessRule(e,t,s){var r;const a={budget_check:()=>(t.totalPrice||0)<=(s.maxBudget||1/0),availability_check:()=>t.availability===!0,time_constraint:()=>{const c=new Date,o=new Date(s.deadline);return c<o}};return((r=a[e])==null?void 0:r.call(a))||!0}async evaluateExternalAPI(e,t,s){try{return!0}catch{return!1}}resolveParameters(e,t){const s={};for(const[a,r]of Object.entries(e))if(typeof r=="string"&&r.startsWith("${")&&r.endsWith("}")){const c=r.slice(2,-1);s[a]=t[c]}else s[a]=r;return s}async handleWorkflowError(e,t,s){const a=e.currentStep,r=e.errorHistory.filter(c=>c.step===a).length;if(e.errorHistory.push({step:a,error:s.message,timestamp:new Date,retryCount:r}),r<t.failureHandling.retryPolicy.maxRetries){const c=this.calculateRetryDelay(r,t.failureHandling.retryPolicy);setTimeout(()=>{this.runWorkflow(e.id).catch(console.error)},c);return}t.failureHandling.rollbackSteps.length>0?(await this.rollbackWorkflow(e.id),e.status="rolled-back"):e.status="failed",e.completedAt=new Date,t.failureHandling.alternativeChain&&await this.executeWorkflow(t.failureHandling.alternativeChain,e.context,e.assignedAgents)}calculateRetryDelay(e,t){switch(t.backoffStrategy){case"linear":return t.baseDelay*(e+1);case"exponential":return t.baseDelay*Math.pow(2,e);default:return t.baseDelay}}async rollbackWorkflow(e){const t=this.executions.get(e),s=t?this.templates.get(t.templateId):void 0;if(!t||!s)return;const a=s.failureHandling.rollbackSteps.reverse();for(const r of a){const c=this.agents.get(t.assignedAgents[0]);if(c)try{const o={id:`rollback-${Date.now()}`,type:"function",function:{name:"rollback_action",arguments:JSON.stringify({stepId:r,context:t.context})}};await c.executeToolsWithContext([o])}catch(o){console.error(`Rollback failed for step ${r}:`,o)}}}initializeDefaultTemplates(){this.registerTemplate({id:"comprehensive-travel-booking",name:"Comprehensive Travel Booking",description:"End-to-end travel booking with flights, hotels, and activities",category:"travel-booking",steps:[{id:"analyze-requirements",toolName:"analyze_travel_requirements",parameters:{destination:"${destination}",dates:"${dates}",budget:"${budget}",preferences:"${userPreferences}"},description:"Analyze user travel requirements"},{id:"search-flights",toolName:"search_flights",parameters:{origin:"${origin}",destination:"${destination}",dates:"${dates}",passengers:"${passengers}"},description:"Search for available flights",condition:{type:"user-preference",expression:"includeFlights == true",parameters:{}}},{id:"search-hotels",toolName:"search_hotels",parameters:{destination:"${destination}",checkIn:"${checkIn}",checkOut:"${checkOut}",guests:"${guests}"},description:"Search for available hotels"},{id:"validate-budget",toolName:"validate_total_cost",parameters:{flightCost:"${flightResults.totalPrice}",hotelCost:"${hotelResults.totalPrice}",maxBudget:"${budget}"},description:"Validate total cost against budget",condition:{type:"business-rule",expression:"budget_check",parameters:{maxBudget:"${budget}"}},branches:{true:[],false:[{id:"suggest-alternatives",toolName:"suggest_budget_alternatives",parameters:{currentTotal:"${totalCost}",targetBudget:"${budget}"},description:"Suggest budget-friendly alternatives"}]}}],parallelExecutions:[{id:"parallel-search",steps:[{id:"search-activities",toolName:"search_activities",parameters:{destination:"${destination}",dates:"${dates}",interests:"${userPreferences.interests}"},description:"Search for activities and tours"},{id:"check-weather",toolName:"get_weather_forecast",parameters:{destination:"${destination}",dates:"${dates}"},description:"Get weather forecast for destination"}],syncPoint:"validate-budget",timeout:3e4}],failureHandling:{retryPolicy:{maxRetries:3,backoffStrategy:"exponential",baseDelay:1e3},rollbackSteps:[],alternativeChain:"simple-travel-booking"},metadata:{estimatedDuration:15,requiredAgentTypes:["travel-expert","booking-specialist"],complexity:"complex",tags:["booking","flights","hotels","activities"]}}),this.registerTemplate({id:"customer-support-resolution",name:"Customer Support Issue Resolution",description:"Systematic approach to resolving customer support issues",category:"customer-service",steps:[{id:"categorize-issue",toolName:"categorize_support_issue",parameters:{description:"${issueDescription}",urgency:"${urgency}"},description:"Categorize and prioritize the support issue"},{id:"gather-context",toolName:"gather_user_context",parameters:{userId:"${userId}",bookingHistory:!0,preferences:!0},description:"Gather relevant user context and history"},{id:"attempt-resolution",toolName:"attempt_automatic_resolution",parameters:{issueCategory:"${issueCategory}",userContext:"${userContext}"},description:"Attempt automatic resolution",condition:{type:"business-rule",expression:'context.issueCategory !== "complex"',parameters:{}},branches:{true:[],false:[{id:"escalate-to-human",toolName:"escalate_to_human_agent",parameters:{issue:"${issueDescription}",context:"${userContext}",priority:"high"},description:"Escalate complex issues to human agents"}]}}],parallelExecutions:[],failureHandling:{retryPolicy:{maxRetries:2,backoffStrategy:"linear",baseDelay:2e3},rollbackSteps:[],alternativeChain:"human-handoff"},metadata:{estimatedDuration:10,requiredAgentTypes:["customer-service"],complexity:"medium",tags:["support","resolution","escalation"]}})}}function ct(){const[n]=y.useState(()=>new nt),[e]=y.useState(()=>new ot),[t,s]=y.useState(!1),{toast:a}=le();return y.useEffect(()=>{s(!0),a({title:"Agent Orchestration Initialized",description:"Multi-agent coordination system is ready"})},[a]),{agentOrchestrator:n,workflowOrchestrator:e,isInitialized:t,createAgent:n.createAgent.bind(n),terminateAgent:n.terminateAgent.bind(n),handoffToSpecialist:n.handoffToSpecialist.bind(n),executeWorkflow:e.executeWorkflow.bind(e),pauseWorkflow:e.pauseWorkflow.bind(e),cancelWorkflow:e.cancelWorkflow.bind(e),getSystemMetrics:n.getSystemMetrics.bind(n),getAvailableAgents:n.getAvailableAgents.bind(n)}}const Tt=()=>{const{toast:n}=le(),[e,t]=y.useState([]),[s,a]=y.useState(!0),[r,c]=y.useState(""),[o,d]=y.useState("all"),[u,h]=y.useState("all"),[N,f]=y.useState("recent"),[w,k]=y.useState(new Date),{isInitialized:T}=ct(),{isAnalyzing:v,latestAnalysis:b,requestAnalysis:J}=Ie(),{logApiCall:X}=Me(),{metrics:C,isHighMemoryUsage:he}=Ne({componentName:"AdminLogsPage",enableMonitoring:!0,reportToAnalytics:!0}),$=y.useCallback(async()=>{try{a(!0);const{data:l,error:p}=await D.from("system_logs").select("*").order("created_at",{ascending:!1}).limit(200);if(p){console.error("Error loading logs:",p);const m=[{id:"log-1",timestamp:new Date().toISOString(),level:"info",source:"enhanced_logging",message:"Real-time logging system active",metadata:{component:"system_health"}}];t(m)}else l&&t(l.map(m=>({id:m.id,timestamp:m.created_at,level:m.log_level||m.level,source:m.service_name||"system",message:m.message,metadata:m.metadata||{},correlation_id:m.correlation_id,user_id:m.user_id,duration_ms:m.duration_ms,status_code:m.status_code,error_details:m.error_details})));k(new Date)}catch(l){console.error("Failed to load system logs:",l),n({title:"Log Loading Error",description:"Failed to load system logs. Using cached data.",variant:"destructive"})}finally{a(!1)}},[n]);y.useEffect(()=>{$();const l=D.channel("system-logs-updates").on("postgres_changes",{event:"INSERT",schema:"public",table:"system_logs"},m=>{const B={id:m.new.id,timestamp:m.new.created_at,level:m.new.log_level||m.new.level,source:m.new.service_name||"system",message:m.new.message,metadata:m.new.metadata||{},correlation_id:m.new.correlation_id,user_id:m.new.user_id,duration_ms:m.new.duration_ms,status_code:m.new.status_code,error_details:m.new.error_details};t(ye=>[B,...ye.slice(0,199)]),k(new Date)}).subscribe(),p=setInterval($,3e4);return()=>{clearInterval(p),D.removeChannel(l)}},[$]),y.useEffect(()=>{e.length>0&&X("admin_logs_page","page_view",Date.now()-1e3,!0,200,void 0,{totalLogs:e.length,errorCount:e.filter(l=>l.level==="error").length,performanceMetrics:C})},[e.length,X,C]);const me=y.useCallback(async()=>{if(e.length===0)return;const l={totalLogs:e.length,errorLogs:e.filter(p=>p.level==="error"),warningLogs:e.filter(p=>p.level==="warning"),performanceMetrics:C,recentErrors:e.filter(p=>p.level==="error").slice(0,10)};await J("performance",l,"Analyze system logs for performance bottlenecks, error patterns, and optimization opportunities. Provide actionable recommendations.")},[e,C,J]),ge=l=>{switch(l){case"error":return i.jsx(We,{className:"h-4 w-4 text-destructive"});case"warning":return i.jsx(V,{className:"h-4 w-4 text-warning"});case"info":return i.jsx(oe,{className:"h-4 w-4 text-primary"});case"debug":return i.jsx(Le,{className:"h-4 w-4 text-muted-foreground"});default:return i.jsx(oe,{className:"h-4 w-4 text-muted-foreground"})}},fe=l=>{const p={error:"destructive",warning:"secondary",info:"default",debug:"outline"};return i.jsx(I,{variant:p[l]||"outline",children:l.toUpperCase()})},R=e.filter(l=>{const p=r===""||l.message.toLowerCase().includes(r.toLowerCase())||l.source.toLowerCase().includes(r.toLowerCase()),m=o==="all"||l.level===o,B=u==="all"||l.source===u;return p&&m&&B}),pe=Array.from(new Set(e.map(l=>l.source)));return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold",children:"Performance Logs"}),i.jsx("p",{className:"text-muted-foreground",children:"Real-time system monitoring with AI analysis integration"}),i.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-success animate-pulse"}),i.jsxs("span",{className:"text-sm text-muted-foreground",children:["Last updated: ",w.toLocaleTimeString()]})]}),T&&i.jsxs(I,{variant:"outline",className:"gap-1",children:[i.jsx(Y,{className:"h-3 w-3"}),"Agent System Active"]}),he&&i.jsxs(I,{variant:"destructive",className:"gap-1",children:[i.jsx(V,{className:"h-3 w-3"}),"High Memory Usage"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(Q,{onClick:me,disabled:v||e.length===0,variant:"outline",size:"sm",className:"gap-2",children:[i.jsx(Y,{className:`h-4 w-4 ${v?"animate-spin":""}`}),v?"Analyzing...":"AI Analysis"]}),i.jsxs(Q,{onClick:$,disabled:s,variant:"outline",size:"sm",children:[i.jsx(we,{className:`h-4 w-4 mr-2 ${s?"animate-spin":""}`}),"Refresh"]})]})]}),b&&i.jsxs(be,{children:[i.jsx(Y,{className:"h-4 w-4"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-semibold",children:"Master Bot Analysis"}),i.jsx(De,{className:"mt-1",children:b.summary}),b.recommendations.length>0&&i.jsxs("div",{className:"mt-3",children:[i.jsx("div",{className:"text-sm font-medium mb-2",children:"Recommendations:"}),i.jsx("ul",{className:"text-sm space-y-1 ml-4",children:b.recommendations.slice(0,3).map((l,p)=>i.jsx("li",{className:"list-disc",children:l},p))})]})]}),i.jsx(I,{variant:b.severity==="critical"?"destructive":"secondary",children:b.severity})]}),i.jsxs(E,{children:[i.jsx(ke,{children:i.jsxs(_e,{className:"flex items-center gap-2",children:[i.jsx(Ce,{className:"h-5 w-5"}),"Enhanced Log Analysis",i.jsxs(I,{variant:"outline",className:"ml-auto",children:[R.length," logs"]})]})}),i.jsxs(P,{children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"relative",children:[i.jsx($e,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),i.jsx(Se,{placeholder:"Search logs, correlation IDs, error messages...",value:r,onChange:l=>c(l.target.value),className:"pl-9"})]})}),i.jsxs(G,{value:o,onValueChange:d,children:[i.jsx(K,{className:"w-40",children:i.jsx(Z,{placeholder:"Filter by level"})}),i.jsxs(ee,{children:[i.jsx(S,{value:"all",children:"All Levels"}),i.jsx(S,{value:"error",children:"Error"}),i.jsx(S,{value:"warning",children:"Warning"}),i.jsx(S,{value:"info",children:"Info"}),i.jsx(S,{value:"debug",children:"Debug"})]})]}),i.jsxs(G,{value:u,onValueChange:h,children:[i.jsx(K,{className:"w-40",children:i.jsx(Z,{placeholder:"Filter by source"})}),i.jsxs(ee,{children:[i.jsx(S,{value:"all",children:"All Sources"}),pe.map(l=>i.jsx(S,{value:l,children:l.replace("_"," ").toUpperCase()},l))]})]})]}),i.jsxs(Ae,{value:N,onValueChange:f,className:"space-y-4",children:[i.jsxs(Te,{children:[i.jsx(q,{value:"recent",children:"Recent Logs"}),i.jsx(q,{value:"errors",children:"Errors Only"}),i.jsx(q,{value:"analytics",children:"Analytics"})]}),i.jsx(F,{value:"recent",children:s?i.jsx("div",{className:"flex items-center justify-center h-32",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i.jsx("div",{className:"border rounded-lg",children:i.jsxs(te,{children:[i.jsx(se,{children:i.jsxs(M,{children:[i.jsx(A,{className:"w-20",children:"Level"}),i.jsx(A,{className:"w-40",children:"Timestamp"}),i.jsx(A,{className:"w-32",children:"Source"}),i.jsx(A,{children:"Message"})]})}),i.jsxs(ae,{children:[R.slice(0,50).map(l=>i.jsxs(M,{children:[i.jsx(_,{children:i.jsxs("div",{className:"flex items-center gap-2",children:[ge(l.level),fe(l.level)]})}),i.jsx(_,{className:"text-sm text-muted-foreground",children:ce(new Date(l.timestamp),{addSuffix:!0})}),i.jsx(_,{className:"text-sm font-mono",children:l.source.replace("_"," ")}),i.jsxs(_,{className:"text-sm",children:[l.message,l.correlation_id&&i.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["ID: ",l.correlation_id]})]})]},l.id)),R.length===0&&i.jsx(M,{children:i.jsx(_,{colSpan:4,className:"text-center py-8 text-muted-foreground",children:"No logs found matching your criteria."})})]})]})})}),i.jsx(F,{value:"errors",children:i.jsx("div",{className:"border rounded-lg",children:i.jsxs(te,{children:[i.jsx(se,{children:i.jsxs(M,{children:[i.jsx(A,{children:"Timestamp"}),i.jsx(A,{children:"Source"}),i.jsx(A,{children:"Error Message"})]})}),i.jsx(ae,{children:R.filter(l=>l.level==="error").slice(0,20).map(l=>i.jsxs(M,{children:[i.jsx(_,{className:"text-sm text-muted-foreground",children:ce(new Date(l.timestamp),{addSuffix:!0})}),i.jsx(_,{className:"text-sm font-mono",children:l.source.replace("_"," ")}),i.jsx(_,{className:"text-sm text-destructive",children:l.message})]},l.id))})]})})}),i.jsx(F,{value:"analytics",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(E,{children:i.jsxs(P,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-destructive",children:e.filter(l=>l.level==="error").length}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Errors"})]})}),i.jsx(E,{children:i.jsxs(P,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-warning",children:e.filter(l=>l.level==="warning").length}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Warnings"})]})}),i.jsx(E,{children:i.jsxs(P,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-primary",children:e.filter(l=>l.level==="info").length}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Info Messages"})]})})]})})]})]})]})]})};export{Tt as default};
