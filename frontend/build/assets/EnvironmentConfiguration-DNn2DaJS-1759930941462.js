import{r as c,h as _,j as e,R as f,B as A,a as i,b as n,d as D,e as L,i as $,f as k,A as F,q as P,s as g}from"./index-7HSUJgza-1759930941462.js";import{I as N}from"./input-B0BzcVH8-1759930941462.js";import{L as m}from"./label-BAuCWBD6-1759930941462.js";import{T}from"./textarea-dJHlaM-d-1759930941462.js";import{S as R}from"./switch-Cm6lzc5X-1759930941462.js";import{D as w}from"./database-Dy8l8_Dr-1759930941462.js";import{S as u}from"./shield-_-CGtLvW-1759930941462.js";import{G as C}from"./globe-TPfiTbfc-1759930941462.js";import{S as U}from"./settings-hfDWc7pn-1759930941462.js";import{S as z}from"./server-BV1UQhO4-1759930941462.js";import"./index-DMwMdLt4-1759930941462.js";const W=()=>{const[a,p]=c.useState([]),[b,y]=c.useState(!0),[d,j]=c.useState({}),{toast:x}=_(),v=async()=>{try{const{data:s,error:t}=await g.from("api_configuration").select("*").order("created_at",{ascending:!1});if(t)throw t;p(s||[])}catch(s){x({title:"Failed to load environment configuration",description:s instanceof Error?s.message:"Unknown error",variant:"destructive"})}finally{y(!1)}},o=async(s,t)=>{j(r=>({...r,[s]:!0}));try{const{error:r}=await g.from("api_configuration").update(t).eq("id",s);if(r)throw r;p(l=>l.map(h=>h.id===s?{...h,...t}:h)),x({title:"Configuration updated",description:"Environment settings saved successfully"})}catch(r){x({title:"Failed to update configuration",description:r instanceof Error?r.message:"Unknown error",variant:"destructive"})}finally{j(r=>({...r,[s]:!1}))}},S=s=>{switch(s){case"production":return"bg-destructive text-destructive-foreground";case"staging":return"bg-warning text-warning-foreground";case"test":return"bg-secondary text-secondary-foreground";default:return"bg-muted text-muted-foreground"}},E=s=>{switch(s.toLowerCase()){case"amadeus":case"sabre":case"hotelbeds":return C;case"stripe":return u;case"database":return w;default:return z}};return c.useEffect(()=>{v()},[]),b?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(f,{className:"w-6 h-6 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Environment Configuration"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage API configurations across different environments"})]}),e.jsxs(A,{onClick:v,variant:"outline",size:"sm",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Total Configs"}),e.jsx("p",{className:"text-2xl font-bold",children:a.length})]})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Active Configs"}),e.jsx("p",{className:"text-2xl font-bold text-success",children:a.filter(s=>s.is_active).length})]})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Environments"}),e.jsx("p",{className:"text-2xl font-bold",children:new Set(a.map(s=>s.environment)).size})]})]})})})]}),e.jsx("div",{className:"grid gap-6",children:a.length===0?e.jsx(i,{children:e.jsx(n,{className:"py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(U,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No configurations found"}),e.jsx("p",{className:"text-muted-foreground",children:"Environment configurations will appear here when they are created"})]})})}):a.map(s=>{const t=E(s.provider);return e.jsxs(i,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(t,{className:"w-6 h-6"}),e.jsxs("div",{children:[e.jsx(L,{children:s.provider.toUpperCase()}),e.jsxs($,{children:[s.provider," API configuration"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{className:S(s.environment),children:s.environment}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{checked:s.is_active,onCheckedChange:r=>o(s.id,{is_active:r}),disabled:d[s.id]}),e.jsx(m,{children:"Active"})]})]})]})}),e.jsxs(n,{className:"space-y-4",children:[e.jsxs(F,{children:[e.jsx(u,{className:"w-4 h-4"}),e.jsx(P,{children:"Configuration data is encrypted and secure. Only authorized administrators can view sensitive values."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:`env-${s.id}`,children:"Environment"}),e.jsx(N,{id:`env-${s.id}`,value:s.environment,onChange:r=>o(s.id,{environment:r.target.value}),disabled:d[s.id]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:`provider-${s.id}`,children:"Provider"}),e.jsx(N,{id:`provider-${s.id}`,value:s.provider,onChange:r=>o(s.id,{provider:r.target.value}),disabled:d[s.id]})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:`config-${s.id}`,children:"Configuration Data"}),e.jsx(T,{id:`config-${s.id}`,value:JSON.stringify(s.config_data,null,2),onChange:r=>{try{const l=JSON.parse(r.target.value);o(s.id,{config_data:l})}catch{}},rows:6,className:"font-mono text-sm",disabled:d[s.id]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Created: ",new Date(s.created_at).toLocaleString()]}),e.jsxs("p",{children:["Updated: ",new Date(s.updated_at).toLocaleString()]})]})]})]},s.id)})})]})};export{W as EnvironmentConfiguration};
