import{k as M,u as U,r as a,j as e,a as o,b as i,L as Y,B as t,d as A,e as R,s as H,l as G}from"./index-DjdImu7N-1760110939984.js";import{N as m}from"./Navbar-8h5R_aPG-1760110939984.js";import{C as V}from"./circle-check-big-Xrs5gVr4-1760110939984.js";import"./useApiHealth-DPVGGVyI-1760110939984.js";import"./avatar-gZQEBL8z-1760110939984.js";import"./index-DfCRawss-1760110939984.js";import"./globe-V863FlWn-1760110939984.js";import"./useHealthMonitor-BQ7WjAcO-1760110939984.js";import"./useAIIntelligence-BSkgWwRO-1760110939984.js";import"./plane-wstmV1vG-1760110939984.js";import"./map-pin-CqL0379I-1760110939984.js";import"./sparkles-qy0t77XS-1760110939984.js";import"./chevron-down-2orNaCge-1760110939984.js";import"./brain-Bt7RhNB2-1760110939984.js";import"./calendar-dz0pWFqk-1760110939984.js";import"./zap-BtfHwo7M-1760110939984.js";import"./trophy-CuHiC0Qb-1760110939984.js";import"./users-DFzJUM1P-1760110939984.js";import"./settings-BGbAJj-B-1760110939984.js";import"./shield-BVMDfyik-1760110939984.js";import"./user-BKI64IH9-1760110939984.js";function ge(){var f,k,p,N,y,v,_,w,C,B,P,D,E,F,I,O,S,T,L;const[x]=M(),c=U(),l=x.get("session_id"),r=x.get("booking_id"),[s,h]=a.useState(null),[W,g]=a.useState(!0),[u,j]=a.useState(null);if(a.useEffect(()=>{(async()=>{try{if(g(!0),j(null),l&&r){const{data:n,error:d}=await H.functions.invoke("verify-booking-payment",{body:{sessionId:l,bookingId:r}});if(d)throw new Error("Failed to verify payment");if(n!=null&&n.booking){h(n.booking);return}}if(r){const{data:n,error:d}=await H.functions.invoke("guest-booking-lookup",{body:{bookingId:r}});if(d)throw new Error("Failed to find booking");if(n!=null&&n.booking){h(n.booking);return}}throw new Error("Booking not found. Please check your booking reference and email.")}catch(n){G.error("Booking confirmation error:",n),j(n.message||"Failed to load booking details")}finally{g(!1)}})()},[l,r]),W)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[e.jsx(m,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(o,{children:e.jsxs(i,{className:"p-8 text-center",children:[e.jsx(Y,{className:"h-12 w-12 animate-spin mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Loading your booking..."}),e.jsx("p",{className:"text-muted-foreground",children:"We're confirming your payment and retrieving your booking details."})]})})})]});if(u||!s)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[e.jsx(m,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(o,{children:e.jsxs(i,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-red-600",children:"Booking Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:u||"We could not find your booking details. Please check your email for confirmation."}),e.jsxs("div",{className:"space-x-4",children:[e.jsx(t,{onClick:()=>window.location.reload(),children:"Try Again"}),e.jsx(t,{variant:"outline",onClick:()=>c("/"),children:"Return Home"})]})]})})})]});const b=(f=s.booking_data)!=null&&f.checkIn&&((k=s.booking_data)!=null&&k.checkOut)?Math.ceil((new Date(s.booking_data.checkOut).getTime()-new Date(s.booking_data.checkIn).getTime())/(1e3*60*60*24)):1;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[e.jsx(m,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx(o,{className:"mb-6",children:e.jsxs(i,{className:"p-8 text-center",children:[e.jsx(V,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-3xl font-bold text-green-800 mb-2",children:"Booking Confirmed!"}),e.jsx("p",{className:"text-xl text-muted-foreground mb-4",children:"Your reservation has been successfully processed."}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 inline-block",children:e.jsxs("p",{className:"text-sm text-green-700",children:["Booking Reference: ",e.jsx("span",{className:"font-mono font-bold",children:s.booking_reference})]})})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(o,{children:[e.jsx(A,{children:e.jsx(R,{children:"Stay Details"})}),e.jsxs(i,{className:"space-y-4",children:[((y=(N=(p=s.booking_data)==null?void 0:p.selectedOffer)==null?void 0:N.hotel)==null?void 0:y.name)&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Hotel"}),e.jsx("p",{className:"text-muted-foreground",children:s.booking_data.selectedOffer.hotel.name})]}),((w=(_=(v=s.booking_data)==null?void 0:v.selectedOffer)==null?void 0:_.hotel)==null?void 0:w.address)&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Location"}),e.jsxs("p",{className:"text-muted-foreground",children:[(C=s.booking_data.selectedOffer.hotel.address.lines)==null?void 0:C.join(", "),", ",s.booking_data.selectedOffer.hotel.address.cityName]})]}),((B=s.booking_data)==null?void 0:B.checkIn)&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Check-in"}),e.jsx("p",{className:"text-muted-foreground",children:new Date(s.booking_data.checkIn).toLocaleDateString("en-AU",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),((P=s.booking_data)==null?void 0:P.checkOut)&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Check-out"}),e.jsxs("p",{className:"text-muted-foreground",children:[new Date(s.booking_data.checkOut).toLocaleDateString("en-AU",{weekday:"long",year:"numeric",month:"long",day:"numeric"})," (",b," ",b===1?"night":"nights",")"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Guests"}),e.jsxs("p",{className:"text-muted-foreground",children:[((D=s.booking_data)==null?void 0:D.adults)||2," Adults",((E=s.booking_data)==null?void 0:E.children)>0&&`, ${s.booking_data.children} Children`]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Rooms"}),e.jsxs("p",{className:"text-muted-foreground",children:[((F=s.booking_data)==null?void 0:F.rooms)||1," Room(s)"]})]})]})]}),e.jsxs(o,{children:[e.jsx(A,{children:e.jsx(R,{children:"Payment Summary"})}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Room Total"}),e.jsxs("span",{children:[s.currency," ",((O=(I=s.booking_data)==null?void 0:I.roomPrice)==null?void 0:O.toFixed(2))||"0.00"]})]}),((S=s.booking_data)==null?void 0:S.addonsPrice)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Extras"}),e.jsxs("span",{children:[s.currency," ",s.booking_data.addonsPrice.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Taxes & Fees"}),e.jsx("span",{children:"Included"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[e.jsx("span",{children:"Total Paid"}),e.jsxs("span",{children:[s.currency," ",s.total_amount.toFixed(2)]})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-green-700 text-center",children:["✅ Payment Status: ",e.jsx("span",{className:"font-semibold",children:"Confirmed"})]})})]})]})]}),e.jsxs("div",{className:"mt-8 text-center space-x-4",children:[e.jsx(t,{onClick:()=>c("/dashboard"),children:"View My Bookings"}),e.jsx(t,{variant:"outline",onClick:()=>c("/"),children:"Book Another Trip"})]}),e.jsx(o,{className:"mt-6",children:e.jsxs(i,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"What's Next?"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("li",{children:["• A confirmation email has been sent to ",((L=(T=s.booking_data)==null?void 0:T.customerInfo)==null?void 0:L.email)||"your email"]}),e.jsxs("li",{children:["• Your booking reference is: ",e.jsx("span",{className:"font-mono",children:s.booking_reference})]}),e.jsx("li",{children:"• Please present this reference and valid ID at check-in"}),e.jsx("li",{children:"• For any changes or cancellations, contact the hotel directly"})]})]})})]})]})}export{ge as default};
