import{r as o,h as me,s as E,j as e,d as g,e as h,p as he,T as F,f as C,g as I,A as Q,q as V,a as B,B as M,R as fe}from"./index-CmnXGmSR-1761324991663.js";import{I as _e}from"./input-DuoUWz5u-1761324991663.js";import{T as G,a as W,b as R,c as z}from"./tabs-DdZtRR2V-1761324991663.js";import{a as ve,u as je}from"./useEnhancedLogging-C8_jEGth-1761324991663.js";import{c as oe}from"./correlationId-10vhnYYQ-1761324991663.js";import{D as ce}from"./dollar-sign-eVp-RoVw-1761324991663.js";import{T as L}from"./trending-up-BGL9SNNQ-1761324991663.js";import{S as le}from"./shield-CJiHJfpS-1761324991663.js";import{A as K}from"./activity-2rzxLtby-1761324991663.js";import{Z as H}from"./zap-C0GkxUD1-1761324991663.js";import{T as be}from"./target-YlK9yS_3-1761324991663.js";import{B as ye}from"./brain-pesvfUWO-1761324991663.js";import{U as Ne}from"./users-B5hxtXMM-1761324991663.js";import{C as X}from"./clock-m741sTIw-1761324991663.js";import{C as we}from"./circle-alert-DJLi3XXb-1761324991663.js";import{B as Z}from"./bot-4bhRkZvE-1761324991663.js";import{S as ke}from"./search-Q6EvFPtU-1761324991663.js";import{C as de}from"./circle-x-CLHbX7Or-1761324991663.js";import{C as Se}from"./circle-check-big-Dm6-6eRM-1761324991663.js";import"./v4-BToUZ8VQ-1761324991663.js";const Ae=()=>{const[c,S]=o.useState(!1),[p,y]=o.useState([]),[N,j]=o.useState({status:"disconnected",connectedUsers:0,activeChannels:0,messageQueue:0,lastHeartbeat:new Date,latency:0,totalMessages:0,errorRate:0}),b=o.useRef(null),{toast:k}=me(),_=i=>{y(t=>[i,...t].slice(0,100)),i.priority==="critical"&&k({title:"Critical Alert",description:`New ${i.type} received`,variant:"destructive"}),j(t=>({...t,totalMessages:t.totalMessages+1,messageQueue:t.messageQueue+(i.processed?0:1)}))};return o.useEffect(()=>((async()=>{try{const t=E.channel("master-bot-realtime").on("postgres_changes",{event:"*",schema:"public",table:"gpt_bot_registry"},x=>{_({id:`bot_registry_${Date.now()}`,type:"bot_result",source:"gpt_bot_registry",data:x,timestamp:new Date().toISOString(),priority:"medium",processed:!1})}).on("postgres_changes",{event:"*",schema:"public",table:"agentic_tasks"},x=>{_({id:`task_${Date.now()}`,type:"task_update",source:"agentic_tasks",data:x,timestamp:new Date().toISOString(),priority:"high",processed:!1})}).on("postgres_changes",{event:"*",schema:"public",table:"agent_performance_metrics"},x=>{_({id:`performance_${Date.now()}`,type:"dashboard_update",source:"agent_performance_metrics",data:x,timestamp:new Date().toISOString(),priority:"medium",processed:!1})}).on("postgres_changes",{event:"*",schema:"public",table:"admin_bot_commands"},x=>{_({id:`admin_command_${Date.now()}`,type:"admin_command",source:"admin_bot_commands",data:x,timestamp:new Date().toISOString(),priority:"high",processed:!1})}).on("postgres_changes",{event:"*",schema:"public",table:"agent_alerts"},x=>{_({id:`alert_${Date.now()}`,type:"system_alert",source:"agent_alerts",data:x,timestamp:new Date().toISOString(),priority:"critical",processed:!1})}).on("presence",{event:"sync"},()=>{const x=t.presenceState();j(a=>({...a,connectedUsers:Object.keys(x).length}))}).on("broadcast",{event:"heartbeat"},x=>{j(a=>({...a,lastHeartbeat:new Date,latency:Date.now()-x.timestamp}))});b.current=t;const m=await t.subscribe(x=>{console.log("Realtime subscription status:",x),S(x==="SUBSCRIBED"),j(a=>({...a,status:x==="SUBSCRIBED"?"connected":x==="CHANNEL_ERROR"?"disconnected":"reconnecting"})),x==="SUBSCRIBED"&&(k({title:"Real-time Connected",description:"Live updates are now active"}),t.track({user:"admin",online_at:new Date().toISOString()}),j(a=>({...a,activeChannels:1})))})}catch(t){console.error("Failed to initialize realtime connection:",t),k({title:"Connection Failed",description:"Failed to establish real-time connection",variant:"destructive"})}})(),()=>{b.current&&b.current.unsubscribe()}),[k]),o.useEffect(()=>{j(i=>({...i,totalMessages:p.length,messageQueue:p.filter(t=>!t.processed).length}))},[p]),{isConnected:c,events:p,metrics:N,markEventAsProcessed:i=>{y(t=>t.map(m=>m.id===i?{...m,processed:!0}:m))},clearAllEvents:()=>{y([])},reconnect:async()=>{b.current&&(await b.current.unsubscribe(),await b.current.subscribe())}}},Ce=()=>{const[c,S]=o.useState([]),[p,y]=o.useState([]),[N,j]=o.useState(!1),[b,k]=o.useState(!1),_=async()=>{j(!0);try{const r=[{provider_id:"amadeus",provider_name:"Amadeus",success_rate:94.2,avg_response_time:1240,total_bookings:1847,revenue_generated:142350.8,cost_per_booking:12.45,roi_percentage:156.3,market_share:45.2,customer_satisfaction:4.3,last_updated:new Date().toISOString()},{provider_id:"sabre",provider_name:"Sabre",success_rate:87.8,avg_response_time:2100,total_bookings:934,revenue_generated:78920.45,cost_per_booking:18.2,roi_percentage:134.7,market_share:28.7,customer_satisfaction:3.9,last_updated:new Date().toISOString()},{provider_id:"hotelbeds",provider_name:"HotelBeds",success_rate:91.5,avg_response_time:980,total_bookings:2156,revenue_generated:198760.3,cost_per_booking:8.9,roi_percentage:178.9,market_share:67.8,customer_satisfaction:4.5,last_updated:new Date().toISOString()},{provider_id:"viator",provider_name:"Viator",success_rate:96.1,avg_response_time:750,total_bookings:567,revenue_generated:34280.2,cost_per_booking:6.75,roi_percentage:189.4,market_share:78.9,customer_satisfaction:4.7,last_updated:new Date().toISOString()}],i=[];r.forEach(t=>{t.success_rate<90&&i.push({id:`alert_${t.provider_id}_success`,provider_id:t.provider_id,alert_type:"performance_drop",severity:t.success_rate<85?"critical":"high",message:`${t.provider_name} success rate (${t.success_rate}%) below threshold`,threshold_value:90,current_value:t.success_rate,created_at:new Date().toISOString()}),t.roi_percentage<140&&i.push({id:`alert_${t.provider_id}_roi`,provider_id:t.provider_id,alert_type:"low_roi",severity:"medium",message:`${t.provider_name} ROI (${t.roi_percentage}%) trending downward`,threshold_value:140,current_value:t.roi_percentage,created_at:new Date().toISOString()}),t.avg_response_time>2e3&&i.push({id:`alert_${t.provider_id}_latency`,provider_id:t.provider_id,alert_type:"performance_drop",severity:"medium",message:`${t.provider_name} response time (${t.avg_response_time}ms) exceeds target`,threshold_value:2e3,current_value:t.avg_response_time,created_at:new Date().toISOString()})}),S(r),y(i),await E.functions.invoke("correlation-data-collector",{body:{correlation_id:`provider_metrics_${Date.now()}`,request_type:"provider_performance_analysis",status:"completed",service_name:"provider_intelligence",metadata:{providers_analyzed:r.length,alerts_generated:i.length,total_revenue:r.reduce((t,m)=>t+m.revenue_generated,0),avg_roi:r.reduce((t,m)=>t+m.roi_percentage,0)/r.length}}})}catch(r){console.error("Error fetching provider metrics:",r)}finally{j(!1)}},A=()=>c.map(r=>({...r,composite_score:r.success_rate*.3+r.roi_percentage*.25+r.customer_satisfaction*20+r.market_share*.1+(2e3-r.avg_response_time)/20})).sort((r,i)=>i.composite_score-r.composite_score),P=()=>p.filter(r=>r.severity==="critical"||r.severity==="high").reduce((r,i)=>{const t=c.find(m=>m.provider_id===i.provider_id);return r+((t==null?void 0:t.revenue_generated)||0)*.15},0);return o.useEffect(()=>{_();const r=E.channel("provider-performance").on("broadcast",{event:"metric_update"},t=>{console.log("Provider performance update:",t),_(),k(!0)}).subscribe(t=>{k(t==="SUBSCRIBED")}),i=setInterval(_,3e4);return()=>{E.removeChannel(r),clearInterval(i)}},[]),{metrics:c,alerts:p,loading:N,realtimeConnected:b,calculateProviderRanking:A,getRevenueAtRisk:P,refetch:_}},Ie=()=>{const[c,S]=o.useState([]),[p,y]=o.useState([]),[N,j]=o.useState(!1),[b,k]=o.useState(0),_=async n=>{try{const d=await A(n);return await E.functions.invoke("correlation-data-collector",{body:{correlation_id:oe.getCurrentId(),request_type:"booking_intelligence_analysis",status:"in_progress",service_name:"booking_intelligence_engine",provider_id:n.provider,booking_value:n.total_amount,customer_tier:d.customer_tier,session_id:n.session_id,booking_type:n.booking_type,metadata:{risk_score:a(d.risk_factors),provider_performance:d.provider_performance,optimization_count:d.optimization_suggestions.length,revenue_protection_status:d.revenue_protection_status}}}),d}catch(d){throw console.error("Error integrating booking intelligence:",d),d}},A=async n=>{const d=P(n.total_amount),l=await r(n.provider),v=i(n),D=t(n,v);return{booking_id:n.booking_id||`booking_${Date.now()}`,correlation_id:oe.getCurrentId(),customer_tier:d,booking_value:n.total_amount,provider_performance:l,risk_factors:v,optimization_suggestions:D,predicted_completion_time:m(v),revenue_protection_status:x(v,n.total_amount)}},P=n=>n>2e3?"premium":n>500?"standard":"budget",r=async n=>({amadeus:{provider_id:"amadeus",response_time:1240,success_rate:94.2,cost_efficiency:87.5},sabre:{provider_id:"sabre",response_time:2100,success_rate:87.8,cost_efficiency:72.3},hotelbeds:{provider_id:"hotelbeds",response_time:980,success_rate:91.5,cost_efficiency:92.1},viator:{provider_id:"viator",response_time:750,success_rate:96.1,cost_efficiency:94.8}})[n]||{provider_id:n,response_time:1500,success_rate:90,cost_efficiency:80},i=n=>{const d=n.total_amount>1e3?.15:.25,l=n.provider==="sabre"?.12:.05,v=n.booking_type==="flight"?.18:.1;return{payment_timeout_risk:Math.min(d+Math.random()*.1,.4),provider_failure_risk:Math.min(l+Math.random()*.05,.2),customer_abandonment_risk:Math.min(v+Math.random()*.1,.3)}},t=(n,d)=>{const l=[];return d.payment_timeout_risk>.2&&(l.push("Extend payment timeout window for high-value bookings"),l.push("Send proactive timeout warnings via SMS")),d.provider_failure_risk>.1&&(l.push("Prepare fallback provider for seamless failover"),l.push("Pre-validate provider availability before payment")),d.customer_abandonment_risk>.15&&(l.push("Implement exit-intent detection with retention offers"),l.push("Show progress indicators to reduce abandonment anxiety")),n.total_amount>1500&&(l.push("Assign premium customer success manager"),l.push("Enable priority processing queue")),l},m=n=>{const l=Object.values(n).reduce((v,D)=>v+D,0);return Math.round(180*(1+l))},x=(n,d)=>{const l=a(n);return l>.3&&d>1e3?"critical":l>.2||d>2e3?"warning":"safe"},a=n=>{const d=Object.values(n);return d.reduce((l,v)=>l+v,0)/d.length},f=async()=>{j(!0);try{const n=[{booking_id:"booking_001",correlation_id:"corr_001",customer_tier:"premium",booking_value:2450,provider_performance:{provider_id:"amadeus",response_time:1240,success_rate:94.2,cost_efficiency:87.5},risk_factors:{payment_timeout_risk:.12,provider_failure_risk:.05,customer_abandonment_risk:.08},optimization_suggestions:["Assign premium customer success manager","Enable priority processing queue"],predicted_completion_time:195,revenue_protection_status:"warning"},{booking_id:"booking_002",correlation_id:"corr_002",customer_tier:"standard",booking_value:780,provider_performance:{provider_id:"hotelbeds",response_time:980,success_rate:91.5,cost_efficiency:92.1},risk_factors:{payment_timeout_risk:.25,provider_failure_risk:.03,customer_abandonment_risk:.15},optimization_suggestions:["Extend payment timeout window","Show progress indicators"],predicted_completion_time:210,revenue_protection_status:"safe"}];S(n);const d=n.filter(l=>l.revenue_protection_status!=="safe").reduce((l,v)=>{const D=v.revenue_protection_status==="critical"?.4:.15;return l+v.booking_value*D},0);k(d)}catch(n){console.error("Error fetching booking intelligence:",n)}finally{j(!1)}};return o.useEffect(()=>{f();const n=E.channel("booking-intelligence").on("broadcast",{event:"booking_event"},l=>{const v={event_type:l.event_type,booking_id:l.booking_id,timestamp:new Date().toISOString(),metadata:l.metadata};y(D=>[v,...D.slice(0,49)]),f()}).subscribe(),d=setInterval(f,15e3);return()=>{E.removeChannel(n),clearInterval(d)}},[]),{activeBookings:c,realtimeEvents:p,loading:N,totalRevenueAtRisk:b,integrateWithBookingFlow:_,analyzeBookingInRealTime:A,refetch:f}},Re=()=>{const[c,S]=o.useState("overview"),{metrics:p,alerts:y,realtimeConnected:N,calculateProviderRanking:j,getRevenueAtRisk:b}=Ce(),{activeBookings:k,totalRevenueAtRisk:_}=Ie(),A=j(),P=b(),r=p.reduce((a,f)=>a+f.revenue_generated,0),i=p.length>0?p.reduce((a,f)=>a+f.roi_percentage,0)/p.length:0,t=a=>new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),m=a=>`${a.toFixed(1)}%`,x=a=>{switch(a){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(g,{className:"border-primary/20",children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:t(r)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 30 days"})]}),e.jsx(ce,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(g,{className:"border-primary/20",children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Avg ROI"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:m(i)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all providers"})]}),e.jsx(L,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(g,{className:"border-orange-200 bg-orange-50/50",children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Revenue at Risk"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:t(P+_)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[y.length," active alerts"]})]}),e.jsx(le,{className:"h-8 w-8 text-orange-600"})]})})}),e.jsx(g,{className:"border-primary/20",children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Active Bookings"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:k.length}),e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${N?"bg-green-500":"bg-red-500"}`}),N?"Live":"Offline"]})]}),e.jsx(K,{className:"h-8 w-8 text-purple-600"})]})})})]}),e.jsxs(G,{value:c,onValueChange:S,children:[e.jsxs(W,{className:"grid w-full grid-cols-4",children:[e.jsxs(R,{value:"overview",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Performance Overview"]}),e.jsxs(R,{value:"revenue",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Revenue Intelligence"]}),e.jsxs(R,{value:"alerts",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Risk Management (",y.length,")"]}),e.jsxs(R,{value:"predictions",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Predictive Analytics"]})]}),e.jsx(z,{value:"overview",className:"space-y-4",children:e.jsxs(g,{children:[e.jsx(C,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5"}),"Provider Performance Ranking"]})}),e.jsx(h,{children:e.jsx("div",{className:"space-y-4",children:A.map((a,f)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${f===0?"bg-yellow-100 text-yellow-800":f===1?"bg-gray-100 text-gray-800":f===2?"bg-orange-100 text-orange-800":"bg-muted text-muted-foreground"}`,children:f+1}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:a.provider_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[m(a.success_rate)," success • ",t(a.revenue_generated)," revenue"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:[m(a.roi_percentage)," ROI"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[a.avg_response_time,"ms avg"]})]})]},a.provider_id))})})]})}),e.jsx(z,{value:"revenue",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(g,{children:[e.jsx(C,{children:e.jsx(I,{children:"Revenue by Provider"})}),e.jsx(h,{children:e.jsx("div",{className:"space-y-3",children:p.map(a=>{const f=r>0?a.revenue_generated/r*100:0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:a.provider_name}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[t(a.revenue_generated)," (",m(f),")"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full",style:{width:`${f}%`}})})]},a.provider_id)})})})]}),e.jsxs(g,{children:[e.jsx(C,{children:e.jsx(I,{children:"Cost Efficiency Analysis"})}),e.jsx(h,{children:e.jsx("div",{className:"space-y-4",children:p.map(a=>e.jsxs("div",{className:"flex justify-between items-center p-3 border rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.provider_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t(a.cost_per_booking)," per booking"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-lg font-bold ${a.roi_percentage>150?"text-green-600":a.roi_percentage>120?"text-yellow-600":"text-red-600"}`,children:m(a.roi_percentage)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ROI"})]})]},a.provider_id))})})]})]})}),e.jsx(z,{value:"alerts",className:"space-y-4",children:y.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Q,{variant:"destructive",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsxs(V,{children:[e.jsxs("strong",{children:[y.filter(a=>a.severity==="critical").length," critical alerts"]})," require immediate attention. Estimated revenue impact: ",t(P+_)]})]}),y.map(a=>{var f;return e.jsxs(g,{className:`border-l-4 ${a.severity==="critical"?"border-l-red-500":a.severity==="high"?"border-l-orange-500":a.severity==="medium"?"border-l-yellow-500":"border-l-blue-500"}`,children:[e.jsx(C,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{className:"text-lg",children:a.message}),e.jsx(B,{className:x(a.severity),children:a.severity.toUpperCase()})]})}),e.jsx(h,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Provider"}),e.jsx("p",{className:"font-medium",children:(f=p.find(n=>n.provider_id===a.provider_id))==null?void 0:f.provider_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Alert Type"}),e.jsx("p",{className:"font-medium",children:a.alert_type.replace(/_/g," ").toUpperCase()})]})]})})]},a.id)})]}):e.jsx(g,{children:e.jsxs(h,{className:"p-6 text-center",children:[e.jsx(le,{className:"h-12 w-12 mx-auto mb-4 text-green-600"}),e.jsx("p",{className:"text-lg font-medium text-green-600",children:"All Systems Healthy"}),e.jsx("p",{className:"text-muted-foreground",children:"No active alerts or performance issues detected"})]})})}),e.jsx(z,{value:"predictions",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(g,{children:[e.jsx(C,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Revenue Forecasting"]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-800",children:"30-Day Projection"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:t(r*1.15)}),e.jsx("p",{className:"text-sm text-green-700",children:"+15% growth trend"})]}),e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-800",children:"Market Opportunity"}),e.jsx("p",{className:"text-lg font-bold text-blue-600 mt-1",children:t(r*.23)}),e.jsx("p",{className:"text-sm text-blue-700",children:"Untapped potential with current providers"})]})]})})]}),e.jsxs(g,{children:[e.jsx(C,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5"}),"AI Recommendations"]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("p",{className:"font-medium text-sm",children:"Optimize Provider Mix"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Increase HotelBeds allocation by 15% for 12% ROI improvement"})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("p",{className:"font-medium text-sm",children:"Performance Monitoring"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Sabre showing declining performance - investigate alternatives"})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("p",{className:"font-medium text-sm",children:"Market Expansion"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Consider partnering with 2 new activity providers for 8% revenue boost"})]})]})})]})]})})]})]})},Ee=()=>{const[c,S]=o.useState([]),[p,y]=o.useState([]),[N,j]=o.useState(!1),[b,k]=o.useState(null),_=async()=>{j(!0);try{const r=[{id:"pattern_1",pattern_type:"booking_flow_optimization",frequency:847,impact_score:92,description:"Users abandoning bookings at payment stage during peak hours (6-8 PM AEST)",recommendations:["Implement express checkout for returning customers","Add payment timeout warnings 2 minutes before expiry","Offer saved payment methods for faster processing"],affected_services:["payment_processor","booking_engine"],time_window:"Peak hours 18:00-20:00 AEST",confidence:.94},{id:"pattern_2",pattern_type:"provider_performance_correlation",frequency:432,impact_score:78,description:"Amadeus API latency increases 340% during Asian market hours",recommendations:["Implement request queuing during high-traffic periods","Consider regional API endpoints for better performance","Add circuit breaker for provider failover at >2s response time"],affected_services:["amadeus_api","booking_service"],time_window:"Asian market hours 09:00-17:00 JST",confidence:.87},{id:"pattern_3",pattern_type:"revenue_optimization",frequency:256,impact_score:85,description:"Premium customers (>$2000 bookings) prefer mobile completion but start on desktop",recommendations:["Implement seamless cross-device booking continuation","Send SMS links for mobile completion","Prioritize mobile UI/UX for high-value bookings"],affected_services:["mobile_app","web_platform","notification_service"],time_window:"Business hours weekdays",confidence:.91},{id:"pattern_4",pattern_type:"customer_behavior_prediction",frequency:189,impact_score:73,description:"Customers searching flights 3+ times likely to book within 48 hours",recommendations:["Trigger personalized offers after 3rd search","Implement price alerts for frequent searchers","Show social proof (other customers booking similar trips)"],affected_services:["search_engine","marketing_automation","pricing_engine"],time_window:"Continuous monitoring",confidence:.82}],i=[{stage:"Search & Discovery",conversion_rate:34.2,avg_time_spent:4.7,drop_off_points:["Complex search filters","No results for specific dates"],optimization_opportunities:["Simplified search interface","Flexible date suggestions"]},{stage:"Selection & Comparison",conversion_rate:67.8,avg_time_spent:8.3,drop_off_points:["Too many options","Unclear pricing"],optimization_opportunities:["Smart recommendation engine","Clear price breakdown"]},{stage:"Booking & Payment",conversion_rate:82.4,avg_time_spent:6.1,drop_off_points:["Payment timeouts","Required field errors"],optimization_opportunities:["Extended payment windows","Auto-save progress"]},{stage:"Confirmation & Follow-up",conversion_rate:96.7,avg_time_spent:2.1,drop_off_points:["Email delivery issues"],optimization_opportunities:["Multiple confirmation channels","SMS backup"]}];S(r),y(i),k(new Date().toISOString()),await E.functions.invoke("correlation-data-collector",{body:{correlation_id:`pattern_analysis_${Date.now()}`,request_type:"advanced_pattern_analysis",status:"completed",service_name:"pattern_analyzer",metadata:{patterns_identified:r.length,avg_confidence:r.reduce((t,m)=>t+m.confidence,0)/r.length,high_impact_patterns:r.filter(t=>t.impact_score>80).length,total_frequency:r.reduce((t,m)=>t+m.frequency,0)}}})}catch(r){console.error("Error generating patterns:",r)}finally{j(!1)}},A=r=>r>=90?"bg-red-100 text-red-800 border-red-200":r>=75?"bg-orange-100 text-orange-800 border-orange-200":r>=60?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-green-100 text-green-800 border-green-200",P=r=>r>=.9?"text-green-600":r>=.8?"text-yellow-600":"text-red-600";return o.useEffect(()=>{_()},[]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(ye,{className:"h-6 w-6"}),"Advanced Pattern Analysis"]}),b&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Last analysis: ",new Date(b).toLocaleString("en-AU",{timeZone:"Australia/Sydney"})]})]}),e.jsxs(M,{onClick:_,disabled:N,variant:"outline",children:[e.jsx(H,{className:`h-4 w-4 mr-2 ${N?"animate-pulse":""}`}),N?"Analyzing...":"Refresh Analysis"]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:c.map(r=>e.jsxs(g,{className:"border-l-4 border-l-primary",children:[e.jsx(C,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(I,{className:"text-base",children:r.description}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{className:A(r.impact_score),children:["Impact: ",r.impact_score]}),e.jsx(B,{variant:"outline",children:e.jsxs("span",{className:P(r.confidence),children:[(r.confidence*100).toFixed(0),"% confident"]})})]})]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Frequency"}),e.jsxs("p",{className:"font-medium",children:[r.frequency," occurrences"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Time Window"}),e.jsx("p",{className:"font-medium",children:r.time_window})]})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium mb-2 flex items-center gap-1",children:[e.jsx(K,{className:"h-4 w-4"}),"Affected Services"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:r.affected_services.map(i=>e.jsx(B,{variant:"secondary",className:"text-xs",children:i.replace(/_/g," ")},i))})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium mb-2 flex items-center gap-1",children:[e.jsx(L,{className:"h-4 w-4"}),"Recommendations"]}),e.jsx("ul",{className:"text-sm space-y-1",children:r.recommendations.map((i,t)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-primary",children:"•"}),e.jsx("span",{className:"text-muted-foreground",children:i})]},t))})]})]})]},r.id))}),e.jsxs(g,{children:[e.jsx(C,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5"}),"Customer Journey Intelligence"]})}),e.jsx(h,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:p.map((r,i)=>e.jsxs("div",{className:"relative",children:[e.jsx(g,{className:"h-full",children:e.jsxs(h,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-sm",children:r.stage}),e.jsxs(B,{variant:"outline",className:"text-xs",children:["Step ",i+1]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Conversion Rate"}),e.jsxs("p",{className:"text-xl font-bold text-green-600",children:[r.conversion_rate,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Avg Time Spent"}),e.jsxs("p",{className:"text-sm font-medium flex items-center gap-1",children:[e.jsx(X,{className:"h-3 w-3"}),r.avg_time_spent," min"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Drop-off Points"}),e.jsx("div",{className:"space-y-1",children:r.drop_off_points.map((t,m)=>e.jsx("div",{className:"text-xs bg-red-50 text-red-700 px-2 py-1 rounded",children:t},m))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Optimizations"}),e.jsx("div",{className:"space-y-1",children:r.optimization_opportunities.map((t,m)=>e.jsx("div",{className:"text-xs bg-green-50 text-green-700 px-2 py-1 rounded",children:t},m))})]})]})]})}),i<p.length-1&&e.jsx("div",{className:"hidden md:block absolute -right-2 top-1/2 transform -translate-y-1/2 z-10",children:e.jsx("div",{className:"w-4 h-4 bg-primary rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})})]},r.stage))})})]}),e.jsxs(g,{children:[e.jsx(C,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5"}),"Real-time Pattern Detection"]})}),e.jsx(h,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Patterns"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.filter(r=>r.impact_score>80).length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"High Impact"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[c.length>0?Math.round(c.reduce((r,i)=>r+i.confidence,0)/c.length*100):0,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Confidence"})]})]})})]})]})},Pe=()=>{const[c,S]=o.useState([]),[p,y]=o.useState(!1),[N,j]=o.useState(""),[b,k]=o.useState("all"),[_,A]=o.useState(null),[P,r]=o.useState([]),[i,t]=o.useState([]),[m,x]=o.useState("tracking"),[a,f]=o.useState(!1),{toast:n}=me();ve();const{requestAnalysis:d,isAnalyzing:l,latestAnalysis:v}=je(),{isConnected:D,events:J}=Ae(),O=async()=>{try{y(!0),A(null);let s=E.from("correlation_tracking").select("*").order("created_at",{ascending:!1}).limit(100);b!=="all"&&(s=s.eq("status",b)),N.trim()&&(s=s.or(`correlation_id.ilike.%${N}%,user_id.eq.${N}`));const{data:u,error:q}=await s;q?(console.error("Failed to fetch correlation data:",q),A("Unable to connect to correlation database"),S([]),n({title:"Connection Error",description:"Could not load correlation tracking data",variant:"destructive"})):(S(u||[]),!u||u.length===0?S([]):Y(u))}catch(s){console.error("Correlation fetch error:",s),A("Failed to fetch correlation data"),S([]),n({title:"Database Error",description:"Unable to load correlation tracking data",variant:"destructive"})}finally{y(!1)}},Y=o.useCallback(async s=>{if(!(!s||s.length===0)){f(!0);try{const u={total_requests:s.length,success_rate:s.filter(w=>w.status==="completed").length/s.length*100,avg_duration:s.reduce((w,T)=>w+(T.duration_ms||0),0)/s.length,common_failures:s.filter(w=>w.status==="failed").map(w=>{var T,$;return((T=w.request_data)==null?void 0:T.error_message)||(($=w.response_data)==null?void 0:$.error_message)||"Unknown error"}),request_types:[...new Set(s.map(w=>w.request_type))],services:[...new Set(s.map(w=>{var T,$,U;return((T=w.request_data)==null?void 0:T.service_name)||(($=w.request_data)==null?void 0:$.service)||((U=w.response_data)==null?void 0:U.service_name)}).filter(Boolean))]};await d("system_health",u,`Analyze correlation tracking patterns and identify performance bottlenecks, failure patterns, and optimization opportunities for ${s.length} tracked requests.`);const q=[];u.success_rate<90&&q.push({pattern:"low_success_rate",severity:"high",message:`Success rate is ${u.success_rate.toFixed(1)}%, below optimal threshold`,recommendation:"Investigate failed requests and implement retry mechanisms",confidence:.95}),u.avg_duration>2e3&&q.push({pattern:"high_latency",severity:"medium",message:`Average response time ${(u.avg_duration/1e3).toFixed(2)}s exceeds target`,recommendation:"Optimize service calls and implement caching strategies",confidence:.87}),t(q)}catch(u){console.error("Error analyzing correlation patterns:",u)}finally{f(!1)}}},[d]);o.useEffect(()=>{const s=E.channel("correlation-updates").on("postgres_changes",{event:"*",schema:"public",table:"correlation_tracking"},u=>{console.log("Real-time correlation update:",u),O(),u.eventType==="INSERT"&&n({title:"New Correlation Tracked",description:`New ${u.new.request_type} request being tracked`,variant:"default"})}).subscribe();return()=>{E.removeChannel(s)}},[n]),o.useEffect(()=>{J.length>0&&J.filter(u=>u.source==="correlation_tracking"||u.type==="system_alert").length>0&&O()},[J]),o.useEffect(()=>{O()},[b]);const ue=s=>{switch(s){case"completed":return e.jsx(Se,{className:"h-4 w-4 text-green-600"});case"failed":return e.jsx(de,{className:"h-4 w-4 text-red-600"});case"in_progress":return e.jsx(X,{className:"h-4 w-4 text-yellow-600 animate-spin"});default:return e.jsx(F,{className:"h-4 w-4 text-gray-500"})}},pe=s=>{switch(s){case"completed":return"bg-green-100 text-green-800 border-green-200";case"failed":return"bg-red-100 text-red-800 border-red-200";case"in_progress":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},xe=s=>s?s<1e3?`${s}ms`:`${(s/1e3).toFixed(2)}s`:"N/A",ee=s=>{try{return new Intl.DateTimeFormat("en-AU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:"Australia/Sydney",hour12:!1}).format(new Date(s))}catch{return new Date(s).toLocaleString("en-AU",{timeZone:"Australia/Sydney"})}},ge=s=>{s.preventDefault(),O()},se=()=>{j(""),k("all"),O()},te=async()=>{if(c.length===0){n({title:"No Data Available",description:"Cannot analyze correlation patterns without data",variant:"destructive"});return}await Y(c),n({title:"Analysis Triggered",description:"Master Bot is analyzing correlation patterns",variant:"default"})};return e.jsx("div",{className:"space-y-6 p-6",children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Correlation Tracker"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${D?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm text-muted-foreground",children:D?"Real-time Active":"Disconnected"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(M,{onClick:te,disabled:a||l||c.length===0,variant:"outline",size:"sm",children:[e.jsx(Z,{className:`h-4 w-4 mr-2 ${a||l?"animate-pulse":""}`}),"Analyze Patterns"]}),e.jsxs(M,{onClick:se,disabled:p,variant:"outline",size:"sm",children:[e.jsx(fe,{className:`h-4 w-4 mr-2 ${p?"animate-spin":""}`}),"Refresh"]})]})]}),e.jsxs("form",{onSubmit:ge,className:"flex space-x-2",children:[e.jsx(_e,{placeholder:"Search by correlation ID or user ID...",value:N,onChange:s=>j(s.target.value),className:"flex-1"}),e.jsx(M,{type:"submit",disabled:p,size:"sm",children:e.jsx(ke,{className:"h-4 w-4"})})]}),e.jsxs(G,{value:m,onValueChange:x,children:[e.jsxs(W,{className:"grid w-full grid-cols-3",children:[e.jsxs(R,{value:"tracking",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Tracking (",c.length,")"]}),e.jsxs(R,{value:"patterns",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Patterns & Analytics"]}),e.jsxs(R,{value:"intelligence",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Business Intelligence"]})]}),e.jsx(z,{value:"intelligence",children:e.jsx(Re,{})}),e.jsx(z,{value:"patterns",children:e.jsx(Ee,{})}),e.jsxs(z,{value:"tracking",className:"space-y-4",children:[e.jsx(G,{value:b,onValueChange:s=>k(s),children:e.jsxs(W,{className:"grid w-full grid-cols-4",children:[e.jsxs(R,{value:"all",children:["All (",c.length,")"]}),e.jsxs(R,{value:"in_progress",children:["In Progress (",c.filter(s=>s.status==="in_progress").length,")"]}),e.jsxs(R,{value:"completed",children:["Completed (",c.filter(s=>s.status==="completed").length,")"]}),e.jsxs(R,{value:"failed",children:["Failed (",c.filter(s=>s.status==="failed").length,")"]})]})}),_&&e.jsxs(Q,{variant:"destructive",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx(V,{children:_})]}),e.jsx("div",{className:"space-y-4",children:p?e.jsx(g,{children:e.jsxs(h,{className:"p-6 text-center",children:[e.jsx(X,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading correlations..."})]})}):c.length===0?e.jsx(g,{children:e.jsxs(h,{className:"p-6 text-center",children:[e.jsx(F,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"No correlations found"}),e.jsx(M,{onClick:se,variant:"outline",size:"sm",className:"mt-2",children:"Try Again"})]})}):c.map(s=>{var u,q,w,T,$,U,re,ae,ne,ie;return e.jsxs(g,{className:"border-border",children:[e.jsx(C,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[ue(s.status),e.jsx(I,{className:"text-lg font-semibold",children:s.request_type.replace(/_/g," ").toUpperCase()}),e.jsx(B,{className:`${pe(s.status)} border`,children:s.status.toUpperCase()}),(((u=s.request_data)==null?void 0:u.service_name)||((q=s.request_data)==null?void 0:q.service)||((w=s.response_data)==null?void 0:w.service_name))&&e.jsx(B,{variant:"outline",className:"text-xs",children:((T=s.request_data)==null?void 0:T.service_name)||(($=s.request_data)==null?void 0:$.service)||((U=s.response_data)==null?void 0:U.service_name)})]}),e.jsx("div",{className:"text-sm text-muted-foreground font-mono",children:xe(s.duration_ms)})]})}),e.jsx(h,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1 text-foreground",children:"Correlation ID"}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono bg-muted p-2 rounded border",children:s.correlation_id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1 text-foreground",children:"Timestamps"}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("p",{children:["Started: ",ee(s.created_at)]}),s.completed_at&&e.jsxs("p",{children:["Completed: ",ee(s.completed_at)]})]})]}),s.user_id&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1 text-foreground",children:"User ID"}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono bg-muted p-2 rounded border",children:s.user_id})]}),(((re=s.request_data)==null?void 0:re.error_message)||((ae=s.response_data)==null?void 0:ae.error_message))&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1 text-foreground",children:"Error Message"}),e.jsx("p",{className:"text-sm text-red-600 bg-red-50 p-2 rounded border",children:((ne=s.request_data)==null?void 0:ne.error_message)||((ie=s.response_data)==null?void 0:ie.error_message)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1 text-foreground",children:"Request Data"}),e.jsx("div",{className:"text-xs text-muted-foreground bg-muted p-2 rounded border max-h-20 overflow-y-auto",children:e.jsx("pre",{children:JSON.stringify(s.request_data,null,2)})})]}),s.response_data&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"text-sm font-medium mb-1 text-foreground",children:"Response Data"}),e.jsx("div",{className:"text-xs text-muted-foreground bg-muted p-2 rounded border max-h-32 overflow-y-auto",children:e.jsx("pre",{children:JSON.stringify(s.response_data,null,2)})})]})]})})]},s.id)})})]}),e.jsx(z,{value:"patterns",className:"space-y-4",children:e.jsxs(g,{children:[e.jsx(C,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Correlation Patterns & Analytics"]})}),e.jsx(h,{children:c.length>0?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(g,{children:e.jsxs(h,{className:"p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(c.filter(s=>s.status==="completed").length/c.length*100).toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Success Rate"})]})}),e.jsx(g,{children:e.jsxs(h,{className:"p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(c.reduce((s,u)=>s+(u.duration_ms||0),0)/c.length),"ms"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Duration"})]})}),e.jsx(g,{children:e.jsxs(h,{className:"p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:[...new Set(c.map(s=>s.request_type))].length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Request Types"})]})})]}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No data available for pattern analysis"})})]})}),e.jsx(z,{value:"insights",className:"space-y-4",children:e.jsxs(g,{children:[e.jsx(C,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),"Master Bot Insights",(a||l)&&e.jsx(H,{className:"h-4 w-4 animate-pulse text-yellow-500"})]})}),e.jsxs(h,{children:[i.length>0?e.jsx("div",{className:"space-y-4",children:i.map((s,u)=>e.jsxs(Q,{variant:s.severity==="high"||s.severity==="critical"?"destructive":"default",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx(V,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium",children:s.message}),e.jsx("p",{className:"text-sm",children:s.recommendation}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Pattern: ",s.pattern]}),e.jsxs("span",{children:["Confidence: ",(s.confidence*100).toFixed(0),"%"]})]})]})})]},u))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No insights available yet"}),e.jsx(M,{onClick:te,disabled:a||l||c.length===0,children:"Generate Insights"})]}),v&&e.jsxs(g,{className:"mt-4",children:[e.jsx(C,{children:e.jsx(I,{className:"text-lg",children:"Latest Master Bot Analysis"})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",children:v.summary||"Analysis in progress..."}),v.actionItems&&v.actionItems.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Action Items:"}),e.jsx("ul",{className:"text-sm text-muted-foreground list-disc list-inside space-y-1",children:v.actionItems.map((s,u)=>e.jsx("li",{children:s},u))})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Analysis Complete | Generated: ",new Date().toLocaleString()]})]})})]})]})]})})]})]})})},Ye=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Correlation Tracking"}),e.jsx("p",{className:"text-muted-foreground",children:"Track request correlation IDs and debug complex booking flows"})]}),e.jsx(Pe,{})]});export{Ye as default};
