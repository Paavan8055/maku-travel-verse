import{x as h,r as t,K as p,j as e,O as c,a7 as x}from"./index-BuFvfeSJ-1758786228561.js";const j=({children:o,redirectTo:u="/"})=>{const{user:s,loading:d}=h(),[l,r]=t.useState(!1),[m,n]=t.useState(!0),f=p();return t.useEffect(()=>{(async()=>{if(!s){r(!1),n(!1);return}try{const{data:a,error:i}=await x.rpc("is_admin",{user_id_param:s.id});i?(console.error("Error checking admin status:",i),r(!1)):r(a||!1)}catch(a){console.error("Admin check error:",a),r(!1)}finally{n(!1)}})()},[s]),d||m?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):s?l?e.jsx(e.Fragment,{children:o}):e.jsx(c,{to:u,replace:!0}):e.jsx(c,{to:"/auth",state:{from:f},replace:!0})};export{j as A};
