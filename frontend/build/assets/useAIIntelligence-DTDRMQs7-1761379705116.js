var q=Object.defineProperty;var W=(e,t,n)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var D=(e,t,n)=>W(e,typeof t!="symbol"?t+"":t,n);import{l as d,u as B,h as H,r as a}from"./index-7Ai-VyBw-1761379705116.js";class G{constructor(){D(this,"backendUrl","https://maku-travel-ai.preview.emergentagent.com")}async analyzeTravelDNA(t){try{const n=await fetch(`${this.backendUrl}/api/ai/travel-dna/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({include_social_data:!0,include_behavioral_patterns:!0,analysis_depth:"comprehensive"})});return n.ok?await n.json():this.getMockTravelDNAResponse(t)}catch(n){return d.error("Error analyzing travel DNA:",n),this.getMockTravelDNAResponse(t)}}async getIntelligentRecommendations(t,n){try{const c=new URLSearchParams({max_results:((n==null?void 0:n.max_results)||10).toString(),include_social_proof:((n==null?void 0:n.include_social_proof)!==!1).toString(),confidence_threshold:((n==null?void 0:n.confidence_threshold)||.7).toString(),...(n==null?void 0:n.categories)&&{categories:n.categories.join(",")}}),o=await fetch(`${this.backendUrl}/api/ai/recommendations/${t}?${c}`);return o.ok?await o.json():this.getMockIntelligentRecommendations(t)}catch(c){return d.error("Error getting intelligent recommendations:",c),this.getMockIntelligentRecommendations(t)}}async optimizeJourney(t,n,c){try{const o=await fetch(`${this.backendUrl}/api/ai/journey-optimization`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:t,destination_ids:n,preferences:c||{optimize_for:"balanced",travel_style:"comfort"}})});return o.ok?await o.json():this.getMockJourneyOptimization(t,n)}catch(o){return d.error("Error optimizing journey:",o),this.getMockJourneyOptimization(t,n)}}async getPredictiveInsights(t){try{const n=await fetch(`${this.backendUrl}/api/ai/predictive-insights/${t}`);return n.ok?await n.json():this.getMockPredictiveInsights(t)}catch(n){return d.error("Error getting predictive insights:",n),this.getMockPredictiveInsights(t)}}async submitFeedback(t){try{return(await fetch(`${this.backendUrl}/api/ai/feedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok}catch(n){return d.error("Error submitting feedback:",n),!1}}async getRecommendationExplanation(t,n){try{const c=await fetch(`${this.backendUrl}/api/ai/explain/${n}?user_id=${t}`);return c.ok?await c.json():{explanation:"This recommendation is based on your travel personality, social connections, and optimal timing factors. Our AI analyzed your preferences for cultural experiences and found this destination highly matches your interests.",confidence:.85}}catch(c){return d.error("Error getting recommendation explanation:",c),null}}getMockTravelDNAResponse(t){return{travel_dna:{user_id:t,primary_type:"cultural_explorer",secondary_type:"photographer",confidence_score:.87,personality_factors:[{factor:"culture",weight:.9,confidence:.92,source:"individual_behavior",trend:"increasing"},{factor:"photography",weight:.8,confidence:.85,source:"social_influence",trend:"stable"},{factor:"food",weight:.7,confidence:.78,source:"explicit_preference",trend:"increasing"},{factor:"adventure",weight:.4,confidence:.65,source:"ai_inference",trend:"stable"}],social_influence_factors:[{factor_type:"friend_influence",influence_strength:.3,source_users:["friend_1","friend_2"],destinations_influenced:["kyoto","rome","paris"],confidence:.75}],behavioral_patterns:[{pattern_type:"browsing_behavior",pattern_data:{peak_browsing_hours:[19,20,21],preferred_content_types:["cultural_sites","local_cuisine","photography_spots"],average_session_duration:25.5},strength:.8,last_updated:new Date}],last_analyzed:new Date,analysis_version:"3.1.0"},confidence_breakdown:{individual_data_confidence:.85,social_data_confidence:.78,behavioral_pattern_confidence:.89,overall_confidence:.87},recommendations_count:15,last_updated:new Date,next_analysis_recommended:new Date(Date.now()+7*24*60*60*1e3)}}getMockIntelligentRecommendations(t){return{recommendations:[{destination_id:"florence_italy",destination_name:"Florence",country:"Italy",continent:"Europe",recommendation_score:94,recommendation_reasons:[{reason_type:"personality_match",reason_text:"Perfect match for cultural explorers with world-class art museums and Renaissance architecture",confidence:.92,weight:.4},{reason_type:"social_influence",reason_text:"3 of your travel buddies have this on their dream list",confidence:.85,weight:.2},{reason_type:"seasonal_optimal",reason_text:"April-May offers perfect weather and fewer crowds",confidence:.88,weight:.3},{reason_type:"price_opportunity",reason_text:"Flight prices 25% below average for next month",confidence:.78,weight:.1}],optimal_timing:{best_months:[4,5,9,10],best_season:"spring",price_optimal_window:{start_month:4,end_month:5,savings_percentage:25},weather_optimal_window:{start_month:4,end_month:6,weather_score:95},crowd_optimal_window:{start_month:4,end_month:5,crowd_level:"medium"}},price_insights:[{insight_type:"price_drop_predicted",current_price_index:.85,predicted_price_change:-15,confidence:.82,time_horizon:21,action_recommendation:"Book within next 3 weeks for best prices"}],social_proof:{friends_visited_count:2,friends_planning_count:3,community_popularity_trend:"rising",recent_social_activity:[{user_id:"friend_1",username:"ArtLover_Anna",activity_type:"added_to_dreams",activity_date:new Date(Date.now()-2*24*60*60*1e3)}],social_recommendation_score:87},ai_insights:[{insight_type:"perfect_match",insight_text:"Florence combines your love for culture and photography opportunities perfectly",confidence:.91,actionable:!0},{insight_type:"social_connection",insight_text:"Your friend Anna visited last month and highly recommends the Uffizi Gallery",confidence:.85,actionable:!0}],urgency_score:75,expires_at:new Date(Date.now()+21*24*60*60*1e3)},{destination_id:"angkor_wat_cambodia",destination_name:"Angkor Wat",country:"Cambodia",continent:"Asia",recommendation_score:88,recommendation_reasons:[{reason_type:"rare_find",reason_text:"Unique UNESCO World Heritage site perfect for photography",confidence:.89,weight:.35},{reason_type:"personality_match",reason_text:"Ancient culture and spiritual significance align with your interests",confidence:.87,weight:.35},{reason_type:"trending",reason_text:"Rising popularity among cultural explorers like you",confidence:.82,weight:.3}],optimal_timing:{best_months:[11,12,1,2],best_season:"winter",price_optimal_window:{start_month:11,end_month:1,savings_percentage:20},weather_optimal_window:{start_month:11,end_month:3,weather_score:92},crowd_optimal_window:{start_month:11,end_month:12,crowd_level:"low"}},price_insights:[{insight_type:"seasonal_trend",current_price_index:1.1,predicted_price_change:-20,confidence:.85,time_horizon:60,action_recommendation:"Wait for dry season (Nov-Mar) for better prices and weather"}],social_proof:{friends_visited_count:0,friends_planning_count:1,community_popularity_trend:"rising",recent_social_activity:[],social_recommendation_score:45},ai_insights:[{insight_type:"hidden_gem",insight_text:"Less crowded than other cultural sites but equally spectacular",confidence:.88,actionable:!0}],urgency_score:40}],user_travel_dna:{user_id:t,primary_type:"cultural_explorer",confidence_score:.87,personality_factors:[],social_influence_factors:[],behavioral_patterns:[],last_analyzed:new Date,analysis_version:"3.1.0"},total_recommendations:15,personalization_factors:[{factor:"culture",weight:.9,confidence:.92,source:"individual_behavior",trend:"increasing"}],social_influence_summary:{total_social_signals:12,friend_influence_strength:.3,community_trend_alignment:.75},processing_metadata:{analysis_time_ms:245,data_sources_used:["user_behavior","social_data","price_data","weather_data"],ai_model_version:"3.1.0"}}}getMockJourneyOptimization(t,n){return{optimized_journey:{journey_id:"journey_"+Date.now(),user_id:t,selected_destinations:n,optimized_route:{route_segments:[{from_destination_id:n[0],to_destination_id:n[1],travel_method:"flight",distance_km:1240,duration_hours:2.5,estimated_cost:180,carbon_footprint_kg:85,recommended_stops:[]}],total_distance_km:1240,total_travel_time_hours:2.5,carbon_footprint_kg:85,recommended_travel_methods:[{method:"flight",cost_score:60,time_score:20,comfort_score:80,environmental_score:40,recommended:!0}],seasonal_considerations:[{destination_id:n[0],month:5,weather_score:90,price_score:70,crowd_score:60,overall_desirability:85}]},total_estimated_cost:2400,total_duration_days:14,optimization_score:87,created_at:new Date,optimization_factors:[{factor_type:"cost",weight:.3,user_specified:!1},{factor_type:"weather",weight:.4,user_specified:!0}]},alternative_routes:[],optimization_summary:{cost_savings_percentage:25,time_savings_percentage:15,carbon_reduction_percentage:10,weather_optimization_score:92},recommendations:{best_travel_months:[4,5,9,10],recommended_duration:14,budget_breakdown:{flights:800,accommodation:980,food:420,activities:200}}}}getMockPredictiveInsights(t){return{insights:[{insight_id:"insight_"+Date.now(),user_id:t,insight_type:"price_alert",title:"Price Drop Alert: Japan",description:"Flight prices to Tokyo are expected to drop 30% in the next 2 weeks based on historical patterns and current booking trends.",confidence:87,urgency:"high",actionable_steps:[{step_number:1,action_type:"wait_for_price_drop",action_text:"Wait 10-14 days before booking flights to Tokyo",estimated_impact:"Save $400-500 on flights"},{step_number:2,action_type:"add_to_dreams",action_text:"Add Tokyo to your dream destinations if not already there",estimated_impact:"Track price changes automatically"}],predicted_value:450,expires_at:new Date(Date.now()+14*24*60*60*1e3),related_destinations:["tokyo","osaka","kyoto"],ai_reasoning:"Our AI detected a pattern in airline pricing data suggesting seasonal adjustments are coming. Combined with your interest in cultural destinations, this represents a high-value opportunity."},{insight_id:"insight_"+(Date.now()+1),user_id:t,insight_type:"next_dream_prediction",title:"Your Next Dream: Morocco",description:"Based on your travel DNA and recent browsing patterns, Morocco (specifically Marrakech) has a 78% likelihood of becoming your next dream destination.",confidence:78,urgency:"medium",actionable_steps:[{step_number:1,action_type:"research_more",action_text:"Explore Marrakech cultural sites and photography opportunities",estimated_impact:"Discover perfect match destination"}],predicted_value:0,expires_at:new Date(Date.now()+30*24*60*60*1e3),related_destinations:["marrakech","fez","casablanca"],ai_reasoning:"Your strong preference for cultural experiences, combined with growing interest in North African destinations among similar users, indicates high alignment with Morocco."}],user_prediction_accuracy:82,total_insights:5,high_confidence_insights:2,actionable_insights:4,potential_savings:450,next_analysis_date:new Date(Date.now()+24*60*60*1e3)}}}const m=new G,V=()=>{const{user:e}=B(),{toast:t}=H(),[n,c]=a.useState(null),[o,S]=a.useState([]),[p,R]=a.useState([]),[T,E]=a.useState(null),[M,y]=a.useState(!0),[N,w]=a.useState(!1),[C,v]=a.useState(!1),[j,l]=a.useState(null),[P,$]=a.useState(0),[I,J]=a.useState(0),[u,O]=a.useState(null),g=a.useCallback(async(r=!1)=>{if(e!=null&&e.id)try{w(!0),l(null);const i=await m.analyzeTravelDNA(e.id);i&&(c(i.travel_dna),J(i.confidence_breakdown.overall_confidence),O(i.last_updated),t({title:"ðŸ§¬ Travel DNA Analyzed!",description:`You're a ${i.travel_dna.primary_type.replace("_"," ")} with ${Math.round(i.confidence_breakdown.overall_confidence*100)}% confidence.`,duration:4e3}))}catch(i){const s=i instanceof Error?i.message:"Failed to analyze travel DNA";l(s),d.error("Error analyzing travel DNA:",i)}finally{w(!1)}},[e==null?void 0:e.id,t]),h=a.useCallback(async r=>{if(e!=null&&e.id)try{y(!0),l(null);const i=await m.getIntelligentRecommendations(e.id,r);i&&(S(i.recommendations),$(i.processing_metadata.analysis_time_ms),i.user_travel_dna&&c(i.user_travel_dna),d.info("AI recommendations loaded",{count:i.recommendations.length,processingTime:i.processing_metadata.analysis_time_ms}))}catch(i){const s=i instanceof Error?i.message:"Failed to get intelligent recommendations";l(s),d.error("Error getting recommendations:",i)}finally{y(!1)}},[e==null?void 0:e.id]),F=a.useCallback(async(r,i)=>{if(!(e!=null&&e.id))return t({title:"Authentication Required",description:"Please log in to use AI journey optimization.",variant:"destructive"}),null;if(r.length<2)return t({title:"More Destinations Needed",description:"Select at least 2 destinations to optimize your journey.",variant:"destructive"}),null;try{v(!0),l(null);const s=await m.optimizeJourney(e.id,r,i);if(s)return E(s.optimized_journey),t({title:"ðŸš€ Journey Optimized!",description:`Saved ${s.optimization_summary.cost_savings_percentage}% on costs and ${s.optimization_summary.time_savings_percentage}% on travel time.`,duration:5e3}),s}catch(s){const _=s instanceof Error?s.message:"Failed to optimize journey";l(_),t({title:"Optimization Failed",description:_,variant:"destructive"}),d.error("Error optimizing journey:",s)}finally{v(!1)}return null},[e==null?void 0:e.id,t]),f=a.useCallback(async()=>{if(e!=null&&e.id)try{const r=await m.getPredictiveInsights(e.id);r&&(R(r.insights),r.insights.filter(i=>i.urgency==="high"||i.urgency==="critical").forEach(i=>{t({title:`ðŸ”® ${i.title}`,description:i.description,duration:8e3})}))}catch(r){d.error("Error getting predictive insights:",r)}},[e==null?void 0:e.id,t]),U=a.useCallback(async(r,i,s)=>{if(!(e!=null&&e.id))return!1;try{const _={user_id:e.id,feedback_type:"recommendation_rating",target_id:r,rating:i,feedback_text:s},A=await m.submitFeedback(_);return A&&t({title:"Feedback Submitted",description:"Thank you! Your feedback helps improve our AI recommendations.",duration:3e3}),A}catch(_){return d.error("Error submitting feedback:",_),!1}},[e==null?void 0:e.id,t]),L=a.useCallback(async r=>{if(!(e!=null&&e.id))return null;try{return await m.getRecommendationExplanation(e.id,r)}catch(i){return d.error("Error getting recommendation explanation:",i),null}},[e==null?void 0:e.id]),Y=a.useCallback(r=>o.filter(i=>i.recommendation_reasons.some(s=>r.includes(s.reason_type))),[o]),b=a.useCallback((r=.8)=>o.filter(i=>i.recommendation_score>=r*100),[o]),k=a.useCallback((r=70)=>o.filter(i=>i.urgency_score>=r),[o]),x=a.useCallback(()=>o.filter(r=>r.social_proof.friends_visited_count>0||r.social_proof.friends_planning_count>0||r.social_proof.social_recommendation_score>50),[o]),z=a.useCallback(()=>p.filter(r=>r.actionable_steps&&r.actionable_steps.length>0),[p]);return a.useEffect(()=>{e!=null&&e.id&&(async()=>(await Promise.all([h({max_results:10}),f()]),(!n||!u||Date.now()-u.getTime()>6048e5)&&await g()))()},[e==null?void 0:e.id,h,f,g,n,u]),{travelDNA:n,intelligentRecommendations:o,predictiveInsights:p,currentJourney:T,loading:M,analyzingDNA:N,optimizingJourney:C,error:j,aiProcessingTime:P,confidenceScore:I,lastAnalysisDate:u,analyzeTravelDNA:g,getIntelligentRecommendations:h,optimizeJourney:F,getPredictiveInsights:f,submitRecommendationFeedback:U,getRecommendationExplanation:L,highConfidenceRecommendations:b(),urgentRecommendations:k(),socialRecommendations:x(),actionableInsights:z(),getRecommendationsByType:Y,getHighConfidenceRecommendations:b,getUrgentRecommendations:k,getSocialRecommendations:x,getActionableInsights:z}};export{V as u};
