import{g as b,h as w,r as g,j as e,a as S,d as C,e as A,i as k,b as U,B as j,l as L,k as E,m as F,N as P}from"./index-C3qX88Wl-1760114995879.js";import{I as p}from"./input-B6Bms-RP-1760114995879.js";import{L as x}from"./label-DIqMBTAQ-1760114995879.js";import{S as T}from"./separator-Cmr_1FEl-1760114995879.js";import{M as v}from"./mail-eRt5eOiQ-1760114995879.js";import{G as D}from"./github-WOBcwYH--1760114995879.js";import{U as y}from"./user-Du_ZO8d8-1760114995879.js";import{L as I}from"./lock-jNgfZIBG-1760114995879.js";import{L as O}from"./LoginForm-DNmBMF4p-1760114995879.js";const q=({onSwitchToLogin:o})=>{const{signUp:u,signInWithOAuth:f}=b(),{toast:i}=w(),[l,c]=g.useState(!1),[n,r]=g.useState({email:"",password:"",firstName:"",lastName:""}),N=async t=>{var s,d;t.preventDefault(),c(!0);try{const{data:a,error:m}=await u(n.email,n.password,{first_name:n.firstName,last_name:n.lastName});console.log("Signup response:",{data:a,error:m}),m?(s=m.message)!=null&&s.includes("User already registered")||(d=m.message)!=null&&d.includes("already been registered")||m.status===422?(i({title:"Account Already Exists",description:"An account with this email already exists. Please sign in instead.",variant:"destructive"}),setTimeout(()=>{o()},2e3)):i({title:"Sign Up Error",description:m.message,variant:"destructive"}):(console.log("Signup successful, checking session..."),a!=null&&a.user&&(a!=null&&a.session)?(console.log("User immediately confirmed with session"),i({title:"Welcome to Maku.travel!",description:"Account created successfully. Redirecting to dashboard..."})):a!=null&&a.user&&!(a!=null&&a.session)?(console.log("User created but needs email confirmation"),i({title:"Check Your Email",description:"Please check your email and click the confirmation link to complete your signup."})):(console.log("Unexpected signup response"),i({title:"Account Created",description:"Your account has been created. Please try signing in."})))}catch(a){L.error("Signup error:",a),i({title:"Error",description:"An unexpected error occurred",variant:"destructive"})}finally{c(!1)}},h=async t=>{c(!0);try{const{error:s}=await f(t);s&&i({title:"OAuth Error",description:s.message,variant:"destructive"})}catch{i({title:"Error",description:"Failed to sign in with OAuth",variant:"destructive"})}finally{c(!1)}};return e.jsxs(S,{className:"w-full max-w-md mx-auto border-none shadow-2xl bg-card/80 backdrop-blur-sm",children:[e.jsxs(C,{className:"text-center space-y-4",children:[e.jsx(A,{className:"text-2xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"Join Maku.travel"}),e.jsx(k,{className:"text-muted-foreground",children:"Create your account to start your travel journey"})]}),e.jsxs(U,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(j,{variant:"outline",className:"w-full h-11 transition-all duration-200 hover:scale-105",onClick:()=>h("google"),disabled:l,children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Continue with Google"]}),e.jsxs(j,{variant:"outline",className:"w-full h-11 transition-all duration-200 hover:scale-105",onClick:()=>h("github"),disabled:l,children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Continue with GitHub"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"my-4"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:"bg-background px-3 text-xs text-muted-foreground",children:"Or create account with email"})})]}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"firstName",children:"First Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(p,{id:"firstName",type:"text",placeholder:"John",value:n.firstName,onChange:t=>r(s=>({...s,firstName:t.target.value})),className:"pl-10",required:!0,"aria-label":"First name"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"lastName",children:"Last Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(p,{id:"lastName",type:"text",placeholder:"Doe",value:n.lastName,onChange:t=>r(s=>({...s,lastName:t.target.value})),className:"pl-10",required:!0,"aria-label":"Last name"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(p,{id:"email",type:"email",placeholder:"john@example.com",value:n.email,onChange:t=>r(s=>({...s,email:t.target.value})),className:"pl-10",required:!0,"aria-label":"Email address"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(p,{id:"password",type:"password",placeholder:"••••••••",value:n.password,onChange:t=>r(s=>({...s,password:t.target.value})),className:"pl-10",required:!0,minLength:6,"aria-label":"Password"})]})]}),e.jsx(j,{type:"submit",className:"w-full h-11 bg-gradient-to-r from-primary to-secondary hover:opacity-90 transition-all duration-200",disabled:l,children:l?"Creating Account...":"Create Account"})]}),e.jsxs("div",{className:"text-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Already have an account? "}),e.jsx("button",{type:"button",className:"text-primary hover:underline font-medium",onClick:o,children:"Sign in"})]})]})]})},z=()=>{var t,s;const{user:o,loading:u}=b(),[f,i]=E(),l=F(),[c,n]=g.useState(()=>f.get("tab")==="signup"),r=((s=(t=l.state)==null?void 0:t.from)==null?void 0:s.pathname)||"/",N=()=>{n(!0),i({tab:"signup"})},h=()=>{n(!1),i({})};if(g.useEffect(()=>{if(o&&!u){const d=r==="/roadmap"||r==="/"?"/dashboard":r,a=setTimeout(()=>{window.location.href=d},100);return()=>clearTimeout(a)}},[o,u,r]),u)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 to-secondary/5",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(o){const d=r==="/roadmap"||r==="/"?"/dashboard":r;return e.jsx(P,{to:d,replace:!0})}return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 to-secondary/5 p-4",children:e.jsx("div",{className:"w-full max-w-md",children:c?e.jsx(q,{onSwitchToLogin:h}):e.jsx(O,{onSwitchToSignUp:N})})})};export{z as default};
