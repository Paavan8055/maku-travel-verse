import{h,r as a,n as p,j as e,N as c,s as x}from"./index-CoUQs0uW-1758476777413.js";const j=({children:o,redirectTo:u="/"})=>{const{user:s,loading:d}=h(),[l,r]=a.useState(!1),[m,n]=a.useState(!0),f=p();return a.useEffect(()=>{(async()=>{if(!s){r(!1),n(!1);return}try{const{data:t,error:i}=await x.rpc("is_admin",{user_id_param:s.id});i?(console.error("Error checking admin status:",i),r(!1)):r(t||!1)}catch(t){console.error("Admin check error:",t),r(!1)}finally{n(!1)}})()},[s]),d||m?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):s?l?e.jsx(e.Fragment,{children:o}):e.jsx(c,{to:u,replace:!0}):e.jsx(c,{to:"/auth",state:{from:f},replace:!0})};export{j as A};
