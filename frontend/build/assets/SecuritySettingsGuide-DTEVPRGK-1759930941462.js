import{j as e,f as t,A as h,T as u,q as g,a,d as n,e as r,b as c,B as p}from"./index-7HSUJgza-1759930941462.js";import{S as l}from"./shield-_-CGtLvW-1759930941462.js";import{K as f}from"./key-DRm2c-rE-1759930941462.js";import{E as j}from"./external-link-DI7mGgpY-1759930941462.js";import{C as N}from"./clock-DzGQmIyr-1759930941462.js";import{C as y}from"./circle-check-big-DtMdJaMM-1759930941462.js";const E=()=>{const o=[{id:"otp-expiry",title:"OTP Expiry Too Long",level:"warning",description:"OTP expiry time exceeds recommended threshold of 5 minutes",action:"Reduce OTP expiry to 5 minutes in Supabase Auth settings",link:"https://supabase.com/dashboard/project/_/auth/settings",category:"Authentication",fix:"Go to Auth Settings → Email → OTP expiry: change from default to 300 seconds (5 minutes)"},{id:"password-protection",title:"Leaked Password Protection Disabled",level:"warning",description:"Password breach protection is currently disabled",action:"Enable leaked password protection in Auth settings",link:"https://supabase.com/dashboard/project/_/auth/settings",category:"Authentication",fix:'Go to Auth Settings → Password → Enable "Prevent sign ups with leaked passwords"'},{id:"rls-policies",title:"Missing RLS Policies (Fixed)",level:"info",description:"Some cache tables had missing RLS policies - now fixed via migration",action:"No action required - policies added automatically",category:"Database Security",fix:"Completed: Added proper INSERT/DELETE policies for cache tables"},{id:"function-security",title:"Function Security Hardening (Fixed)",level:"info",description:"Database functions had mutable search_path - now secured",action:"No action required - functions updated with SECURITY DEFINER SET search_path",category:"Database Security",fix:"Completed: All functions now use secure search_path configuration"}],d=s=>{switch(s){case"warning":return e.jsx(u,{className:"h-4 w-4 text-warning"});case"info":return e.jsx(y,{className:"h-4 w-4 text-success"});case"critical":return e.jsx(l,{className:"h-4 w-4 text-destructive"});default:return e.jsx(l,{className:"h-4 w-4 text-muted-foreground"})}},x=s=>{switch(s){case"warning":return"bg-warning text-warning-foreground";case"info":return"bg-success text-success-foreground";case"critical":return"bg-destructive text-destructive-foreground";default:return"bg-muted text-muted-foreground"}},i=o.filter(s=>s.level==="warning"),m=o.filter(s=>s.level==="info");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Security Configuration Guide"}),e.jsx("p",{className:"text-muted-foreground",children:"Manual configuration required for optimal security"})]}),e.jsxs(t,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(l,{className:"h-4 w-4"}),i.length," pending actions"]})]}),i.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-warning",children:"⚠️ Manual Configuration Required"}),e.jsxs(h,{children:[e.jsx(u,{className:"h-4 w-4"}),e.jsx(g,{children:"The following security settings require manual configuration in your Supabase dashboard. These cannot be automated via migrations and must be set by a project admin."})]}),i.map(s=>e.jsxs(a,{className:"border-warning",children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[d(s.level),e.jsx(r,{className:"text-lg",children:s.title}),e.jsx(t,{className:x(s.level),children:s.level})]}),e.jsx(t,{variant:"outline",children:s.category})]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:s.description}),e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4"}),"How to Fix:"]}),e.jsx("p",{className:"text-sm",children:s.fix})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Action: ",s.action]}),s.link&&e.jsx(p,{size:"sm",variant:"outline",asChild:!0,children:e.jsxs("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",children:["Open Settings",e.jsx(j,{className:"h-4 w-4 ml-2"})]})})]})]})]},s.id))]}),m.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-success",children:"✅ Automatically Fixed"}),m.map(s=>e.jsxs(a,{className:"border-success",children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[d(s.level),e.jsx(r,{className:"text-lg",children:s.title}),e.jsx(t,{className:x(s.level),children:"Completed"})]}),e.jsx(t,{variant:"outline",children:s.category})]})}),e.jsxs(c,{children:[e.jsx("p",{className:"text-muted-foreground",children:s.description}),e.jsxs("div",{className:"mt-2 text-sm text-success",children:["✓ ",s.fix]})]})]},s.id))]}),e.jsxs(a,{children:[e.jsx(n,{children:e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5"}),"Next Steps"]})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Priority 1:"})," Configure the ",i.length," pending authentication settings in your Supabase dashboard to ensure optimal security."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Priority 2:"})," After making changes, use the Security Scanner to verify all issues are resolved."]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Note: Database security fixes have been applied automatically via migrations. Only authentication settings require manual configuration."})]})})]})]})};export{E as SecuritySettingsGuide};
