var ht=Object.defineProperty;var ut=(s,t,a)=>t in s?ht(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var ms=(s,t,a)=>ut(s,typeof t!="symbol"?t+"":t,a);import{c as te,r as u,j as e,a as R,d as I,e as F,T as qe,b as P,B as D,R as pt,s as se,l as O,w as B,f as T,t as H,L as Ie,x as ws,y as gt,z as ft,D as jt,E as ks,h as Fe,u as We,S as V,F as Nt,A as yt,q as vt,P as Ce,G as bt,I as ye,J as ve,K as be,p as wt,g as kt,X as Je,o as St,k as Ss,M as Ct}from"./index-BQpPtHlO-1761189704029.js";import{P as ie,a as le,b as ce,G as Ze,N as Dt,S as Rt}from"./Navbar-C8zET3oj-1761189704029.js";import{E as Cs}from"./ErrorBoundary-CIbv_9eN-1761189704029.js";import{S as Ds}from"./search-DZ19T6G2-1761189704029.js";import{D as _e,a as Oe,b as xs,c as hs}from"./dialog-BQRK9L_b-1761189704029.js";import{T as Pt,a as At,b as us,c as ps}from"./tabs-CpoFCv_q-1761189704029.js";import{C as Se}from"./checkbox-BMVDCd8z-1761189704029.js";import{S as ee}from"./separator-C_jkwNPQ-1761189704029.js";import{C as ne}from"./circle-check-big-Cn826zS4-1761189704029.js";import{W as Ke}from"./wifi-BSdXDxRD-1761189704029.js";import{S as Xe}from"./shield-DCv5vNO9-1761189704029.js";import{C as Le}from"./car-LT9ruceu-1761189704029.js";import{U as Qe}from"./utensils-DNGkgAsV-1761189704029.js";import{c as Rs,R as Tt,P as Mt,W as Et,C as $t,T as It,D as Ft,a as Ps,O as Lt,b as Ut}from"./index-HjiT6eXe-1761189704029.js";import{I as _t}from"./info-CKMeY-pg-1761189704029.js";import{C as As}from"./circle-x-Dh5n7yyt-1761189704029.js";import{u as Ot,I as Bt,S as Ht}from"./SessionRecoveryBanner-CwTVxa6a-1761189704029.js";import{B as gs,G as zt}from"./grid-3x3-k9Wqg8rQ-1761189704029.js";import{C as Vt}from"./coffee-C-A1sb8G-1761189704029.js";import{U as Z}from"./users-DCU3xZTC-1761189704029.js";import{f as X}from"./format-B_geuFI4-1761189704029.js";import{u as Gt}from"./bookingStore-0pUV_uMZ-1761189704029.js";import{M as q}from"./map-pin-D3J4obXn-1761189704029.js";import{S as G}from"./star-Dp49_fi6-1761189704029.js";import{W as Yt}from"./waves-B0bmzA6p-1761189704029.js";import{S as es,a as ss,b as ts,c as as,d as oe}from"./select-BrgTZd52-1761189704029.js";import{S as Me}from"./slider-BM78cqmK-1761189704029.js";import{S as qt,a as Wt,b as Jt,c as Zt,d as Kt}from"./sheet-K_nuIjLW-1761189704029.js";import{A as Xt}from"./arrow-up-narrow-wide-B3LeuwXI-1761189704029.js";import{M as Qt}from"./map-DaYUCnTo-1761189704029.js";import{F as ea}from"./filter-Cv_fLIo--1761189704029.js";import"./switch-Cf_t1lpz-1761189704029.js";import{L as he}from"./label-501wlcgJ-1761189704029.js";import{I as Ee}from"./input-DX9-JoIq-1761189704029.js";import{T as ge}from"./trending-down-kY2UIEFC-1761189704029.js";import{C as fe}from"./clock-B_3UTqNU-1761189704029.js";import{m as sa}from"./map-sydney-C4DH91SS-1761189704029.js";import{N as rs,D as ta,P as aa}from"./PerformanceWrapper-LqEa-VhW-1761189704029.js";import{T as Y}from"./trending-up-VS_V_Kec-1761189704029.js";import{P as fs}from"./percent-BfVASMcX-1761189704029.js";import{C as je}from"./calendar-CBBPXiQe-1761189704029.js";import{E as ns}from"./eye-Dyci9fKO-1761189704029.js";import{V as ra,a as na}from"./volume-x-ATjLP3Oe-1761189704029.js";import{H as $e}from"./heart-qfsQokPL-1761189704029.js";import{c as ia,t as js,m as Ts,a as Ms}from"./en-US-CC7XSppg-1761189704029.js";import{a as Be,C as la}from"./calendar-CniaezZQ-1761189704029.js";import{D as Ge}from"./dollar-sign-DoEyJqlC-1761189704029.js";import{T as Es}from"./target-CWZTiiqV-1761189704029.js";import{b as ca,a as oa}from"./otaDataClient-CmsXZbqZ-1761189704029.js";import{S as ue}from"./sparkles-Dax9ZCOw-1761189704029.js";import{C as da}from"./chevron-down-DJpirxwt-1761189704029.js";import{P as ma}from"./phone-CuUJyR3A-1761189704029.js";import{u as xa}from"./useAccessibility-B_Fd8Wwp-1761189704029.js";import{C as $s}from"./credit-card-B5gvVq8l-1761189704029.js";import{S as Ns}from"./shopping-cart-SRwBfAvb-1761189704029.js";import{Z as ha}from"./zap-DVgp2afI-1761189704029.js";import{P as He}from"./package-BFTnPnZa-1761189704029.js";import{P as de}from"./plus-DKNGijgd-1761189704029.js";import{P as ua}from"./plane-DezSEat0-1761189704029.js";import{A as pa}from"./award-D7xpIYji-1761189704029.js";import{M as ga}from"./minus-DMTEb9Pf-1761189704029.js";import"./useApiHealth-CSHtOHxG-1761189704029.js";import"./avatar-BUz1x7zP-1761189704029.js";import"./index-MxjrYXqY-1761189704029.js";import"./globe-BKZiM5lF-1761189704029.js";import"./useHealthMonitor-6RBs7AUv-1761189704029.js";import"./useAIIntelligence-D0RmrFJ8-1761189704029.js";import"./brain-CAcZu9bd-1761189704029.js";import"./settings-DA-l4HFn-1761189704029.js";import"./user-B_w-Djxr-1761189704029.js";import"./index-CvlXgRr5-1761189704029.js";import"./circle-alert-CgClAJ85-1761189704029.js";import"./index-BdQq_4o_-1761189704029.js";import"./usePerformanceOptimizer-BZ7QJozp-1761189704029.js";import"./endOfMonth-BGhCnuGP-1761189704029.js";import"./chevron-left-CDGyQLgC-1761189704029.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=te("Accessibility",[["circle",{cx:"16",cy:"4",r:"1",key:"1grugj"}],["path",{d:"m18 19 1-7-6 1",key:"r0i19z"}],["path",{d:"m5 8 3-3 5.5 3-2.36 3.5",key:"9ptxx2"}],["path",{d:"M4.24 14.5a5 5 0 0 0 6.88 6",key:"10kmtu"}],["path",{d:"M13.76 17.5a5 5 0 0 0-6.88-6",key:"2qq6rc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=te("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=te("Ear",[["path",{d:"M6 8.5a6.5 6.5 0 1 1 13 0c0 6-6 6-6 10a3.5 3.5 0 1 1-7 0",key:"1dfaln"}],["path",{d:"M15 8.5a2.5 2.5 0 0 0-5 0v1a2 2 0 1 1 0 4",key:"1qnva7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=te("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=te("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=te("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=te("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=te("SlidersVertical",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=te("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);function xe(s,t){const a=()=>ia(t==null?void 0:t.in,NaN),c=Ca(s);let h;if(c.date){const n=Da(c.date,2);h=Ra(n.restDateString,n.year)}if(!h||isNaN(+h))return a();const f=+h;let l=0,d;if(c.time&&(l=Pa(c.time),isNaN(l)))return a();if(c.timezone){if(d=Aa(c.timezone),isNaN(d))return a()}else{const n=new Date(f+l),o=js(0,t==null?void 0:t.in);return o.setFullYear(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()),o.setHours(n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds()),o}return js(f+l+d,t==null?void 0:t.in)}const Pe={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},wa=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ka=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Sa=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Ca(s){const t={},a=s.split(Pe.dateTimeDelimiter);let r;if(a.length>2)return t;if(/:/.test(a[0])?r=a[0]:(t.date=a[0],r=a[1],Pe.timeZoneDelimiter.test(t.date)&&(t.date=s.split(Pe.timeZoneDelimiter)[0],r=s.substr(t.date.length,s.length))),r){const c=Pe.timezone.exec(r);c?(t.time=r.replace(c[1],""),t.timezone=c[1]):t.time=r}return t}function Da(s,t){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=s.match(a);if(!r)return{year:NaN,restDateString:""};const c=r[1]?parseInt(r[1]):null,h=r[2]?parseInt(r[2]):null;return{year:h===null?c:h*100,restDateString:s.slice((r[1]||r[2]).length)}}function Ra(s,t){if(t===null)return new Date(NaN);const a=s.match(wa);if(!a)return new Date(NaN);const r=!!a[4],c=we(a[1]),h=we(a[2])-1,f=we(a[3]),l=we(a[4]),d=we(a[5])-1;if(r)return Ia(t,l,d)?Ta(t,l,d):new Date(NaN);{const n=new Date(0);return!Ea(t,h,f)||!$a(t,c)?new Date(NaN):(n.setUTCFullYear(t,h,Math.max(c,f)),n)}}function we(s){return s?parseInt(s):1}function Pa(s){const t=s.match(ka);if(!t)return NaN;const a=ze(t[1]),r=ze(t[2]),c=ze(t[3]);return Fa(a,r,c)?a*Ts+r*Ms+c*1e3:NaN}function ze(s){return s&&parseFloat(s.replace(",","."))||0}function Aa(s){if(s==="Z")return 0;const t=s.match(Sa);if(!t)return 0;const a=t[1]==="+"?-1:1,r=parseInt(t[2]),c=t[3]&&parseInt(t[3])||0;return La(r,c)?a*(r*Ts+c*Ms):NaN}function Ta(s,t,a){const r=new Date(0);r.setUTCFullYear(s,0,4);const c=r.getUTCDay()||7,h=(t-1)*7+a+1-c;return r.setUTCDate(r.getUTCDate()+h),r}const Ma=[31,null,31,30,31,30,31,31,30,31,30,31];function Fs(s){return s%400===0||s%4===0&&s%100!==0}function Ea(s,t,a){return t>=0&&t<=11&&a>=1&&a<=(Ma[t]||(Fs(s)?29:28))}function $a(s,t){return t>=1&&t<=(Fs(s)?366:365)}function Ia(s,t,a){return t>=1&&t<=53&&a>=0&&a<=6}function Fa(s,t,a){return s===24?t===0&&a===0:a>=0&&a<60&&t>=0&&t<60&&s>=0&&s<25}function La(s,t){return t>=0&&t<=59}class Ua extends u.Component{constructor(a){super(a);ms(this,"handleRetry",()=>{var a,r;this.setState({hasError:!1,error:null}),(r=(a=this.props).onRetry)==null||r.call(a)});this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,r){console.error("SearchErrorBoundary caught an error:",a,r)}render(){if(this.state.hasError){const a=this.props.searchType||"search";return e.jsxs(R,{className:"mx-auto max-w-lg",children:[e.jsx(I,{children:e.jsxs(F,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(qe,{className:"h-5 w-5"}),a," Search Error"]})}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("p",{className:"text-muted-foreground",children:["We couldn't complete your ",a," search due to a technical issue. This might be temporary - please try searching again."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{onClick:this.handleRetry,className:"flex-1",children:[e.jsx(pt,{className:"h-4 w-4 mr-2"}),"Try Again"]}),e.jsxs(D,{variant:"outline",onClick:()=>window.location.href="/",className:"flex-1",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"New Search"]})]})]})]})}return this.props.children}}const Ve={USD:{code:"USD",symbol:"$",name:"US Dollar",decimals:2},EUR:{code:"EUR",symbol:"€",name:"Euro",decimals:2},GBP:{code:"GBP",symbol:"£",name:"British Pound",decimals:2},JPY:{code:"JPY",symbol:"¥",name:"Japanese Yen",decimals:0},CAD:{code:"CAD",symbol:"C$",name:"Canadian Dollar",decimals:2},AUD:{code:"AUD",symbol:"A$",name:"Australian Dollar",decimals:2},CHF:{code:"CHF",symbol:"CHF",name:"Swiss Franc",decimals:2},CNY:{code:"CNY",symbol:"¥",name:"Chinese Yuan",decimals:2}},ys="USD",re=(s,t=ys,a={})=>{var d;const{showSymbol:r=!0,showCode:c=!1,locale:h="en-US"}=a,f=typeof s=="string"?parseFloat(s):s;if(isNaN(f))return r?`${((d=Ve[t])==null?void 0:d.symbol)||""}0.00`:"0.00";const l=Ve[t]||Ve[ys];try{const n=new Intl.NumberFormat(h,{style:"currency",currency:l.code,minimumFractionDigits:l.decimals,maximumFractionDigits:l.decimals}).format(f);return!r&&c?`${f.toFixed(l.decimals)} ${l.code}`:!r&&!c?f.toFixed(l.decimals):r&&c?`${n} ${l.code}`:n}catch{const o=r?l.symbol:"",i=c?` ${l.code}`:"";return`${o}${f.toFixed(l.decimals)}${i}`}},_a=()=>{const[s,t]=u.useState([]),[a,r]=u.useState(null),[c,h]=u.useState([]),[f,l]=u.useState(!1),[d,n]=u.useState(null),o=u.useCallback(async i=>{var x,m,j;l(!0),n(null);try{console.log("Fetching hotel offers for:",i);const{data:v,error:b}=await se.functions.invoke("amadeus-hotel-offers",{body:{hotelId:i.hotelId,checkIn:i.checkIn,checkOut:i.checkOut,adults:i.adults||2,children:i.children||0,rooms:i.rooms||1,currency:i.currency||"USD"}});if(b){O.error("Hotel offers function error:",b);const p=b.message||"Failed to fetch hotel offers";throw p.includes("404")||p.includes("not found")?new Error("Hotel not found. Please try a different hotel or check your search criteria."):p.includes("timeout")||p.includes("network")?new Error("Connection timeout. Please check your internet connection and try again."):p.includes("rate limit")?new Error("Too many requests. Please wait a moment and try again."):new Error(p)}if(v!=null&&v.success)t(v.offers||[]),r(v.hotel),h(v.ancillaryServices||[]),console.log(`✅ Found ${((x=v.offers)==null?void 0:x.length)||0} offers for hotel ${i.hotelId}`),console.log(`✅ Found ${((m=v.ancillaryServices)==null?void 0:m.length)||0} ancillary services`),((j=v.offers)==null?void 0:j.length)===0?(B.info("No room offers available for selected dates. Try adjusting your dates or check other hotels."),n("No rooms available for the selected dates. Please try different dates or another hotel.")):B.success(`Found ${v.offers.length} room options`);else throw new Error((v==null?void 0:v.error)||"Failed to fetch hotel offers")}catch(v){O.error("Hotel offers error:",v);const b=v.message||"Failed to fetch hotel offers";n(b),B.error(b)}finally{l(!1)}},[]);return{offers:s,hotel:a,ancillaryServices:c,loading:f,error:d,fetchOffers:o}},Oa=({addOns:s,selectedAddOns:t,onAddOnsChange:a,nights:r,currency:c})=>{const h=i=>{const x=t.includes(i)?t.filter(m=>m!==i):[...t,i];a(x)},f=i=>{switch(i){case"meals":return e.jsx(Qe,{className:"h-4 w-4"});case"transport":return e.jsx(Le,{className:"h-4 w-4"});case"services":return e.jsx(Xe,{className:"h-4 w-4"});case"amenities":return e.jsx(Ke,{className:"h-4 w-4"});default:return e.jsx(ne,{className:"h-4 w-4"})}},l=i=>i.perNight?i.price*r:i.price,d=()=>s.filter(i=>t.includes(i.id)).reduce((i,x)=>i+l(x),0),n=s.reduce((i,x)=>{const m=x.category;return i[m]||(i[m]=[]),i[m].push(x),i},{}),o={meals:"Dining & Meals",transport:"Transportation",services:"Hotel Services",amenities:"Room Amenities"};return s.length===0?e.jsxs(R,{children:[e.jsx(I,{children:e.jsxs(F,{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"h-5 w-5"}),e.jsx("span",{children:"Add-ons & Extras"})]})}),e.jsx(P,{children:e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No additional services available for this booking."})})]}):e.jsxs(R,{children:[e.jsx(I,{children:e.jsxs(F,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"h-5 w-5"}),e.jsx("span",{children:"Add-ons & Extras"})]}),t.length>0&&e.jsxs(T,{variant:"secondary",children:[t.length," selected"]})]})}),e.jsxs(P,{className:"space-y-6",children:[Object.entries(n).map(([i,x])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-3 flex items-center space-x-2",children:[f(i),e.jsx("span",{children:o[i]})]}),e.jsx("div",{className:"space-y-3",children:x.map(m=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg border hover:bg-muted/50 transition-colors",children:[e.jsx(Se,{id:m.id,checked:t.includes(m.id),onCheckedChange:()=>h(m.id),disabled:m.required}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:m.id,className:"font-medium cursor-pointer",children:[m.name,m.required&&e.jsx(T,{variant:"outline",className:"ml-2 text-xs",children:"Required"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:m.description}),m.perNight&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Per night for ",r," nights"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:[c," ",l(m).toFixed(2)]}),m.perNight&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[c," ",m.price.toFixed(2),"/night"]})]})]})})]},m.id))}),i!==Object.keys(n)[Object.keys(n).length-1]&&e.jsx(ee,{className:"mt-4"})]},i)),t.length>0&&e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex justify-between items-center font-medium",children:[e.jsx("span",{children:"Total add-ons:"}),e.jsxs("span",{children:[c," ",d().toFixed(2)]})]})})]})]})},Ba=({size:s="md",className:t,text:a})=>{const r={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"};return e.jsxs("div",{className:H("flex items-center justify-center gap-2",t),children:[e.jsx(Ie,{className:H("animate-spin",r[s])}),a&&e.jsx("span",{className:"text-sm text-muted-foreground",children:a})]})};var Ls="AlertDialog",[Ha]=gt(Ls,[Rs]),ae=Rs(),Us=s=>{const{__scopeAlertDialog:t,...a}=s,r=ae(t);return e.jsx(Tt,{...r,...a,modal:!0})};Us.displayName=Ls;var za="AlertDialogTrigger",Va=u.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...r}=s,c=ae(a);return e.jsx(Ut,{...c,...r,ref:t})});Va.displayName=za;var Ga="AlertDialogPortal",_s=s=>{const{__scopeAlertDialog:t,...a}=s,r=ae(t);return e.jsx(Mt,{...r,...a})};_s.displayName=Ga;var Ya="AlertDialogOverlay",Os=u.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...r}=s,c=ae(a);return e.jsx(Lt,{...c,...r,ref:t})});Os.displayName=Ya;var pe="AlertDialogContent",[qa,Wa]=Ha(pe),Ja=jt("AlertDialogContent"),Bs=u.forwardRef((s,t)=>{const{__scopeAlertDialog:a,children:r,...c}=s,h=ae(a),f=u.useRef(null),l=ws(t,f),d=u.useRef(null);return e.jsx(Et,{contentName:pe,titleName:Hs,docsSlug:"alert-dialog",children:e.jsx(qa,{scope:a,cancelRef:d,children:e.jsxs($t,{role:"alertdialog",...h,...c,ref:l,onOpenAutoFocus:ft(c.onOpenAutoFocus,n=>{var o;n.preventDefault(),(o=d.current)==null||o.focus({preventScroll:!0})}),onPointerDownOutside:n=>n.preventDefault(),onInteractOutside:n=>n.preventDefault(),children:[e.jsx(Ja,{children:r}),e.jsx(Ka,{contentRef:f})]})})})});Bs.displayName=pe;var Hs="AlertDialogTitle",zs=u.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...r}=s,c=ae(a);return e.jsx(It,{...c,...r,ref:t})});zs.displayName=Hs;var Vs="AlertDialogDescription",Gs=u.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...r}=s,c=ae(a);return e.jsx(Ft,{...c,...r,ref:t})});Gs.displayName=Vs;var Za="AlertDialogAction",Ys=u.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...r}=s,c=ae(a);return e.jsx(Ps,{...c,...r,ref:t})});Ys.displayName=Za;var qs="AlertDialogCancel",Ws=u.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...r}=s,{cancelRef:c}=Wa(qs,a),h=ae(a),f=ws(t,c);return e.jsx(Ps,{...h,...r,ref:f})});Ws.displayName=qs;var Ka=({contentRef:s})=>{const t=`\`${pe}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${pe}\` by passing a \`${Vs}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${pe}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return u.useEffect(()=>{var r;document.getElementById((r=s.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(t)},[t,s]),null},Xa=Us,Qa=_s,Js=Os,Zs=Bs,Ks=Ys,Xs=Ws,Qs=zs,et=Gs;const er=Xa,sr=Qa,st=u.forwardRef(({className:s,...t},a)=>e.jsx(Js,{className:H("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:a}));st.displayName=Js.displayName;const tt=u.forwardRef(({className:s,...t},a)=>e.jsxs(sr,{children:[e.jsx(st,{}),e.jsx(Zs,{ref:a,className:H("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t})]}));tt.displayName=Zs.displayName;const at=({className:s,...t})=>e.jsx("div",{className:H("flex flex-col space-y-2 text-center sm:text-left",s),...t});at.displayName="AlertDialogHeader";const rt=({className:s,...t})=>e.jsx("div",{className:H("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});rt.displayName="AlertDialogFooter";const nt=u.forwardRef(({className:s,...t},a)=>e.jsx(Qs,{ref:a,className:H("text-lg font-semibold",s),...t}));nt.displayName=Qs.displayName;const it=u.forwardRef(({className:s,...t},a)=>e.jsx(et,{ref:a,className:H("text-sm text-muted-foreground",s),...t}));it.displayName=et.displayName;const lt=u.forwardRef(({className:s,...t},a)=>e.jsx(Ks,{ref:a,className:H(ks(),s),...t}));lt.displayName=Ks.displayName;const ct=u.forwardRef(({className:s,...t},a)=>e.jsx(Xs,{ref:a,className:H(ks({variant:"outline"}),"mt-2 sm:mt-0",s),...t}));ct.displayName=Xs.displayName;const tr=({isOpen:s,onClose:t,onConfirm:a,title:r,description:c,confirmText:h="Confirm",cancelText:f="Cancel",variant:l="default",isLoading:d=!1})=>{const n=()=>{switch(l){case"destructive":return e.jsx(As,{className:"h-6 w-6 text-destructive"});case"success":return e.jsx(ne,{className:"h-6 w-6 text-green-500"});case"warning":return e.jsx(qe,{className:"h-6 w-6 text-yellow-500"});default:return e.jsx(_t,{className:"h-6 w-6 text-primary"})}},o=()=>{switch(l){case"destructive":return"destructive";default:return"default"}};return e.jsx(er,{open:s,onOpenChange:t,children:e.jsxs(tt,{className:"sm:max-w-md",children:[e.jsxs(at,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[n(),e.jsx(nt,{children:r})]}),e.jsx(it,{className:"text-left",children:c})]}),e.jsxs(rt,{children:[e.jsx(ct,{onClick:t,disabled:d,children:f}),e.jsx(lt,{onClick:a,disabled:d,className:o()==="destructive"?"bg-destructive hover:bg-destructive/90":"",children:d?"Processing...":h})]})]})})},ar=({isOpen:s,onClose:t,hotelId:a,hotelName:r,checkIn:c,checkOut:h,adults:f,children:l,rooms:d,currency:n,onRoomSelected:o})=>{var cs;const[i,x]=u.useState(null),[m,j]=u.useState([]),[v,b]=u.useState("rooms"),[p,g]=u.useState(!1),[w,y]=u.useState(!1),{offers:k,hotel:N,ancillaryServices:C,loading:E,error:L,fetchOffers:z}=_a(),{saveSession:W}=Ot(),Q=(C==null?void 0:C.length)>0?C.map(M=>({id:M.code||M.id||`addon-${Date.now()}`,name:M.name||M.description||"Service",description:M.description||M.name||"Additional service",price:M.price||0,currency:M.currency||n,category:M.category||"amenities",perNight:M.perNight||!1,required:!1})):[{id:"breakfast",name:"Continental Breakfast",description:"Start your day with a delicious breakfast buffet",price:25,currency:n,category:"meals",required:!1,perNight:!0},{id:"parking",name:"Valet Parking",description:"Convenient valet parking service",price:35,currency:n,category:"transport",required:!1,perNight:!0},{id:"wifi",name:"Premium WiFi",description:"High-speed internet access",price:15,currency:n,category:"amenities",required:!1,perNight:!0},{id:"late-checkout",name:"Late Check-out",description:"Check out up to 3 PM (subject to availability)",price:50,currency:n,category:"services",required:!1,perNight:!1}];u.useEffect(()=>{s&&a&&z({hotelId:a,checkIn:c,checkOut:h,adults:f,children:l,rooms:d,currency:n})},[s,a,c,h,f,l,d,n,z]);const me=M=>{x(M)},Ne=async()=>{if(!(!i||!N)){y(!0);try{W({hotelId:a,hotelName:r,checkIn:c,checkOut:h,adults:f,children:l,rooms:d,selectedOffer:i,selectedAddOns:(C||Q).filter(S=>m.includes(S.id)),step:"checkout"});const U=(C||Q).filter(S=>m.includes(S.id));await new Promise(S=>setTimeout(S,500)),o(i,N,U),t(),g(!1)}catch(M){console.error("Error proceeding to checkout:",M),B.error("Failed to proceed to checkout. Please try again.")}finally{y(!1)}}},J=()=>{i&&b("addons")},A=Math.ceil((new Date(h).getTime()-new Date(c).getTime())/(1e3*60*60*24)),$=()=>(C||Q).filter(U=>m.includes(U.id)).reduce((U,S)=>{const _=S.perNight?S.price*A:S.price;return U+_},0),is=()=>i?parseFloat(i.price.total)+$():0,ot=M=>M?M.type==="FREE_CANCELLATION"?`Free cancellation until ${M.deadline?new Date(M.deadline).toLocaleDateString():"check-in"}`:M.amount?`Cancellation fee: ${n} ${M.amount}`:"Non-refundable":"No cancellation info",Ue=M=>{var U,S;return(U=M.typeEstimated)!=null&&U.category?M.typeEstimated.category.replace(/_/g," ").toLowerCase().replace(/\b\w/g,_=>_.toUpperCase()):((S=M.type)==null?void 0:S.replace(/_/g," ").toLowerCase().replace(/\b\w/g,_=>_.toUpperCase()))||"Room"},dt=M=>{var U,S;return(U=M.typeEstimated)!=null&&U.beds&&((S=M.typeEstimated)!=null&&S.bedType)?`${M.typeEstimated.beds} ${M.typeEstimated.bedType.toLowerCase().replace(/_/g," ")}`:`Sleeps ${M.capacity}`},mt=M=>{const U=M.reduce((S,_)=>{const K=Ue(_.room);return S[K]||(S[K]=[]),S[K].push(_),S},{});return Object.keys(U).forEach(S=>{U[S].sort((_,K)=>parseFloat(_.price.total)-parseFloat(K.price.total))}),U},ls=M=>{var K,Re,os,ds;const U=((K=M.policies.cancellation)==null?void 0:K.type)==="FREE_CANCELLATION",S=((os=(Re=M.rateFamilyEstimated)==null?void 0:Re.type)==null?void 0:os.includes("BREAKFAST"))||((ds=M.room.description)==null?void 0:ds.toLowerCase().includes("breakfast"));let _="Standard Rate";return S&&U?_="Flexible with Breakfast":S?_="Non-refundable with Breakfast":U?_="Flexible Rate":_="Non-refundable Rate",_};if(E)return e.jsx(_e,{open:s,onOpenChange:t,children:e.jsx(Oe,{className:"max-w-4xl max-h-[80vh] overflow-hidden",children:e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 space-y-4",children:[e.jsx(Ba,{size:"lg",text:"Finding the best room options for you..."}),e.jsxs("div",{className:"text-sm text-muted-foreground text-center",children:[e.jsxs("p",{children:["Checking ",r]}),e.jsxs("p",{children:[X(new Date(c),"MMM dd")," - ",X(new Date(h),"MMM dd")," • ",f," Adults",l>0&&`, ${l} Children`]})]})]})})});if(L)return e.jsx(_e,{open:s,onOpenChange:t,children:e.jsxs(Oe,{className:"max-w-md",children:[e.jsx(xs,{children:e.jsx(hs,{children:"Unable to load rooms"})}),e.jsxs("div",{className:"py-4",children:[e.jsx("p",{className:"text-muted-foreground",children:L}),e.jsx(D,{onClick:()=>z({hotelId:a,checkIn:c,checkOut:h,adults:f,children:l,rooms:d,currency:n}),className:"mt-4 w-full",children:"Try Again"})]})]})});const xt=mt(k);return e.jsx(Cs,{children:e.jsxs(_e,{open:s,onOpenChange:t,children:[e.jsxs(Oe,{className:"max-w-6xl max-h-[85vh] overflow-y-auto",children:[e.jsxs(xs,{children:[e.jsx(hs,{className:"text-xl",children:v==="rooms"?`Choose your room at ${r}`:"Add extras to your stay"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[c," - ",h," • ",f," adult",f>1?"s":"",l>0?`, ${l} child${l>1?"ren":""}`:""," • ",d," room",d>1?"s":""," • ",A," night",A>1?"s":""]})]}),e.jsxs(Pt,{value:v,onValueChange:M=>b(M),children:[e.jsxs(At,{className:"grid w-full grid-cols-2",children:[e.jsxs(us,{value:"rooms",className:"flex items-center space-x-2",children:[e.jsx(gs,{className:"h-4 w-4"}),e.jsx("span",{children:"Choose Room"})]}),e.jsxs(us,{value:"addons",disabled:!i,className:"flex items-center space-x-2",children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Extras"})]})]}),e.jsx(ps,{value:"rooms",className:"space-y-6",children:k.length===0?e.jsx(R,{children:e.jsxs(P,{className:"py-8 text-center",children:[e.jsx("p",{className:"text-muted-foreground",children:"No rooms available for the selected dates."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Please try different dates or contact the hotel directly."})]})}):Object.entries(xt).map(([M,U])=>e.jsxs(R,{children:[e.jsx(I,{children:e.jsx(F,{className:"text-lg",children:M})}),e.jsx(P,{className:"space-y-4",children:U.map(S=>{var _;return e.jsx(R,{className:`cursor-pointer transition-all ${(i==null?void 0:i.id)===S.id?"ring-2 ring-primary border-primary":"hover:shadow-md border-muted"}`,onClick:()=>me(S),children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("h4",{className:"font-semibold",children:ls(S)}),(i==null?void 0:i.id)===S.id&&e.jsx(ne,{className:"h-4 w-4 text-primary"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(gs,{className:"h-4 w-4"}),e.jsx("span",{children:dt(S.room)})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsxs("span",{children:["Up to ",S.room.capacity," guests"]})]})]}),e.jsx("div",{className:"space-y-2",children:S.room.description&&S.room.description!=="No description available"&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:S.room.description})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[((_=S.policies.cancellation)==null?void 0:_.type)==="FREE_CANCELLATION"?e.jsxs(T,{variant:"outline",className:"text-green-600 border-green-600",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),"Free cancellation"]}):e.jsxs(T,{variant:"outline",className:"text-orange-600 border-orange-600",children:[e.jsx(As,{className:"h-3 w-3 mr-1"}),"Non-refundable"]}),S.policies.paymentType&&e.jsxs(T,{variant:"outline",children:[e.jsx(Xe,{className:"h-3 w-3 mr-1"}),S.policies.paymentType.replace(/_/g," ")]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"mb-1",children:ot(S.policies.cancellation)}),S.price.taxes&&S.price.taxes.length>0&&e.jsx("p",{children:"Includes taxes and fees"})]})]}),e.jsxs("div",{className:"text-right space-y-2 ml-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total for your stay"}),e.jsx("p",{className:"text-xl font-bold text-foreground",children:re(parseFloat(S.price.total),S.price.currency)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[re(parseFloat(S.price.total)/A,S.price.currency)," per night"]})]}),S.price.base!==S.price.total&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("p",{children:["Base: ",re(parseFloat(S.price.base),S.price.currency)]}),S.price.taxes&&S.price.taxes.length>0&&e.jsxs("p",{children:["Taxes: ",re(S.price.taxes.reduce((K,Re)=>K+parseFloat(Re.amount),0),S.price.currency)]})]})]})]})})},S.id)})})]},M))}),e.jsxs(ps,{value:"addons",className:"space-y-6",children:[i&&e.jsxs(R,{children:[e.jsx(I,{children:e.jsxs(F,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Selected Room"}),e.jsx(D,{variant:"outline",size:"sm",onClick:()=>b("rooms"),children:"Change Room"})]})}),e.jsx(P,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:Ue(i.room)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ls(i)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium",children:re(parseFloat(i.price.total),i.price.currency)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["for ",A," nights"]})]})]})})]}),e.jsx(Oa,{addOns:C||Q,selectedAddOns:m,onAddOnsChange:j,nights:A,currency:n}),$()>0&&e.jsx(R,{children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-center font-medium",children:[e.jsx("span",{children:"Add-ons total:"}),e.jsx("span",{children:re($(),n)})]})})})]})]}),k.length>0&&e.jsxs("div",{className:"flex justify-between items-center pt-6 border-t",children:[e.jsx(D,{variant:"outline",onClick:t,children:"Back to search"}),v==="rooms"?e.jsxs(D,{onClick:J,disabled:!i,children:["Continue to extras",i&&e.jsx("span",{className:"ml-2",children:re(parseFloat(i.price.total),i.price.currency)})]}):e.jsxs(D,{onClick:()=>g(!0),disabled:!i||w,className:"btn-primary",children:[w?"Processing...":"Continue to checkout",e.jsx("span",{className:"ml-2",children:re(is(),((cs=i==null?void 0:i.price)==null?void 0:cs.currency)||n)})]})]})]}),e.jsx(tr,{isOpen:p,onClose:()=>g(!1),onConfirm:Ne,title:"Confirm Your Selection",description:`Proceed to checkout with ${i?Ue(i.room):"selected room"} at ${r}? Your selection will be saved and you can modify it before final payment.`,confirmText:"Continue to Checkout",cancelText:"Review Selection",variant:"default",isLoading:w})]})})},rr=()=>{const[s,t]=u.useState([]),[a,r]=u.useState(!1),[c,h]=u.useState(null),{toast:f}=Fe(),l=u.useCallback(async d=>{var n,o;if(d){r(!0),h(null);try{console.log("🖼️ Fetching enhanced images for hotel:",d);const{data:i,error:x}=await se.functions.invoke("hotelbeds-image-content",{body:{hotelCode:d}});if(x)throw console.error("❌ Hotel images function error:",x),new Error(x.message||"Failed to fetch hotel images");if(i!=null&&i.success){const m=i.images||[];t(m),console.log(`✅ Found ${m.length} enhanced images for hotel ${d}`),m.length===0&&console.log("📷 No enhanced images available for hotel:",d)}else throw new Error((i==null?void 0:i.error)||"Failed to fetch hotel images")}catch(i){console.error("❌ Hotel images error:",i);const x=i.message||"Failed to fetch hotel images";h(x),t([]),!((n=i.message)!=null&&n.includes("credentials"))&&!((o=i.message)!=null&&o.includes("authentication"))&&f({title:"Image Loading Issue",description:"Hotel images temporarily unavailable",variant:"default"})}finally{r(!1)}}},[f]);return{images:s,loading:a,error:c,fetchImages:l}},nr=({hotel:s})=>{var d,n,o,i;const t=We(),[a,r]=u.useState(!1),{images:c,fetchImages:h}=rr();u.useEffect(()=>{var x;if((x=s.amadeus)!=null&&x.hotelId||s.id){const m=s.id;h(m)}},[s.id,(d=s.amadeus)==null?void 0:d.hotelId,h]);const f=x=>{switch(x.toLowerCase()){case"wifi":return e.jsx(Ke,{className:"h-4 w-4"});case"parking":return e.jsx(Le,{className:"h-4 w-4"});case"restaurant":return e.jsx(Qe,{className:"h-4 w-4"});case"pool":return e.jsx(Yt,{className:"h-4 w-4"});default:return null}},l=x=>Array.from({length:5},(m,j)=>e.jsx(G,{className:`h-4 w-4 ${j<x?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},j));return e.jsx(R,{className:"hover:shadow-md transition-shadow",children:e.jsx(P,{className:"p-0",children:e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"w-64 h-48 relative overflow-hidden rounded-l-lg",children:[e.jsx("img",{src:((n=c==null?void 0:c[0])==null?void 0:n.url)||((o=s.images)==null?void 0:o[0])||"/placeholder.svg",alt:s.name,className:"w-full h-full object-cover",onError:x=>{x.currentTarget.src="/placeholder.svg"}}),s.deals&&e.jsx("div",{className:"absolute top-3 left-3",children:e.jsxs(T,{className:"bg-green-500 text-white",children:["Save $",s.deals.savings]})})]}),e.jsx("div",{className:"flex-1 p-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:s.name}),e.jsx("div",{className:"flex items-center",children:l(s.starRating)})]}),e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(q,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.distanceFromCenter,"km from center"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(G,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"font-medium text-foreground",children:s.rating>0?s.rating.toFixed(1):"Not rated"})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.reviewCount>0?`(${s.reviewCount} reviews)`:"(No reviews yet)"}),e.jsx(T,{variant:"secondary",children:s.propertyType}),s.safetyRating&&e.jsxs(T,{variant:"outline",className:"text-xs",children:[e.jsx(Xe,{className:"h-3 w-3 mr-1"}),"Safety: ",s.safetyRating]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:s.description&&s.description!=="Hotel accommodation"?s.description:"Description not available"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.amenities.slice(0,4).map(x=>e.jsxs("div",{className:"flex items-center space-x-1",children:[f(x),e.jsx("span",{className:"text-xs text-muted-foreground",children:x})]},x)),s.amenities.length>4&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",s.amenities.length-4," more"]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[s.breakfast&&e.jsx(T,{variant:"outline",className:"text-xs",children:"✓ Breakfast included"}),e.jsx(T,{variant:"outline",className:"text-xs",children:s.cancellationPolicy})]})]}),e.jsxs("div",{className:"text-right space-y-2 ml-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"From"}),e.jsx("p",{className:"text-2xl font-bold text-foreground",children:s.pricePerNight>0?`${s.currency}${s.pricePerNight}`:"Price unavailable"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"per night"})]}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total"}),e.jsx("p",{className:"text-lg font-semibold text-foreground",children:s.totalPrice>0?`${s.currency}${s.totalPrice}`:"Contact for price"})]}),e.jsx(D,{className:"btn-primary w-full",disabled:s.pricePerNight<=0,onClick:()=>{s.pricePerNight<=0||r(!0)},children:s.pricePerNight>0?"Select Room":"Contact Hotel"}),e.jsx(ar,{isOpen:a,onClose:()=>r(!1),hotelId:((i=s.amadeus)==null?void 0:i.hotelId)||s.id,hotelName:s.name,checkIn:(()=>{const x=new URLSearchParams(window.location.search);return x.get("checkIn")||x.get("checkin")||new Date().toISOString().split("T")[0]})(),checkOut:(()=>{const x=new URLSearchParams(window.location.search);return x.get("checkOut")||x.get("checkout")||new Date(Date.now()+24*60*60*1e3).toISOString().split("T")[0]})(),adults:(()=>{const x=new URLSearchParams(window.location.search);return parseInt(x.get("adults")||x.get("guests")||"2")})(),children:(()=>{const x=new URLSearchParams(window.location.search);return parseInt(x.get("children")||"0")})(),rooms:(()=>{const x=new URLSearchParams(window.location.search);return parseInt(x.get("rooms")||"1")})(),currency:s.currency,onRoomSelected:(x,m,j)=>{var w,y,k,N,C;const v=(j==null?void 0:j.reduce((E,L)=>{const z=Math.ceil((new Date(x.checkOutDate).getTime()-new Date(x.checkInDate).getTime())/864e5),W=L.perNight?L.price*z:L.price;return E+W},0))||0,b=new URLSearchParams({hotelId:m.hotelId,hotelName:m.name,checkIn:x.checkInDate,checkOut:x.checkOutDate,adults:((w=x.guests.adults)==null?void 0:w.toString())||"2",children:((y=x.guests.children)==null?void 0:y.toString())||"0",rooms:"1",price:x.price.total,currency:x.price.currency,rateCode:x.rateCode,offerId:x.id}),p={type:"hotel-offer",hotel:{type:"hotel",hotelId:m.hotelId,name:m.name,chainCode:((k=s.amadeus)==null?void 0:k.chainCode)||"UNKNOWN",dupeId:String(((N=s.amadeus)==null?void 0:N.dupeId)||0),cityCode:"UNKNOWN",latitude:0,longitude:0,address:{lines:[s.address||""],postalCode:"",cityName:"",countryCode:""},...m},available:!0,offers:[{...x,price:{...x.price,fees:[],grandTotal:x.price.total},room:{...x.room,description:typeof x.room.description=="string"?{text:x.room.description,lang:"en"}:x.room.description}}],self:x.id},g={hotel:p.hotel,checkInDate:x.checkInDate,checkOutDate:x.checkOutDate,nights:Math.ceil((new Date(x.checkOutDate).getTime()-new Date(x.checkInDate).getTime())/(1e3*60*60*24)),guestCount:((C=x.guests)==null?void 0:C.adults)||2,roomCount:1,totalAmount:parseFloat(x.price.total),currency:x.price.currency};Gt.getState().setHotelBooking(p,g,j||[],v),t(`/hotel-checkout?${b.toString()}`)}})]})]})})]})})})},ir=()=>e.jsx(R,{className:"overflow-hidden",children:e.jsx(P,{className:"p-0",children:e.jsxs("div",{className:"flex flex-col lg:flex-row",children:[e.jsx("div",{className:"w-full lg:w-1/3",children:e.jsx(V,{className:"h-48 lg:h-56 w-full"})}),e.jsxs("div",{className:"flex-1 p-4 lg:p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(V,{className:"h-6 w-3/4 mb-2"}),e.jsx(V,{className:"h-4 w-1/2 mb-2"}),e.jsx(V,{className:"h-4 w-2/3"})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsx(V,{className:"h-4 w-16 mb-1"}),e.jsx(V,{className:"h-6 w-20"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx(V,{className:"h-6 w-16"}),e.jsx(V,{className:"h-6 w-20"}),e.jsx(V,{className:"h-6 w-14"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx(V,{className:"h-4 w-8"}),e.jsx(V,{className:"h-4 w-16"})]}),e.jsx(V,{className:"h-10 w-32"})]})]})]})})}),lr=()=>{const[s,t]=u.useState(null),[a,r]=u.useState(!1),c=async()=>{try{r(!0);const{data:h,error:f}=await se.functions.invoke("health-check");if(f)throw f;t(h)}catch(h){console.error("Health check failed:",h),t({status:"down",services:{database:{status:"down",responseTime:0},amadeus:{status:"down",responseTime:0},stripe:{status:"down",responseTime:0},supabase:{status:"down",responseTime:0}},timestamp:Date.now()})}finally{r(!1)}};return u.useEffect(()=>{c();const h=setInterval(c,3e4);return()=>clearInterval(h)},[]),{healthStatus:s,isLoading:a,checkHealth:c}},cr=s=>{var t;return{id:s.id||s.hotelId||`hotel-${Date.now()}`,name:s.name||"Hotel",description:s.description||"Hotel accommodation",address:((t=s.location)==null?void 0:t.address)||s.address||"Location not available",images:s.images&&s.images.length>0?s.images:[],starRating:s.starRating||s.rating||0,rating:s.guestRating||0,reviewCount:s.reviewCount||0,pricePerNight:s.pricePerNight||0,currency:s.currency||"USD",totalPrice:s.totalPrice||0,propertyType:s.propertyType||"Hotel",distanceFromCenter:s.distanceFromCenter||0,amenities:s.amenities||[],cancellationPolicy:s.cancellationPolicy||"No cancellation policy available",breakfast:s.breakfast||!1,safetyRating:s.safetyRating,pointsOfInterest:s.pointsOfInterest,deals:s.deals}},or=(s,t)=>{switch(t.type){case"SEARCH_START":return{...s,loading:!0,error:null,isEmpty:!1};case"SEARCH_SUCCESS":return{...s,loading:!1,hotels:t.payload.hotels,meta:t.payload.meta,isEmpty:t.payload.hotels.length===0,error:null};case"SEARCH_ERROR":return{...s,loading:!1,error:typeof t.payload=="string"?t.payload:t.payload.message,hotels:[],isEmpty:!0,meta:null};case"SEARCH_EMPTY":return{...s,loading:!1,isEmpty:!0,hotels:[],error:t.payload.error||null,meta:t.payload.meta||null};default:return s}},dr=s=>{const[t,a]=u.useReducer(or,{hotels:[],loading:!1,error:null,isEmpty:!1,meta:null}),r=u.useMemo(()=>s,[s==null?void 0:s.destination,s==null?void 0:s.checkIn,s==null?void 0:s.checkOut,s==null?void 0:s.guests,s==null?void 0:s.hotelName]),c=u.useCallback(async(h,f)=>{var l,d,n,o,i,x,m,j,v,b,p,g,w,y,k;try{a({type:"SEARCH_START"}),console.log("🔍 Starting hotel search with criteria:",h),console.log("📡 Calling provider-rotation function...");const{data:N,error:C}=await se.functions.invoke("provider-rotation",{body:{searchType:"hotel",params:{destination:h.destination,checkIn:h.checkIn,checkOut:h.checkOut,guests:h.guests,rooms:1,hotelName:h.hotelName}}});if(console.log("📡 Provider rotation response received:",{hasData:!!N,hasError:!!C,provider:N==null?void 0:N.provider,fallbackUsed:N==null?void 0:N.fallbackUsed,success:N==null?void 0:N.success}),f.aborted)return;if(console.log("📡 Hotel search response:",{success:N==null?void 0:N.success,error:C,data:N}),C){O.error("❌ Hotel search function error:",C);let E="Hotel search failed. Please try again.",L=!1;(l=C.message)!=null&&l.includes("AMADEUS_AUTH_INVALID_CREDENTIALS")?(E="Hotel search is temporarily unavailable while we update our systems. Please try again in a few minutes.",L=!0):(d=C.message)!=null&&d.includes("CIRCUIT_BREAKER_OPEN")?(E="Hotel search is temporarily overloaded. Please try again in 1-2 minutes.",L=!0):(n=C.message)!=null&&n.includes("Missing required parameters")?E="Please fill in all search fields (destination, check-in, and check-out dates).":(o=C.message)!=null&&o.includes("Check-in date cannot be in the past")?E="Please select a check-in date that is today or in the future.":(i=C.message)!=null&&i.includes("Check-out date must be after check-in")?E="Please ensure your check-out date is after your check-in date.":((x=C.message)!=null&&x.includes("network")||(m=C.message)!=null&&m.includes("timeout"))&&(E="Connection issue. Please check your internet connection and try again."),a({type:"SEARCH_ERROR",payload:L?"Service temporarily unavailable":"Unable to search hotels at this time"}),B.error(E,{duration:L?8e3:5e3,action:L?{label:"Retry in 1 min",onClick:()=>{setTimeout(()=>{h&&c(h,f)},6e4)}}:void 0});return}if(N!=null&&N.success)if((j=N.meta)!=null&&j.dataSource&&console.log(`✅ Hotel data received from: ${N.meta.dataSource}`),N.isEmpty||!N.hotels||N.hotels.length===0)a({type:"SEARCH_EMPTY",payload:{error:N.error||"No hotels found for your search criteria",meta:N.meta}}),((b=(v=N.meta)==null?void 0:v.suggestions)==null?void 0:b.length)>0?B.info(`No hotels found. Try: ${N.meta.suggestions[0]}`):(p=N.meta)!=null&&p.dateAdjusted&&((g=N.meta)!=null&&g.suggestedDates)?B.info(`Moved search to ${N.meta.suggestedDates.checkIn} - ${N.meta.suggestedDates.checkOut} for test availability`):B.info("No hotels found for your criteria. Try different dates or locations.");else{(w=N.meta)!=null&&w.dateAdjusted&&((y=N.meta)!=null&&y.suggestedDates)&&B.info(`Dates adjusted to ${N.meta.suggestedDates.checkIn} - ${N.meta.suggestedDates.checkOut} for better availability`);const E=N.hotels.map(cr);N.fallbackUsed?B.info("Showing sample hotels while we restore full service."):((k=N.meta)==null?void 0:k.dataSource)==="amadeus_live"&&B.success(`Found ${E.length} hotels with live pricing`),a({type:"SEARCH_SUCCESS",payload:{hotels:E,meta:N.meta}})}else if(N!=null&&N.systemError){O.error("🚨 System error:",N.technicalError);let E="Hotel search is temporarily unavailable. Please try again in a few minutes.";N.retryAfter&&(E=`Hotel search temporarily unavailable. Please try again in ${N.retryAfter} seconds.`),a({type:"SEARCH_ERROR",payload:N.error||"Service temporarily unavailable"}),B.error(E)}else a({type:"SEARCH_ERROR",payload:(N==null?void 0:N.error)||"Failed to search hotels"}),B.error("Hotel search failed. Please try again.")}catch(N){if(f.aborted)return;O.error("Hotel search error:",N);let C="Failed to search hotels. Please try again.",E=!1;N!=null&&N.message&&(N.message.includes("AMADEUS_AUTH_INVALID_CREDENTIALS")?(C="Hotel search is temporarily unavailable. Our team has been notified.",E=!0):N.message.includes("Circuit breaker")?(C="Hotel search service is temporarily overloaded. Please try again in a few minutes.",E=!0):N.message.includes("Failed to fetch")&&(C="Connection error. Please check your internet and try again.")),a({type:"SEARCH_ERROR",payload:{message:C,systemError:E,originalError:N==null?void 0:N.message}}),E?B.error(C,{duration:8e3}):B.error(C)}},[]);return u.useEffect(()=>{if(!(r!=null&&r.destination)||!(r!=null&&r.checkIn)||!(r!=null&&r.checkOut)){console.log("❌ Hotel search skipped - missing criteria:",{hasCriteria:!!r,hasDestination:!!(r!=null&&r.destination),hasCheckIn:!!(r!=null&&r.checkIn),hasCheckOut:!!(r!=null&&r.checkOut)});return}console.log("✅ Triggering hotel search with valid criteria:",r);const h=new AbortController;return c(r,h.signal),()=>{h.abort()}},[r,c]),{hotels:t.hotels,loading:t.loading,error:t.error,isEmpty:t.isEmpty,meta:t.meta}},mr=({results:s,loading:t,filters:a,onFiltersChange:r,sortBy:c,onSortChange:h,viewMode:f,onViewModeChange:l,children:d,topBanner:n,extrasBelowControls:o,sidebarAddon:i})=>{const[x,m]=u.useState(!1),j=(y,k)=>{const N=k?[...a.starRating,y]:a.starRating.filter(C=>C!==y);r({...a,starRating:N})},v=(y,k)=>{const N=k?[...a.amenities,y]:a.amenities.filter(C=>C!==y);r({...a,amenities:N})},b=(y,k)=>{const N=k?[...a.propertyTypes,y]:a.propertyTypes.filter(C=>C!==y);r({...a,propertyTypes:N})},p=()=>{r({priceRange:[0,1e3],starRating:[],guestRating:[0,10],amenities:[],propertyTypes:[],distanceFromCenter:50})},g=a.starRating.length+a.amenities.length+a.propertyTypes.length+(a.priceRange[0]>0||a.priceRange[1]<1e3?1:0)+(a.guestRating[0]>0||a.guestRating[1]<10?1:0)+(a.distanceFromCenter<50?1:0),w=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Price per night"}),e.jsxs("div",{className:"px-3",children:[e.jsx(Me,{value:a.priceRange,onValueChange:y=>r({...a,priceRange:y}),max:1e3,min:0,step:25,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:["$",a.priceRange[0]]}),e.jsxs("span",{children:["$",a.priceRange[1],"+"]})]})]})]}),e.jsx(ee,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Hotel Class"}),["5","4","3","2","1"].map(y=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Se,{id:`stars-${y}`,checked:a.starRating.includes(y),onCheckedChange:k=>j(y,k)}),e.jsxs("label",{htmlFor:`stars-${y}`,className:"text-sm flex items-center space-x-1",children:[e.jsx("span",{children:y}),e.jsx("div",{className:"flex",children:Array.from({length:parseInt(y)},(k,N)=>e.jsx("span",{className:"text-yellow-400 text-xs",children:"★"},N))})]})]},y))]}),e.jsx(ee,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Guest Rating"}),e.jsxs("div",{className:"px-3",children:[e.jsx(Me,{value:a.guestRating,onValueChange:y=>r({...a,guestRating:y}),max:10,min:0,step:.5,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsx("span",{children:a.guestRating[0]}),e.jsx("span",{children:a.guestRating[1]})]})]})]}),e.jsx(ee,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Property Type"}),["Hotel","Resort","Apartment","Villa","Hostel"].map(y=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Se,{id:`type-${y}`,checked:a.propertyTypes.includes(y),onCheckedChange:k=>b(y,k)}),e.jsx("label",{htmlFor:`type-${y}`,className:"text-sm",children:y})]},y))]}),e.jsx(ee,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Amenities"}),["WiFi","Pool","Gym","Spa","Parking","Restaurant","Bar","Room Service","Airport Shuttle","Pet Friendly"].map(y=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Se,{id:`amenity-${y}`,checked:a.amenities.includes(y),onCheckedChange:k=>v(y,k)}),e.jsx("label",{htmlFor:`amenity-${y}`,className:"text-sm",children:y})]},y))]}),e.jsx(ee,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Distance from Center"}),e.jsxs("div",{className:"px-3",children:[e.jsx(Me,{value:[a.distanceFromCenter],onValueChange:y=>r({...a,distanceFromCenter:y[0]}),max:50,min:0,step:1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsx("span",{children:"0 km"}),e.jsxs("span",{children:[a.distanceFromCenter," km"]})]})]})]}),g>0&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx(D,{variant:"outline",onClick:p,className:"w-full",children:"Clear All Filters"})]})]});return e.jsxs("div",{className:"space-y-6",children:[n,e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(qt,{open:x,onOpenChange:m,children:[e.jsx(Wt,{asChild:!0,children:e.jsxs(D,{variant:"outline",size:"sm",className:"sm:hidden",children:[e.jsx(va,{className:"h-4 w-4 mr-2"}),"Filters",g>0&&e.jsx(T,{variant:"secondary",className:"ml-2",children:g})]})}),e.jsxs(Jt,{side:"left",className:"w-80",children:[e.jsx(Zt,{children:e.jsx(Kt,{children:"Filters"})}),e.jsx("div",{className:"mt-6",children:e.jsx(w,{})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xt,{className:"h-4 w-4"}),e.jsxs(es,{value:c,onValueChange:h,children:[e.jsx(ss,{className:"w-48",children:e.jsx(ts,{})}),e.jsxs(as,{children:[e.jsx(oe,{value:"price",children:"Best Price"}),e.jsx(oe,{value:"rating",children:"Highest Rated"}),e.jsx(oe,{value:"distance",children:"Distance"}),e.jsx(oe,{value:"stars",children:"Hotel Class"}),e.jsx(oe,{value:"deals",children:"Best Deals"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{variant:f==="list"?"default":"outline",size:"sm",onClick:()=>l("list"),children:e.jsx(zt,{className:"h-4 w-4"})}),e.jsx(D,{variant:f==="map"?"default":"outline",size:"sm",onClick:()=>l("map"),children:e.jsx(Qt,{className:"h-4 w-4"})})]}),e.jsxs(T,{variant:"secondary",children:[s.length," ",s.length===1?"property":"properties"]})]})]}),o&&e.jsx("div",{className:"-mt-2",children:o}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"hidden sm:block lg:col-span-1",children:e.jsxs(R,{className:"sticky top-4",children:[e.jsx(I,{children:e.jsxs(F,{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ea,{className:"h-5 w-5"}),"Filters",g>0&&e.jsx(T,{variant:"secondary",children:g})]})}),e.jsxs(P,{children:[i&&e.jsx("div",{className:"mb-4",children:i}),e.jsx(w,{})]})]})}),e.jsx("div",{className:"lg:col-span-3",children:d})]})]})},Ae=({type:s,value:t,endTime:a})=>{const[r,c]=u.useState("");Nt.useEffect(()=>{if(s==="flash_deal"&&a){const l=setInterval(()=>{const d=new Date().getTime(),n=a.getTime()-d;if(n>0){const o=Math.floor(n%864e5/36e5),i=Math.floor(n%(1e3*60*60)/(1e3*60)),x=Math.floor(n%(1e3*60)/1e3);c(`${o.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${x.toString().padStart(2,"0")}`)}else c("EXPIRED")},1e3);return()=>clearInterval(l)}},[s,a]);const f=(()=>{switch(s){case"rooms_left":return{text:`Only ${t} rooms left!`,variant:"destructive",icon:e.jsx(Z,{className:"h-3 w-3"})};case"flash_deal":return{text:`Flash deal ends in ${r}`,variant:"secondary",icon:e.jsx(fe,{className:"h-3 w-3"})};case"high_demand":return{text:"High demand - book now!",variant:"destructive",icon:e.jsx(ge,{className:"h-3 w-3"})};case"last_booking":return{text:`Booked ${t} times in last 24h`,variant:"secondary",icon:e.jsx(Z,{className:"h-3 w-3"})};default:return null}})();return f?e.jsxs(T,{variant:f.variant,className:"flex items-center space-x-1 animate-pulse",children:[f.icon,e.jsx("span",{className:"text-xs font-medium",children:f.text})]}):null},xr=({destination:s,checkIn:t,checkOut:a,guests:r,hotelName:c})=>e.jsxs("div",{className:"w-full rounded-xl border bg-card text-card-foreground p-4 sm:p-5 flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 pr-4 border-r last:border-r-0",children:[e.jsx(q,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:s||"Sydney (Default)"}),c&&e.jsxs("span",{className:"text-sm font-medium text-primary",children:["• ",c]})]}),e.jsxs("div",{className:"flex items-center gap-2 pr-4 border-r last:border-r-0",children:[e.jsx(fa,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm sm:text-base",children:t&&a?`${t} → ${a}`:"Add dates"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ba,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm sm:text-base",children:[r||2," guests"]})]})]}),ke="cursor-pointer select-none px-3 py-1.5 rounded-full border bg-card hover:bg-accent/30 transition-all text-sm",hr=({filters:s,onFiltersChange:t})=>{const a=c=>{const h=s.amenities.includes(c);t({...s,amenities:h?s.amenities.filter(f=>f!==c):[...s.amenities,c]})},r=c=>{const h=["5","4","3","2","1"].filter(l=>parseInt(l)>=c),f=h.every(l=>s.starRating.includes(l))&&s.starRating.length===h.length;t({...s,starRating:f?[]:h})};return e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:ke,onClick:()=>a("Breakfast"),children:"Free breakfast"}),e.jsx("button",{className:ke,onClick:()=>a("Pool"),children:"Pool"}),e.jsx("button",{className:ke,onClick:()=>a("WiFi"),children:"Free Wi‑Fi"}),e.jsx("button",{className:ke,onClick:()=>r(4),children:"4+ stars"}),e.jsx("button",{className:ke,onClick:()=>t({...s,distanceFromCenter:3}),children:"Central (≤ 3km)"}),s.amenities.length+s.starRating.length>0&&e.jsx(T,{variant:"secondary",className:"ml-1",children:"Refined"})]})},ur=({src:s,alt:t,destination:a,className:r,containerClassName:c})=>e.jsx(Bt,{src:s,alt:t,priority:!1,lazy:!0,quality:80,aspectRatio:"wide",sizes:"(max-width: 768px) 100vw, 400px",className:H("w-full h-full object-cover",r),containerClassName:H("h-40",c),enablePerformanceTracking:!0}),pr=({destination:s})=>e.jsxs(R,{className:"overflow-hidden",children:[e.jsx(I,{className:"pb-2",children:e.jsx(F,{className:"text-base",children:s?`Map – ${s}`:"Map preview"})}),e.jsx(P,{className:"p-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(ur,{src:sa,alt:"Map preview of hotels",destination:s,containerClassName:"h-40"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background/30 to-transparent"}),e.jsx("div",{className:"absolute bottom-2 right-2",children:e.jsx("a",{href:"#",className:"px-3 py-1.5 rounded-full bg-background/80 border text-sm story-link",children:"Open full map"})})]})})]}),gr=({hotels:s,destination:t,onHotelSelect:a,className:r})=>{var v;const[c,h]=u.useState(null),[f,l]=u.useState({lat:-33.8688,lng:151.2093}),[d,n]=u.useState(!0),[o,i]=u.useState(null),x=u.useRef(null);u.useEffect(()=>{(async()=>{n(!0),i(null);try{if(t){const p=m(t);l(p),await new Promise(g=>setTimeout(g,500))}}catch{i("Failed to load map for destination")}finally{n(!1)}})()},[t]);const m=b=>{const p={sydney:{lat:-33.8688,lng:151.2093},melbourne:{lat:-37.8136,lng:144.9631},brisbane:{lat:-27.4698,lng:153.0251},perth:{lat:-31.9505,lng:115.8605},adelaide:{lat:-34.9285,lng:138.6007},"new york":{lat:40.7128,lng:-74.006},london:{lat:51.5074,lng:-.1278},paris:{lat:48.8566,lng:2.3522},tokyo:{lat:35.6762,lng:139.6503}},g=b.toLowerCase();return p[g]||{lat:-33.8688,lng:151.2093}},j=b=>{h(b),a==null||a(b)};return o?e.jsx("div",{className:`relative w-full h-96 bg-secondary/10 rounded-lg overflow-hidden ${r}`,children:e.jsx(yt,{className:"m-4",children:e.jsx(vt,{children:o})})}):e.jsxs("div",{className:`relative w-full h-96 bg-secondary/10 rounded-lg overflow-hidden ${r}`,children:[d&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80 backdrop-blur-sm z-20",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{className:"text-sm",children:"Loading map..."})]})}),e.jsxs("div",{ref:x,className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-secondary/5",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsxs("svg",{width:"100%",height:"100%",viewBox:"0 0 400 300",children:[e.jsx("defs",{children:e.jsx("pattern",{id:"grid",width:"20",height:"20",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 20 0 L 0 0 0 20",fill:"none",stroke:"currentColor",strokeWidth:"0.5"})})}),e.jsx("rect",{width:"100%",height:"100%",fill:"url(#grid)"})]})}),s.slice(0,10).map((b,p)=>{const g=50+p%4*20+Math.random()*10,w=30+Math.floor(p/4)*25+Math.random()*10;return e.jsxs("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 cursor-pointer group",style:{left:`${g}%`,top:`${w}%`},onClick:()=>j(b),children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"bg-primary text-primary-foreground px-2 py-1 rounded-md text-xs font-semibold shadow-lg group-hover:scale-110 transition-transform border-2 border-background",children:["$",b.pricePerNight]}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-primary"})]}),e.jsx("div",{className:"absolute -top-1 -right-1 bg-secondary text-secondary-foreground rounded-full w-5 h-5 flex items-center justify-center text-xs",children:b.starRating})]},b.id)}),e.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:[e.jsx("div",{className:"bg-background border-2 border-primary rounded-full p-2 shadow-lg",children:e.jsx(rs,{className:"h-4 w-4 text-primary"})}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-1 text-xs font-medium text-center whitespace-nowrap",children:t})]})]}),c&&e.jsx("div",{className:"absolute bottom-4 left-4 right-4 z-10",children:e.jsx(R,{className:"shadow-lg",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("img",{src:c.imageUrl||"/placeholder.svg",alt:c.name,className:"w-16 h-16 rounded-lg object-cover"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold truncate",children:c.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-sm",children:c.rating})]}),e.jsxs(T,{variant:"outline",className:"text-xs",children:[c.starRating," star"]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(q,{className:"h-3 w-3"}),((v=c.distanceFromCenter)==null?void 0:v.toFixed(1))||"0.5"," km away"]}),e.jsxs("div",{className:"text-lg font-bold text-primary",children:["$",c.pricePerNight,e.jsx("span",{className:"text-sm font-normal",children:"/night"})]})]})]}),e.jsx(D,{size:"sm",onClick:()=>a==null?void 0:a(c),className:"shrink-0",children:"View Details"})]})})})}),e.jsx("div",{className:"absolute top-4 right-4 z-10 space-y-2",children:e.jsx(D,{size:"sm",variant:"outline",className:"bg-background/90 backdrop-blur-sm",onClick:()=>h(null),children:"Show All Hotels"})}),e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsxs(T,{className:"bg-background/90 backdrop-blur-sm text-foreground",children:[s.length," hotels found"]})})]})};function fr({onHotelSelect:s}){const t=We(),{toast:a}=Fe(),[r,c]=u.useState([]),[h,f]=u.useState(!0),l=["Sydney","Melbourne","Tokyo","Singapore","Dubai","London"];u.useEffect(()=>{(async()=>{try{f(!0);const o=[];for(const x of l.slice(0,3))try{const m=new Date;m.setDate(m.getDate()+1);const j=new Date;j.setDate(j.getDate()+2);const{data:v,error:b}=await se.functions.invoke("provider-rotation",{body:{searchType:"hotel",params:{destination:x,checkIn:m.toISOString().split("T")[0],checkOut:j.toISOString().split("T")[0],guests:2,rooms:1,currency:"AUD"}}});if(b){O.warn(`Failed to fetch hotels for ${x}:`,b);continue}if(v!=null&&v.success&&(v!=null&&v.data)&&Array.isArray(v.data)){const p=await Promise.all(v.data.slice(0,3).map(async g=>{var y,k,N,C;let w=((y=g.images)==null?void 0:y[0])||"/assets/hotel-business.jpg";if(!((k=g.images)!=null&&k.length)&&g.source==="amadeus")try{const{data:E}=await se.functions.invoke("amadeus-hotel-photos",{body:{hotelId:g.id}});E!=null&&E.success&&((N=E.photos)==null?void 0:N.length)>0&&(w=E.photos[0].url)}catch(E){O.warn(`Failed to fetch photos for hotel ${g.id}:`,E)}return{id:g.id,name:g.name,location:x,rating:g.rating||g.starRating||4,reviews:g.reviewCount||Math.floor(Math.random()*2e3)+500,price:Math.round(g.pricePerNight||g.totalPrice||200).toString(),originalPrice:g.pricePerNight?Math.round(g.pricePerNight*1.2).toString():void 0,image:w,amenities:((C=g.amenities)==null?void 0:C.slice(0,4))||["WiFi","Pool","Spa","Restaurant"],discount:Math.random()>.6?"Best Rate":void 0,provider:v.provider||"Unknown"}}));o.push(...p)}}catch(m){O.warn(`Error fetching hotels for ${x}:`,m)}const i=o.sort(()=>Math.random()-.5).slice(0,8);c(i)}catch(o){O.error("Error fetching popular hotels:",o),a({title:"Unable to load popular hotels",description:"Please try again later",variant:"destructive"})}finally{f(!1)}})()},[a]);const d=n=>{const o=new Date().toISOString().split("T")[0],i=new Date(Date.now()+24*60*60*1e3).toISOString().split("T")[0],x=new URLSearchParams({destination:n.location,checkIn:o,checkOut:i,guests:"2",rooms:"1",hotelName:n.name,searched:"true"});t(`/search/hotels?${x.toString()}`),s==null||s(n.location,n.name)};return h?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Popular Hotels"}),e.jsx(T,{variant:"secondary",className:"bg-primary/10 text-primary",children:"Loading..."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:8}).map((n,o)=>e.jsxs(R,{className:"overflow-hidden border-0 bg-white shadow-lg",children:[e.jsx("div",{className:"relative h-48 bg-muted animate-pulse"}),e.jsxs(P,{className:"p-4 space-y-3",children:[e.jsx("div",{className:"h-4 bg-muted rounded animate-pulse"}),e.jsx("div",{className:"h-3 bg-muted rounded animate-pulse w-2/3"}),e.jsx("div",{className:"h-6 bg-muted rounded animate-pulse w-1/2"})]})]},o))})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Popular Hotels"}),e.jsx(T,{variant:"secondary",className:"bg-primary/10 text-primary",children:"Live Results"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:r.map(n=>e.jsxs(R,{className:"hover:shadow-xl transition-all duration-300 cursor-pointer group overflow-hidden border-0 bg-white shadow-lg",onClick:()=>d(n),children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx("img",{src:n.image,alt:n.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300",onError:o=>{const i=o.target;i.src.includes("/assets/hotel-business.jpg")?i.src="/placeholder.svg":i.src.includes("/assets/")||(i.src="/assets/hotel-business.jpg")}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),n.discount&&e.jsx(T,{className:"absolute top-3 left-3 bg-gradient-to-r from-orange-500 to-red-500 text-white font-bold px-2 py-1 text-xs",children:n.discount}),e.jsxs("div",{className:"absolute top-3 right-3 flex items-center gap-1 bg-white/90 backdrop-blur-sm rounded-full px-2 py-1",children:[e.jsx(G,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-xs font-medium",children:n.rating})]}),e.jsxs("div",{className:"absolute bottom-3 left-3 text-white",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:n.location})]}),e.jsx("h3",{className:"font-bold text-lg leading-tight",children:n.name})]})]}),e.jsxs(P,{className:"p-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[n.amenities.slice(0,2).map(o=>e.jsx(T,{variant:"secondary",className:"text-xs px-2 py-0.5",children:o},o)),n.amenities.length>2&&e.jsxs(T,{variant:"outline",className:"text-xs px-2 py-0.5",children:["+",n.amenities.length-2]})]}),e.jsxs("div",{className:"flex items-center gap-1 mb-3 text-xs text-muted-foreground",children:[e.jsx(G,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:n.rating}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[n.reviews.toLocaleString()," reviews"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-left",children:[n.originalPrice&&e.jsxs("p",{className:"text-xs text-muted-foreground line-through",children:["$",n.originalPrice]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsxs("span",{className:"text-xl font-bold text-primary",children:["$",n.price]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"/night"})]})]}),e.jsx(D,{variant:"default",size:"sm",className:"group-hover:bg-primary-600 transition-colors shadow-md",children:"Book Now"})]})]})]},n.id))}),r.length===0&&!h&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"Unable to load popular hotels at the moment."}),e.jsx("p",{className:"text-sm",children:"Please try refreshing the page."})]})]})}const jr=s=>{switch(s.toLowerCase()){case"wifi":return e.jsx(Ke,{className:"h-3 w-3"});case"airport transfer":return e.jsx(Le,{className:"h-3 w-3"});case"breakfast":return e.jsx(Qe,{className:"h-3 w-3"});default:return e.jsx(G,{className:"h-3 w-3"})}};function Nr({onDealSelect:s}){const[t,a]=u.useState([]),[r,c]=u.useState(!0),h=["Sydney","Melbourne","Tokyo","Singapore","Dubai","London"];u.useEffect(()=>{(async()=>{try{c(!0);const n=[];for(const i of h.slice(0,4))try{const x=new Date;x.setDate(x.getDate()+1);const m=new Date;m.setDate(m.getDate()+2);const{data:j,error:v}=await se.functions.invoke("provider-rotation",{body:{searchType:"hotel",params:{destination:i,checkIn:x.toISOString().split("T")[0],checkOut:m.toISOString().split("T")[0],guests:2,rooms:1,currency:"USD"}}});if(v){O.warn(`Failed to fetch hotels for ${i}:`,v);continue}if(j!=null&&j.success&&(j!=null&&j.hotels)){const b=j.hotels.slice(0,2).map((p,g)=>{var z,W,Q,me,Ne;const w=parseFloat(p.pricePerNight)||Math.floor(Math.random()*400)+200,y=Math.floor(Math.random()*30)+15,k=Math.round(w*(1+y/100)),N=k-w,C=["Early Bird Special","Flash Sale","Limited Time Offer","Best Price Guarantee","Weekend Deal"],E=C[Math.floor(Math.random()*C.length)],L=new Date;return L.setDate(L.getDate()+Math.floor(Math.random()*30)+7),{id:p.id,name:p.name,location:i,destination:i,rating:p.rating||4+Math.random()*1,reviews:Math.floor(Math.random()*2e3)+500,price:w.toString(),originalPrice:k.toString(),savings:N.toString(),image:((z=p.images)==null?void 0:z[0])||"/assets/hotel-budget.jpg",dealType:E,validUntil:L.toISOString().split("T")[0],inclusions:["WiFi","Breakfast","Pool Access"].slice(0,Math.floor(Math.random()*3)+1),highlights:((W=p.amenities)==null?void 0:W.slice(0,3))||["City View","Modern Design","Prime Location"],amadeus:{hotelId:((Q=p.amadeus)==null?void 0:Q.hotelId)||p.id,chainCode:(me=p.amadeus)==null?void 0:me.chainCode,offers:(Ne=p.amadeus)==null?void 0:Ne.offers}}});n.push(...b)}}catch(x){O.warn(`Error fetching hotels for ${i}:`,x)}const o=n.sort(()=>Math.random()-.5).slice(0,6);a(o)}catch(n){O.error("Error fetching featured deals:",n),B.error("Unable to load featured deals")}finally{c(!1)}})()},[]);const f=d=>{if(s){const n=new Date;n.setDate(n.getDate()+7),s(d.destination,d.name,n.toISOString().split("T")[0])}},l=d=>new Date(d).toLocaleDateString("en-AU",{day:"2-digit",month:"short",year:"numeric"});return r?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Featured Hotel Deals"}),e.jsx(T,{variant:"secondary",className:"bg-orange-100 text-orange-600",children:"Loading..."})]}),e.jsx("div",{className:"flex gap-6 overflow-x-auto pb-4",children:Array.from({length:6}).map((d,n)=>e.jsxs(R,{className:"flex-shrink-0 w-96 overflow-hidden border-0 bg-white shadow-xl",children:[e.jsx("div",{className:"relative h-56 bg-muted animate-pulse"}),e.jsxs(P,{className:"p-6 space-y-3",children:[e.jsx("div",{className:"h-4 bg-muted rounded animate-pulse"}),e.jsx("div",{className:"h-3 bg-muted rounded animate-pulse w-2/3"}),e.jsx("div",{className:"h-6 bg-muted rounded animate-pulse w-1/2"})]})]},n))})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Featured Hotel Deals"}),e.jsx(T,{variant:"secondary",className:"bg-orange-100 text-orange-600",children:"Live Deals"})]}),e.jsx("div",{className:"flex gap-6 overflow-x-auto pb-4",children:t.map(d=>e.jsxs(R,{className:"flex-shrink-0 w-96 hover:shadow-2xl transition-all duration-300 cursor-pointer group overflow-hidden border-0 bg-white shadow-xl",onClick:()=>f(d),children:[e.jsxs("div",{className:"relative h-56 overflow-hidden",children:[e.jsx("img",{src:d.image,alt:d.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",onError:n=>{const o=n.target;o.src="/assets/hotel-budget.jpg"}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/30 to-transparent"}),e.jsxs(T,{className:"absolute top-4 left-4 bg-gradient-to-r from-orange-500 to-red-500 text-white font-bold px-3 py-1",children:["Save $",d.savings]}),e.jsx(T,{className:"absolute top-4 right-4 bg-white/90 backdrop-blur-sm text-black font-medium px-3 py-1",children:d.dealType}),e.jsxs("div",{className:"absolute top-16 right-4 flex items-center gap-1 bg-white/90 backdrop-blur-sm rounded-full px-3 py-1 text-sm",children:[e.jsx(je,{className:"h-4 w-4"}),e.jsxs("span",{children:["Until ",l(d.validUntil)]})]}),e.jsxs("div",{className:"absolute bottom-4 left-4 right-4 text-white",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:d.location}),e.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[e.jsx(G,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-sm font-medium",children:d.rating.toFixed(1)})]})]}),e.jsx("h3",{className:"font-bold text-xl leading-tight",children:d.name})]})]}),e.jsxs(P,{className:"p-6",children:[e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:d.highlights.slice(0,3).map(n=>e.jsx(T,{variant:"outline",className:"text-xs px-2 py-0.5",children:n},n))}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Includes:"}),e.jsx("div",{className:"flex items-center gap-1",children:d.inclusions.slice(0,3).map(n=>e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[jr(n),e.jsx("span",{children:n})]},n))})]}),e.jsxs("div",{className:"flex items-center gap-1 mb-4 text-xs text-muted-foreground",children:[e.jsx(G,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:d.rating.toFixed(1)}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[d.reviews.toLocaleString()," reviews"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-sm text-muted-foreground line-through",children:["$",d.originalPrice]}),e.jsxs(T,{variant:"secondary",className:"text-xs bg-green-100 text-green-600",children:["-",Math.round(parseInt(d.savings)/parseInt(d.originalPrice)*100),"%"]})]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsxs("span",{className:"text-3xl font-bold text-primary",children:["$",d.price]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"/night"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"per room"})]}),e.jsx(D,{className:"bg-gradient-to-r from-primary to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white font-semibold px-6 py-3 rounded-xl shadow-lg group-hover:shadow-xl transition-all",size:"lg",children:"Book Deal"})]})]})]},d.id))}),t.length===0&&!r&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"Unable to load featured deals at the moment."}),e.jsx("p",{className:"text-sm",children:"Please try refreshing the page."})]})]})}const yr=({hotelId:s,className:t=""})=>{const[a,r]=u.useState(null),c=()=>{const l=new Date().getHours(),d=l>=9&&l<=17,n=l>=19&&l<=22;let o=2,i=0;n?(o=Math.floor(Math.random()*8)+5,i=Math.floor(Math.random()*3)+1):d?(o=Math.floor(Math.random()*5)+3,i=Math.floor(Math.random()*2)):(o=Math.floor(Math.random()*3)+1,i=Math.floor(Math.random()*2));const m=1+s.split("").reduce((p,g)=>p+g.charCodeAt(0),0)%3*.2,j=Math.max(1,Math.floor(o*m));let v="low";j>=8||i>=2?v="high":(j>=5||i>=1)&&(v="medium");const b=Math.floor(Math.random()*120)+15;return{currentViewers:j,recentBookings:i,timeframe:"last hour",urgencyLevel:v,lastBooking:`${b} minutes ago`}};if(u.useEffect(()=>{r(c());const l=setInterval(()=>{r(c())},Math.random()*3e4+3e4);return()=>clearInterval(l)},[s]),!a)return null;const h=l=>{switch(l){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}},f=()=>a.urgencyLevel==="high"?"High demand - book soon!":a.urgencyLevel==="medium"?"Popular choice":"Good availability";return e.jsx(R,{className:`${t} border-l-4 max-h-64 ${a.urgencyLevel==="high"?"border-l-red-500 bg-red-50/50":a.urgencyLevel==="medium"?"border-l-yellow-500 bg-yellow-50/50":"border-l-blue-500 bg-blue-50/50"}`,children:e.jsxs(P,{className:"p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(T,{variant:"outline",className:`text-xs font-medium ${h(a.urgencyLevel)}`,children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),f()]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-muted-foreground font-medium",children:"LIVE"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx("div",{className:"flex items-center justify-between p-2 bg-background/80 rounded-lg border",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ns,{className:"h-4 w-4 text-primary"}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[a.currentViewers," viewing now"]})]})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[a.recentBookings>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Y,{className:"h-3 w-3 text-green-600"}),e.jsxs("span",{children:[a.recentBookings," booked/hr"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(fe,{className:"h-3 w-3"}),e.jsx("span",{children:a.lastBooking})]})]})]})]})})},vr=({hotelId:s,currentPrice:t,checkInDate:a,className:r=""})=>{const[c,h]=u.useState(null),[f,l]=u.useState(!0);if(u.useEffect(()=>{l(!0),setTimeout(()=>{h(null),l(!1)},500)},[s,t,a]),f)return e.jsx(R,{className:`travel-card ${r}`,children:e.jsx(P,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"}),e.jsx("span",{children:"Analyzing price trends..."})]})})});if(!c)return e.jsx(R,{className:`travel-card ${r}`,children:e.jsxs(P,{className:"p-6 text-center",children:[e.jsx("p",{className:"text-muted-foreground",children:"AI price predictions unavailable"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Connect to live pricing API for predictions"})]})});const d=i=>{switch(i){case"book_now":return"bg-red-100 text-red-800 border-red-200";case"wait":return"bg-green-100 text-green-800 border-green-200";case"book_soon":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},n=i=>{switch(i){case"book_now":return e.jsx(qe,{className:"h-4 w-4"});case"wait":return e.jsx(fe,{className:"h-4 w-4"});case"book_soon":return e.jsx(ne,{className:"h-4 w-4"});default:return e.jsx(je,{className:"h-4 w-4"})}},o=i=>{switch(i){case"up":return e.jsx(Y,{className:"h-3 w-3 text-red-600"});case"down":return e.jsx(ge,{className:"h-3 w-3 text-green-600"});default:return e.jsx("div",{className:"h-3 w-3 bg-gray-400 rounded-full"})}};return e.jsxs(R,{className:`travel-card ${r} max-h-64`,children:[e.jsx(I,{className:"pb-2",children:e.jsxs(F,{className:"text-sm flex items-center",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"AI Price Forecast"]})}),e.jsxs(P,{className:"space-y-2 pt-0 px-3 pb-3",children:[e.jsx("div",{className:`p-2 rounded-lg border ${d(c.recommendation.action)}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[n(c.recommendation.action),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium capitalize truncate",children:c.recommendation.action.replace("_"," ")}),e.jsx("p",{className:"text-xs opacity-80 truncate",children:c.recommendation.reason})]}),e.jsxs("span",{className:"text-xs font-medium",children:[c.recommendation.confidence,"%"]})]})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"text-xs font-medium",children:"3-Day Trend"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:c.predictedPrices.slice(0,3).map((i,x)=>e.jsxs("div",{className:"text-center p-1 bg-muted rounded text-xs",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[e.jsx("span",{className:"truncate",children:new Date(i.date).toLocaleDateString("en-US",{weekday:"short"})}),o(i.trend)]}),e.jsxs("div",{className:"font-medium",children:["$",i.price]})]},i.date))})]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"AI predictions based on market patterns"})]})]})},br=({onVoiceResult:s,onDestinationChange:t,className:a=""})=>{const[r,c]=u.useState(!1),[h,f]=u.useState(!1),[l,d]=u.useState(!0),[n,o]=u.useState(""),i=u.useRef(null),x=u.useRef([]),{toast:m}=Fe(),j=async()=>{try{const g=await navigator.mediaDevices.getUserMedia({audio:!0}),w=new MediaRecorder(g,{mimeType:"audio/webm"});i.current=w,x.current=[],w.ondataavailable=y=>{y.data.size>0&&x.current.push(y.data)},w.onstop=async()=>{const y=new Blob(x.current,{type:"audio/webm"});await b(y),g.getTracks().forEach(k=>k.stop())},w.start(),c(!0),setTimeout(()=>{var y;((y=i.current)==null?void 0:y.state)==="recording"&&v()},1e4)}catch(g){O.error("Error accessing microphone:",g),m({title:"Microphone Access Denied",description:"Please allow microphone access to use voice search.",variant:"destructive"})}},v=()=>{var g;((g=i.current)==null?void 0:g.state)==="recording"&&(i.current.stop(),c(!1))},b=async g=>{f(!0);try{const w=new FileReader;w.onloadend=async()=>{const y=w.result.split(",")[1],{data:k,error:N}=await se.functions.invoke("voice-to-text",{body:{audio:y}});if(N)throw N;if(k!=null&&k.text){if(o(k.text),s(k.text),t){const E=["Sydney","Melbourne","Brisbane","Perth","Adelaide","Darwin","Hobart","Cairns"].find(L=>k.text.toLowerCase().includes(L.toLowerCase()));E&&t(E)}l&&await p(`Found hotels for: ${k.text}`),m({title:"Voice Search Complete",description:`Searching for: ${k.text}`})}},w.readAsDataURL(g)}catch(w){O.error("Error processing audio:",w),m({title:"Voice Processing Failed",description:"Could not process your voice input. Please try again.",variant:"destructive"})}finally{f(!1)}},p=async g=>{try{const{data:w,error:y}=await se.functions.invoke("text-to-speech",{body:{text:g,voice:"alloy"}});if(y)throw y;if(w!=null&&w.audioContent){const k=new Blob([Uint8Array.from(atob(w.audioContent),E=>E.charCodeAt(0))],{type:"audio/mp3"}),N=URL.createObjectURL(k),C=new Audio(N);await C.play(),C.onended=()=>URL.revokeObjectURL(N)}}catch(w){O.error("Error with text-to-speech:",w)}};return e.jsx(R,{className:`travel-card ${a}`,children:e.jsxs(P,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Voice Search"}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>d(!l),children:l?e.jsx(ra,{className:"h-4 w-4"}):e.jsx(na,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(D,{onClick:r?v:j,disabled:h,className:`w-16 h-16 rounded-full ${r?"bg-destructive hover:bg-destructive/90":"btn-primary"}`,children:h?e.jsx(Ie,{className:"h-6 w-6 animate-spin"}):r?e.jsx(Na,{className:"h-6 w-6"}):e.jsx(Is,{className:"h-6 w-6"})}),r&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-destructive rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Listening..."})]}),h&&e.jsx(T,{variant:"secondary",children:"Processing audio..."}),n&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Last search:"}),e.jsx("p",{className:"text-sm font-medium",children:n})]}),e.jsx("div",{className:"text-xs text-muted-foreground text-center max-w-48",children:'Say something like "Hotels in Sydney for this weekend" or "Find luxury hotels in Melbourne"'})]})]})})},wr=({onLocationSelect:s,className:t=""})=>{const[a,r]=u.useState(null),[c,h]=u.useState(!1),[f,l]=u.useState([10]),[d,n]=u.useState([]),{toast:o}=Fe(),i=[{name:"Sydney CBD",coordinates:[-33.8688,151.2093]},{name:"Melbourne CBD",coordinates:[-37.8136,144.9631]},{name:"Brisbane City",coordinates:[-27.4698,153.0251]},{name:"Perth CBD",coordinates:[-31.9505,115.8605]},{name:"Adelaide CBD",coordinates:[-34.9285,138.6007]},{name:"Gold Coast",coordinates:[-28.0167,153.4]},{name:"Cairns",coordinates:[-16.9203,145.7781]},{name:"Darwin",coordinates:[-12.4634,130.8456]}],x=()=>{if(h(!0),!navigator.geolocation){o({title:"Geolocation Not Supported",description:"Your browser doesn't support location services.",variant:"destructive"}),h(!1);return}navigator.geolocation.getCurrentPosition(v=>{const b=[v.coords.latitude,v.coords.longitude];r(b),j(b),h(!1),o({title:"Location Found",description:"Now showing hotels near your location."})},v=>{O.error("Error getting location:",v),h(!1);let b="Could not access your location.";v.code===v.PERMISSION_DENIED?b="Location access denied. Please enable location services.":v.code===v.POSITION_UNAVAILABLE&&(b="Location information unavailable."),o({title:"Location Error",description:b,variant:"destructive"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})},m=(v,b,p,g)=>{const y=(p-v)*Math.PI/180,k=(g-b)*Math.PI/180,N=Math.sin(y/2)*Math.sin(y/2)+Math.cos(v*Math.PI/180)*Math.cos(p*Math.PI/180)*Math.sin(k/2)*Math.sin(k/2);return 6371*(2*Math.atan2(Math.sqrt(N),Math.sqrt(1-N)))},j=v=>{const b=i.map(p=>({...p,distance:m(v[0],v[1],p.coordinates[0],p.coordinates[1])})).filter(p=>p.distance<=f[0]).sort((p,g)=>p.distance-g.distance).slice(0,5);n(b)};return u.useEffect(()=>{a&&j(a)},[f,a]),e.jsx(R,{className:`travel-card ${t}`,children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(q,{className:"h-5 w-5 mr-2"}),"Hotels Near Me"]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:x,disabled:c,children:[c?e.jsx(Ie,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(rs,{className:"h-4 w-4 mr-2"}),c?"Finding...":"Find My Location"]})]}),a&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium mb-2 block",children:["Search Radius: ",f[0]," km"]}),e.jsx(Me,{value:f,onValueChange:l,max:50,min:1,step:1,className:"w-full"})]}),d.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nearby destinations:"}),d.map((v,b)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>s(v.name),children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:v.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[v.distance.toFixed(1)," km away"]})]}),e.jsx(T,{variant:"secondary",children:v.distance<5?"Very Close":"Nearby"})]},b))]}):e.jsxs("p",{className:"text-sm text-muted-foreground text-center py-4",children:["No destinations found within ",f[0]," km. Try increasing the search radius."]})]}),!a&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx(q,{className:"h-12 w-12 mx-auto text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable location access to find hotels near you"})]})]})})})},vs=[{id:"wheelchair_accessible",label:"Wheelchair Accessible",description:"Entrances, elevators, and rooms designed for wheelchair users",icon:e.jsx(De,{className:"h-4 w-4"}),category:"mobility"},{id:"accessible_parking",label:"Accessible Parking",description:"Designated parking spaces near accessible entrances",icon:e.jsx(Le,{className:"h-4 w-4"}),category:"mobility"},{id:"step_free_access",label:"Step-Free Access",description:"No steps or stairs to navigate main areas",icon:e.jsx(rs,{className:"h-4 w-4"}),category:"mobility"},{id:"accessible_bathroom",label:"Accessible Bathroom",description:"Roll-in showers, grab bars, and accessible fixtures",icon:e.jsx(De,{className:"h-4 w-4"}),category:"mobility"},{id:"hearing_accessible",label:"Hearing Accessible",description:"Visual alarms, doorbell lights, and hearing loop systems",icon:e.jsx(Ye,{className:"h-4 w-4"}),category:"hearing"},{id:"sign_language",label:"Sign Language Support",description:"Staff trained in sign language or video relay services",icon:e.jsx(Ye,{className:"h-4 w-4"}),category:"hearing"},{id:"visual_accessible",label:"Visual Accessible",description:"Braille signage, audio descriptions, and high contrast features",icon:e.jsx(ns,{className:"h-4 w-4"}),category:"visual"},{id:"guide_dog_friendly",label:"Guide Dog Friendly",description:"Welcoming to service animals with appropriate facilities",icon:e.jsx($e,{className:"h-4 w-4"}),category:"visual"},{id:"cognitive_support",label:"Cognitive Support",description:"Clear signage, quiet spaces, and sensory-friendly environments",icon:e.jsx($e,{className:"h-4 w-4"}),category:"cognitive"}],kr=({selectedAccessibility:s,onAccessibilityChange:t,hotelAccessibilityData:a,className:r=""})=>{const c=l=>{const d=s.includes(l)?s.filter(n=>n!==l):[...s,l];t(d)},h=l=>a?vs.filter(d=>d.category===l).reduce((d,n)=>d+(a[n.id]?1:0),0):0,f=[{key:"mobility",label:"Mobility & Physical",icon:e.jsx(De,{className:"h-4 w-4"})},{key:"hearing",label:"Hearing",icon:e.jsx(Ye,{className:"h-4 w-4"})},{key:"visual",label:"Visual",icon:e.jsx(ns,{className:"h-4 w-4"})},{key:"cognitive",label:"Cognitive & Sensory",icon:e.jsx($e,{className:"h-4 w-4"})}];return e.jsxs(R,{className:`travel-card ${r}`,children:[e.jsxs(I,{className:"pb-3",children:[e.jsxs(F,{className:"text-lg flex items-center",children:[e.jsx(De,{className:"h-5 w-5 mr-2"}),"Accessibility Features"]}),s.length>0&&e.jsxs(T,{variant:"secondary",className:"w-fit",children:[s.length," selected"]})]}),e.jsx(P,{className:"pt-0",children:e.jsxs("div",{className:"space-y-4",children:[f.map((l,d)=>{const n=vs.filter(i=>i.category===l.key),o=h(l.key);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[l.icon,e.jsx("span",{className:"font-medium text-sm",children:l.label})]}),a&&e.jsxs(T,{variant:"outline",className:"text-xs",children:[o," available"]})]}),e.jsx("div",{className:"space-y-3 pl-6",children:n.map(i=>{var j;const x=s.includes(i.id),m=(j=a==null?void 0:a[i.id])!=null?j:!0;return e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Se,{id:i.id,checked:x,onCheckedChange:()=>c(i.id),disabled:a&&!m,className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{htmlFor:i.id,className:`text-sm font-medium cursor-pointer ${a&&!m?"text-muted-foreground line-through":""}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[i.icon,e.jsx("span",{children:i.label}),a&&!m&&e.jsx(T,{variant:"outline",className:"text-xs",children:"Not available"})]})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:i.description})]})]},i.id)})}),d<f.length-1&&e.jsx(ee,{className:"mt-4"})]},l.key)}),e.jsx("div",{className:"pt-2",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"Accessibility information is provided by hotels and may vary. Contact the hotel directly to confirm specific accessibility needs."})})]})})]})},Sr=({currentCheckIn:s,currentCheckOut:t,currentPrice:a,onDateSelect:r,className:c=""})=>{const[h,f]=u.useState([]),[l,d]=u.useState(!1),n=()=>{const m=xe(s),j=xe(t),v=Math.floor((j.getTime()-m.getTime())/(1e3*60*60*24)),b=[];for(let p=-3;p<=3;p++){if(p===0)continue;const g=Be(m,p);if(Be(g,v),g<new Date)continue;const w=g.getDay(),y=w===5||w===6;let k=1,N="high";y?(k=1.3,N="medium"):(w===1||w===2)&&(k=.8,N="high");const C=g.getMonth();(C===11||C===0||C===1)&&(k*=1.2,N=N==="high"?"medium":"low");const E=Math.round(a*k),L=a-E;b.push({date:X(g,"yyyy-MM-dd"),price:E,savings:L,availability:N})}f(b.sort((p,g)=>g.savings-p.savings))};u.useEffect(()=>{s&&t&&a>0&&n()},[s,t,a]);const o=()=>Math.max(...h.map(m=>m.savings),0),i=m=>{const j=xe(m);xe(t);const v=Math.floor((xe(t).getTime()-xe(s).getTime())/(1e3*60*60*24)),b=Be(j,v);return{checkIn:X(j,"MMM dd"),checkOut:X(b,"MMM dd"),fullCheckOut:X(b,"yyyy-MM-dd")}};if(h.length===0)return null;const x=o();return e.jsxs(R,{className:`travel-card ${c}`,children:[e.jsx(I,{className:"pb-3",children:e.jsxs(F,{className:"text-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(je,{className:"h-5 w-5 mr-2"}),"Flexible Dates"]}),x>0&&e.jsxs(T,{variant:"secondary",className:"bg-green-100 text-green-800",children:["Save up to $",x]})]})}),e.jsx(P,{className:"pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid grid-cols-1 gap-2",children:h.slice(0,l?h.length:3).map((m,j)=>{const v=i(m.date),b=m.date===s;return e.jsx("div",{className:`p-3 rounded-lg border transition-colors cursor-pointer hover:bg-muted/50 ${b?"border-primary bg-primary/5":""}`,onClick:()=>r(m.date,v.fullCheckOut),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[v.checkIn," - ",v.checkOut]}),e.jsx("div",{className:"flex items-center space-x-2 mt-1",children:e.jsx(T,{variant:m.availability==="high"?"default":m.availability==="medium"?"secondary":"destructive",className:"text-xs",children:m.availability==="high"?"Great availability":m.availability==="medium"?"Limited rooms":"Few rooms left"})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold",children:["$",m.price]}),m.savings!==0&&e.jsx("div",{className:"flex items-center text-sm",children:m.savings>0?e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"h-3 w-3 text-green-600 mr-1"}),e.jsxs("span",{className:"text-green-600",children:["-$",m.savings]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-3 w-3 text-red-600 mr-1"}),e.jsxs("span",{className:"text-red-600",children:["+$",Math.abs(m.savings)]})]})})]})]})},j)})}),h.length>3&&e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>d(!l),className:"w-full",children:l?"Show Less":`Show ${h.length-3} More Options`}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Prices are estimated and may vary based on actual availability"})]})})]})},Cr=({className:s=""})=>{const[t,a]=u.useState(null),[r,c]=u.useState([]),h=()=>({searchToView:23.5+(Math.random()-.5)*5,viewToBooking:3.2+(Math.random()-.5)*1,averageBookingValue:245+Math.random()*100,customerLifetimeValue:820+Math.random()*200,abandonmentRate:76.8+(Math.random()-.5)*8,timeToBooking:18+Math.random()*12}),f=()=>[{step:"Hotel Search",count:1e3,conversionRate:100,dropOff:0},{step:"Hotel View",count:Math.floor(1e3*.75),conversionRate:75,dropOff:25},{step:"Offers Check",count:Math.floor(1e3*.45),conversionRate:45,dropOff:30},{step:"Booking Details",count:Math.floor(1e3*.18),conversionRate:18,dropOff:27},{step:"Payment",count:Math.floor(1e3*.12),conversionRate:12,dropOff:6},{step:"Confirmed",count:Math.floor(1e3*.09),conversionRate:9,dropOff:3}];if(u.useEffect(()=>{a(h()),c(f());const d=setInterval(()=>{a(h()),c(f())},3e4);return()=>clearInterval(d)},[]),!t)return null;const l=(d,n)=>{const o=(d-n)/n*100;return Math.abs(o)<2?{icon:null,color:"text-muted-foreground",text:"stable"}:o>0?{icon:e.jsx(Y,{className:"h-3 w-3"}),color:"text-green-600",text:`+${o.toFixed(1)}%`}:{icon:e.jsx(ge,{className:"h-3 w-3"}),color:"text-red-600",text:`${o.toFixed(1)}%`}};return e.jsxs("div",{className:`space-y-4 ${s}`,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(R,{className:"travel-card",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Booking Value"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",t.averageBookingValue.toFixed(0)]}),e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[l(t.averageBookingValue,280).icon,e.jsx("span",{className:`text-xs ${l(t.averageBookingValue,280).color}`,children:l(t.averageBookingValue,280).text})]})]}),e.jsx(Ge,{className:"h-8 w-8 text-primary"})]})})}),e.jsx(R,{className:"travel-card",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Search to Booking"}),e.jsxs("p",{className:"text-2xl font-bold",children:[t.searchToView.toFixed(1),"%"]}),e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[l(t.searchToView,22).icon,e.jsx("span",{className:`text-xs ${l(t.searchToView,22).color}`,children:l(t.searchToView,22).text})]})]}),e.jsx(Es,{className:"h-8 w-8 text-primary"})]})})}),e.jsx(R,{className:"travel-card",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Customer LTV"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",t.customerLifetimeValue.toFixed(0)]}),e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[l(t.customerLifetimeValue,900).icon,e.jsx("span",{className:`text-xs ${l(t.customerLifetimeValue,900).color}`,children:l(t.customerLifetimeValue,900).text})]})]}),e.jsx(Z,{className:"h-8 w-8 text-primary"})]})})})]}),e.jsxs(R,{className:"travel-card",children:[e.jsx(I,{children:e.jsx(F,{className:"text-lg",children:"Conversion Funnel"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-4",children:r.map((d,n)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:d.step}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[d.count.toLocaleString()," users"]}),e.jsxs(T,{variant:d.conversionRate>50?"default":d.conversionRate>20?"secondary":"destructive",children:[d.conversionRate,"%"]})]})]}),e.jsx(Ce,{value:d.conversionRate,className:"h-2"}),d.dropOff>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[d.dropOff,"% drop-off from previous step"]})]},d.step))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(R,{className:"travel-card",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(fe,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Time to Booking"}),e.jsxs("p",{className:"text-xl font-bold",children:[t.timeToBooking.toFixed(0)," minutes"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Industry avg: 25 minutes"})]})]})})}),e.jsx(R,{className:"travel-card",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ge,{className:"h-8 w-8 text-destructive"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Abandonment Rate"}),e.jsxs("p",{className:"text-xl font-bold",children:[t.abandonmentRate.toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Industry avg: 78%"})]})]})})})]})]})};function Dr({destination:s,checkIn:t,checkOut:a,guests:r,onDestinationChange:c,onLocationSelect:h,selectedAccessibility:f=[],onAccessibilityChange:l,className:d=""}){const[n,o]=u.useState(!1),[i,x]=u.useState(!1),[m,j]=u.useState(!1),[v,b]=u.useState(!1),[p,g]=u.useState(!1);return e.jsx(bt,{children:e.jsxs("div",{className:`flex items-center gap-2 p-3 bg-card border rounded-lg shadow-sm ${d}`,children:[e.jsxs(ie,{open:n,onOpenChange:o,children:[e.jsxs(ye,{children:[e.jsx(ve,{asChild:!0,children:e.jsx(le,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"sm",className:"h-9 w-9 p-0",children:e.jsx(Is,{className:"h-4 w-4"})})})}),e.jsx(be,{children:"Voice Search"})]}),e.jsx(ce,{className:"w-80",align:"start",children:e.jsx(br,{onVoiceResult:w=>{console.log("Voice result:",w),o(!1)},onDestinationChange:c})})]}),e.jsxs(ie,{open:i,onOpenChange:x,children:[e.jsxs(ye,{children:[e.jsx(ve,{asChild:!0,children:e.jsx(le,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"sm",className:"h-9 w-9 p-0",children:e.jsx(q,{className:"h-4 w-4"})})})}),e.jsx(be,{children:"Hotels Near Me"})]}),e.jsx(ce,{className:"w-80",align:"start",children:e.jsx(wr,{onLocationSelect:w=>{h==null||h(w),x(!1)}})})]}),e.jsxs(ie,{open:m,onOpenChange:j,children:[e.jsxs(ye,{children:[e.jsx(ve,{asChild:!0,children:e.jsx(le,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"sm",className:"h-9 w-9 p-0",children:e.jsx(De,{className:"h-4 w-4"})})})}),e.jsx(be,{children:"Accessibility Options"})]}),e.jsx(ce,{className:"w-96",align:"start",children:e.jsx(kr,{selectedAccessibility:f,onAccessibilityChange:l})})]}),e.jsxs(ie,{open:v,onOpenChange:b,children:[e.jsxs(ye,{children:[e.jsx(ve,{asChild:!0,children:e.jsx(le,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"sm",className:"h-9 w-9 p-0",children:e.jsx(je,{className:"h-4 w-4"})})})}),e.jsx(be,{children:"Flexible Dates"})]}),e.jsx(ce,{className:"w-96",align:"start",children:e.jsx(Sr,{currentCheckIn:t,currentCheckOut:a,currentPrice:250,onDateSelect:w=>{console.log("Date selected:",w),b(!1)}})})]}),e.jsx("div",{className:"w-px h-6 bg-border mx-1"}),e.jsxs(ie,{open:p,onOpenChange:g,children:[e.jsxs(ye,{children:[e.jsx(ve,{asChild:!0,children:e.jsx(le,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"sm",className:"h-9 w-9 p-0",children:e.jsx(wt,{className:"h-4 w-4"})})})}),e.jsx(be,{children:"Analytics"})]}),e.jsx(ce,{className:"w-[600px]",align:"end",children:e.jsx(Cr,{})})]})]})})}const Rr=({currentLocation:s,searchCriteria:t,className:a=""})=>{const[r,c]=u.useState([]),[h,f]=u.useState(!0),[l,d]=u.useState(null),{user:n}=kt();u.useEffect(()=>{n&&o(),i()},[n,s,t]);const o=async()=>{if(n)try{const j=await ca.fetchTravelAnalytics(n.id);d(j)}catch(j){O.error("Error loading user profile:",j)}},i=()=>{c([{id:"rec1",type:"hotel",title:"The Langham, Sydney",description:"Luxury harbor views perfect for romantic getaways",price:289,location:"Sydney, Australia",image:"/api/placeholder/300/200",score:9.2,reasons:["Matches your luxury preferences","Popular with couples","Great harbor views"],savings:45,urgency:"Limited time offer"},{id:"rec2",type:"flight",title:"Direct flights to Tokyo",description:"Experience cherry blossom season",price:756,location:"Tokyo, Japan",image:"/api/placeholder/300/200",score:8.8,reasons:["Based on your search history","Seasonal recommendation","Great value"],savings:120},{id:"rec3",type:"activity",title:"Blue Mountains Adventure",description:"Scenic railway and bushwalking",price:89,location:"Blue Mountains, Australia",image:"/api/placeholder/300/200",score:9.1,reasons:["Perfect for nature lovers","Close to your location","Highly rated"]},{id:"rec4",type:"hotel",title:"Budget-friendly CBD Stay",description:"Modern hotel with excellent transport links",price:125,location:"Melbourne, Australia",image:"/api/placeholder/300/200",score:8.5,reasons:["Great value option","Convenient location","Recent positive reviews"],urgency:"Only 2 rooms left"}]),f(!1)},x=j=>{switch(j){case"hotel":return q;case"flight":return fe;case"activity":return Z;default:return ue}},m=j=>{oa.logActivity({activity_type:"recommendation_click",item_type:j.type,item_id:j.id,item_data:j})};return h?e.jsxs(R,{className:a,children:[e.jsx(I,{children:e.jsx(F,{children:"Smart Recommendations"})}),e.jsx(P,{children:e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(j=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-20 h-20 bg-muted rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/2"})]})]},j))})})]}):e.jsxs(R,{className:a,children:[e.jsx(I,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5"}),"Smart Recommendations"]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-4",children:r.map(j=>{const v=x(j.type);return e.jsxs("div",{className:"flex gap-4 p-4 border rounded-lg hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>m(j),children:[e.jsx("div",{className:"w-20 h-20 bg-muted rounded-lg flex items-center justify-center",children:e.jsx(v,{className:"h-8 w-8 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:j.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:j.description}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(q,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:j.location})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-semibold",children:["$",j.price]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-3 w-3 fill-current text-yellow-500"}),e.jsx("span",{className:"text-xs",children:j.score})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[j.savings&&e.jsxs(T,{variant:"secondary",className:"text-xs",children:["Save $",j.savings]}),j.urgency&&e.jsx(T,{variant:"destructive",className:"text-xs",children:j.urgency}),e.jsxs(T,{variant:"outline",className:"text-xs",children:["Match ",Math.round(j.score*10),"%"]})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:j.reasons.slice(0,2).join(" • ")})]})]},j.id)})})})]})},Pr=({isMobile:s=!1,children:t,onBookingStart:a,onBookingComplete:r})=>{const[c,h]=u.useState(!1),[f,l]=u.useState(0),[d,n]=u.useState(!1);return u.useEffect(()=>{const o=()=>{const i="ontouchstart"in window||navigator.maxTouchPoints>0,x=window.innerWidth<768;n(i&&x)};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),!d&&!s?e.jsx(e.Fragment,{children:t}):e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"md:hidden",children:[t,e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-background border-t border-border p-4 z-50",children:e.jsx(D,{className:"w-full h-12 text-lg font-semibold rounded-2xl",onClick:()=>{h(!0),a==null||a()},children:"Book Now - Quick & Easy"})}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end",children:e.jsxs("div",{className:"bg-background rounded-t-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-background border-b border-border p-4 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Complete Booking"}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>h(!1),children:e.jsx(Je,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsx(R,{children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 text-primary flex items-center justify-center text-sm font-medium",children:"1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"Quick Details"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Name & contact info"})]}),e.jsx(St,{className:"h-5 w-5 text-primary"})]})})}),e.jsx(R,{children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-medium",children:"2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"Payment"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Secure & fast checkout"})]}),e.jsx(da,{className:"h-5 w-5 text-muted-foreground"})]})})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(T,{variant:"secondary",className:"w-full justify-center py-2",children:"🔒 Secure booking in under 30 seconds"}),e.jsx(D,{className:"w-full h-12 text-lg font-semibold rounded-2xl",onClick:()=>{r==null||r(),h(!1)},children:"Complete Booking"}),e.jsxs(D,{variant:"outline",className:"w-full h-12 rounded-2xl",children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),"Call to Book"]})]})]})]})})]}),e.jsx("div",{className:"hidden md:block",children:t})]})},Ar=u.createContext(void 0),Tr=({children:s})=>{const[t,a]=u.useState(!1),[r,c]=u.useState(!1),[h,f]=u.useState(!1),[l,d]=u.useState(!1),[n,o]=u.useState(!1),{announce:i,prefersReducedMotion:x}=xa();u.useEffect(()=>{const p=localStorage.getItem("accessibility-preferences");if(p)try{const g=JSON.parse(p);a(g.highContrast||!1),c(g.reducedMotion||x),f(g.largeText||!1),d(g.screenReader||!1),o(g.keyboardNavigation||!1)}catch(g){console.error("Error loading accessibility preferences:",g)}else c(x)},[x]),u.useEffect(()=>{const p={highContrast:t,reducedMotion:r,largeText:h,screenReader:l,keyboardNavigation:n};localStorage.setItem("accessibility-preferences",JSON.stringify(p));const g=document.body;g.classList.toggle("high-contrast",t),g.classList.toggle("reduced-motion",r),g.classList.toggle("large-text",h),g.classList.toggle("screen-reader-active",l),g.classList.toggle("keyboard-navigation",n)},[t,r,h,l,n]),u.useEffect(()=>{const p=w=>{w.key==="Tab"&&o(!0)},g=()=>{o(!1)};return document.addEventListener("keydown",p),document.addEventListener("mousedown",g),()=>{document.removeEventListener("keydown",p),document.removeEventListener("mousedown",g)}},[]);const b={highContrast:t,reducedMotion:r,largeText:h,screenReader:l,keyboardNavigation:n,toggleHighContrast:()=>a(!t),toggleReducedMotion:()=>c(!r),toggleLargeText:()=>f(!h),setScreenReader:d,setKeyboardNavigation:o,announce:i};return e.jsx(Ar.Provider,{value:b,children:s})},Mr=({sessionId:s="default",currentStep:t="search",isVisible:a=!1,onOptimizationSuggestion:r,forceShow:c=!1})=>{var b;const[h,f]=u.useState(null),[l,d]=u.useState(!0),[n,o]=u.useState(!1),[i,x]=u.useState(!1),m=!1;u.useEffect(()=>{const p=async()=>{try{const y={sessionId:s,timestamp:Date.now(),funnel:{search:1e3,results:850,hotel_view:620,room_selection:380,checkout:280,payment:220,confirmation:185},conversionRates:{search_to_view:62,view_to_selection:61.3,selection_to_checkout:73.7,checkout_to_payment:78.6,payment_to_confirmation:84.1,overall:18.5},dropOffPoints:["hotel_view","room_selection"],abTestVariant:Math.random()>.5?"variant_a":"variant_b"};f(y),y.conversionRates.view_to_selection<50&&(r==null||r("Consider adding more room photos and reviews to improve selection rate")),y.conversionRates.checkout_to_payment<70&&(r==null||r("Simplify checkout form to reduce payment abandonment")),d(!1)}catch(y){console.error("Error tracking conversion:",y),d(!1)}};p(),(()=>{typeof window<"u"&&window.gtag&&window.gtag("event","booking_funnel_step",{step_name:t,session_id:s,timestamp:Date.now()})})();const w=setInterval(p,3e4);return()=>clearInterval(w)},[s,t,r]);const j=p=>{switch(p){case"search":return e.jsx(Z,{className:"h-4 w-4"});case"results":return e.jsx(Y,{className:"h-4 w-4"});case"hotel_view":return e.jsx(Z,{className:"h-4 w-4"});case"room_selection":return e.jsx(Ns,{className:"h-4 w-4"});case"checkout":return e.jsx(Ns,{className:"h-4 w-4"});case"payment":return e.jsx($s,{className:"h-4 w-4"});case"confirmation":return e.jsx(ne,{className:"h-4 w-4"});default:return e.jsx(Z,{className:"h-4 w-4"})}},v=p=>p>70?e.jsx(Y,{className:"h-3 w-3 text-green-600"}):e.jsx(ge,{className:"h-3 w-3 text-red-600"});return!a||!h||l||!c&&m||n?null:e.jsx("div",{className:"fixed top-4 left-4 z-40 max-w-sm",children:e.jsxs(R,{className:"bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[e.jsx(I,{className:"pb-2",children:e.jsxs(F,{className:"text-sm flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Conversion Analytics",e.jsx(T,{variant:"outline",className:"text-xs",children:(b=h.abTestVariant)==null?void 0:b.toUpperCase()}),e.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[e.jsx(D,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>x(!i),children:i?e.jsx(ja,{className:"h-3 w-3"}):e.jsx(ya,{className:"h-3 w-3"})}),e.jsx(D,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>o(!0),children:e.jsx(Je,{className:"h-3 w-3"})})]})]})}),!i&&e.jsxs(P,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Overall Conversion"}),e.jsxs("span",{className:"text-lg font-bold text-primary",children:[h.conversionRates.overall,"%"]})]}),e.jsx(Ce,{value:h.conversionRates.overall,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-xs font-medium text-muted-foreground",children:"Conversion Funnel"}),Object.entries(h.funnel).map(([p,g],w)=>{const y=w===0?100:g/h.funnel.search*100,k=Object.values(h.conversionRates)[w]||y;return e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:j(p)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"capitalize",children:p.replace("_"," ")}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{children:[k.toFixed(1),"%"]}),v(k)]})]}),e.jsx(Ce,{value:y,className:"h-1"})]}),e.jsx("span",{className:"text-muted-foreground w-8 text-right",children:g})]},p)})]}),h.dropOffPoints.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"text-xs font-medium text-muted-foreground",children:"Critical Drop-offs"}),h.dropOffPoints.map(p=>e.jsx(T,{variant:"destructive",className:"text-xs",children:p.replace("_"," ")},p))]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Session:"}),e.jsxs("span",{children:[s.slice(0,8),"..."]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Current Step:"}),e.jsx("span",{className:"capitalize",children:t.replace("_"," ")})]})]})]})]})})},Er=({userPreferences:s,onRecommendationClick:t,className:a})=>{const[r,c]=u.useState([]),[h,f]=u.useState(!0),l=u.useMemo(()=>s?[{id:"1",type:"hotel",title:"The Grand Luxury Hotel",description:"Perfect for business travelers with excellent amenities",score:95,reason:"Matches your business travel preferences",image:"/api/placeholder/300/200",price:250,originalPrice:300},{id:"2",type:"destination",title:"Dubai Business District",description:"Top destination for business travelers",score:88,reason:"Popular among business travelers like you",image:"/api/placeholder/300/200"},{id:"3",type:"deal",title:"Weekend Getaway Package",description:"Special offer for frequent travelers",score:82,reason:"Exclusive deal based on your booking history",image:"/api/placeholder/300/200",price:180,originalPrice:240}].filter(i=>i.type==="hotel"&&i.price?i.price>=s.priceRange[0]&&i.price<=s.priceRange[1]:!0).sort((i,x)=>x.score-i.score):[],[s]);u.useEffect(()=>{f(!0),setTimeout(()=>{c(l),f(!1)},1e3)},[l]);const d=o=>{switch(o){case"hotel":return e.jsx(q,{className:"h-4 w-4"});case"destination":return e.jsx(G,{className:"h-4 w-4"});case"deal":return e.jsx(ue,{className:"h-4 w-4"});default:return e.jsx($e,{className:"h-4 w-4"})}},n=o=>{switch(o){case"hotel":return"bg-blue-500/10 text-blue-500 border-blue-500/20";case"destination":return"bg-green-500/10 text-green-500 border-green-500/20";case"deal":return"bg-purple-500/10 text-purple-500 border-purple-500/20";default:return"bg-gray-500/10 text-gray-500 border-gray-500/20"}};return h?e.jsxs(R,{className:a,children:[e.jsx(I,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5"}),"Personalized for You"]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-4",children:[1,2,3].map(o=>e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-24 bg-muted rounded-lg"})},o))})})]}):e.jsxs(R,{className:a,children:[e.jsxs(I,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-primary"}),"Personalized for You"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recommendations based on your preferences and booking history"})]}),e.jsxs(P,{children:[e.jsxs("div",{className:"space-y-4",children:[r.map(o=>e.jsxs("div",{className:"flex gap-4 p-4 bg-card border rounded-lg hover:shadow-md transition-shadow cursor-pointer",onClick:()=>t==null?void 0:t(o),children:[e.jsx("div",{className:"w-20 h-16 bg-muted rounded-md flex-shrink-0 overflow-hidden",children:e.jsx("img",{src:o.image,alt:o.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-1",children:[e.jsx("h4",{className:"font-semibold text-sm truncate",children:o.title}),e.jsxs(T,{variant:"outline",className:`ml-2 ${n(o.type)}`,children:[d(o.type),o.type]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2 line-clamp-2",children:o.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(T,{variant:"secondary",className:"text-xs",children:[e.jsx(G,{className:"h-3 w-3 mr-1"}),o.score,"% match"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:o.reason})]}),o.price&&e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-semibold",children:["$",o.price]}),o.originalPrice&&e.jsxs("div",{className:"text-xs text-muted-foreground line-through",children:["$",o.originalPrice]})]})]})]})]},o.id)),r.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ue,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No personalized recommendations available yet."}),e.jsx("p",{className:"text-sm",children:"Complete your profile to get better suggestions!"})]})]}),r.length>0&&e.jsxs(D,{variant:"outline",className:"w-full mt-4",children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"View More Recommendations"]})]})]})},$r=({hotelId:s,basePrice:t,currentBooking:a,onPriceUpdate:r,onUpsellSelect:c,className:h})=>{const[f,l]=u.useState(null),[d,n]=u.useState([]),[o,i]=u.useState(0);u.useEffect(()=>{const j={basePrice:t,currentPrice:t,demandMultiplier:1.15,seasonalAdjustment:1.05,competitorPricing:t*1.08,optimizedPrice:Math.round(t*1.15*1.05),priceChangeDirection:"up",confidence:87};l(j);const v=[{id:"1",type:"room_upgrade",title:"Ocean View Suite Upgrade",description:"Upgrade to a premium suite with stunning ocean views",additionalRevenue:85,conversionProbability:.32,urgency:"high"},{id:"2",type:"amenity",title:"Spa Package Add-on",description:"Relaxing spa treatment package for two",additionalRevenue:120,conversionProbability:.24,urgency:"medium"},{id:"3",type:"service",title:"Airport Transfer Service",description:"Private luxury transfer to/from airport",additionalRevenue:45,conversionProbability:.56,urgency:"low"},{id:"4",type:"package",title:"Dining Experience Package",description:"Fine dining at our award-winning restaurant",additionalRevenue:95,conversionProbability:.28,urgency:"medium"}];n(v);const b=v.reduce((p,g)=>p+g.additionalRevenue*g.conversionProbability,0);i(b)},[t]);const x=j=>{switch(j){case"room_upgrade":return e.jsx(Y,{className:"h-4 w-4"});case"amenity":return e.jsx(Ze,{className:"h-4 w-4"});case"service":return e.jsx(ha,{className:"h-4 w-4"});case"package":return e.jsx(Es,{className:"h-4 w-4"});default:return e.jsx(Ge,{className:"h-4 w-4"})}},m=j=>{switch(j){case"high":return"bg-red-500/10 text-red-500 border-red-500/20";case"medium":return"bg-yellow-500/10 text-yellow-500 border-yellow-500/20";case"low":return"bg-green-500/10 text-green-500 border-green-500/20";default:return"bg-gray-500/10 text-gray-500 border-gray-500/20"}};return f?e.jsxs("div",{className:`space-y-6 ${h}`,children:[e.jsxs(R,{children:[e.jsx(I,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-primary"}),"Dynamic Pricing"]})}),e.jsxs(P,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Current Price"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",f.currentPrice]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Optimized Price"}),e.jsxs("p",{className:"text-2xl font-bold text-primary",children:["$",f.optimizedPrice]})]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Demand Multiplier"}),e.jsxs("span",{children:[f.demandMultiplier,"x"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Seasonal Adjustment"}),e.jsxs("span",{children:[f.seasonalAdjustment,"x"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Confidence Level"}),e.jsxs("span",{children:[f.confidence,"%"]})]})]}),e.jsx(Ce,{value:f.confidence,className:"mb-4"}),e.jsxs(D,{onClick:()=>r==null?void 0:r(f.optimizedPrice),className:"w-full",children:["Apply Optimized Pricing (+$",f.optimizedPrice-f.currentPrice,")"]})]})]}),e.jsxs(R,{children:[e.jsxs(I,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5 text-primary"}),"Upsell Opportunities"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Potential additional revenue: $",o.toFixed(0)]})]}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:d.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-card border rounded-lg hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:x(j.type)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm",children:j.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:j.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(T,{variant:"outline",className:m(j.urgency),children:[j.urgency," priority"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Math.round(j.conversionProbability*100),"% conversion"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold text-primary",children:["+$",j.additionalRevenue]}),e.jsx(D,{size:"sm",variant:"outline",onClick:()=>c==null?void 0:c(j),children:"Add"})]})]},j.id))})})]})]}):e.jsx(R,{className:h,children:e.jsx(P,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"})]})})})},Ir=({onPackageSelect:s,className:t})=>{const[a,r]=u.useState([]),[c]=u.useState([{id:"luxury-dubai",name:"Dubai Luxury Experience",description:"5-day luxury package with premium hotel, flights, and exclusive experiences",items:[{id:"1",type:"hotel",title:"Burj Al Arab",description:"3 nights in luxury suite",location:"Dubai, UAE",date:"2024-03-15",guests:2,price:1200,originalPrice:1500},{id:"2",type:"flight",title:"Business Class Flight",description:"Round trip business class",location:"Dubai, UAE",date:"2024-03-15",guests:2,price:800,originalPrice:1e3},{id:"3",type:"activity",title:"Desert Safari",description:"Premium desert safari with dinner",location:"Dubai, UAE",date:"2024-03-16",guests:2,price:150}],totalPrice:2150,savings:350,duration:"5 days"}]),h=n=>{const o={id:`item-${Date.now()}`,type:n,title:`New ${n}`,description:`Add ${n} details`,location:"",date:"",guests:2,price:0};r([...a,o])},f=n=>{r(a.filter(o=>o.id!==n))},l=n=>{switch(n){case"hotel":return e.jsx(q,{className:"h-4 w-4"});case"flight":return e.jsx(He,{className:"h-4 w-4"});case"activity":return e.jsx(je,{className:"h-4 w-4"});case"transfer":return e.jsx(Z,{className:"h-4 w-4"});default:return e.jsx(He,{className:"h-4 w-4"})}},d=n=>{switch(n){case"hotel":return"bg-blue-500/10 text-blue-500 border-blue-500/20";case"flight":return"bg-green-500/10 text-green-500 border-green-500/20";case"activity":return"bg-purple-500/10 text-purple-500 border-purple-500/20";case"transfer":return"bg-orange-500/10 text-orange-500 border-orange-500/20";default:return"bg-gray-500/10 text-gray-500 border-gray-500/20"}};return e.jsxs("div",{className:`space-y-6 ${t}`,children:[e.jsxs(R,{children:[e.jsxs(I,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-5 w-5 text-primary"}),"Package Deals"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Save more with our curated travel packages"})]}),e.jsx(P,{children:e.jsx("div",{className:"space-y-4",children:c.map(n=>e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>s==null?void 0:s(n),children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:n.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-bold text-primary",children:["$",n.totalPrice]}),e.jsxs(T,{variant:"secondary",className:"text-green-600",children:["Save $",n.savings]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.duration})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:n.items.map(o=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted/30 rounded",children:[e.jsxs(T,{className:d(o.type),children:[l(o.type),o.type]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:o.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",o.price]})]})]},o.id))})]},n.id))})})]}),e.jsxs(R,{children:[e.jsxs(I,{children:[e.jsx(F,{children:"Build Custom Package"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create your own travel package by adding items"})]}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>h("hotel"),children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Add Hotel"]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>h("flight"),children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Add Flight"]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>h("activity"),children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Add Activity"]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>h("transfer"),children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Add Transfer"]})]}),e.jsx("div",{className:"space-y-3",children:a.map(n=>e.jsx(R,{className:"border",children:e.jsxs(P,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs(T,{className:d(n.type),children:[l(n.type),n.type]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>f(n.id),children:e.jsx(Je,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(he,{htmlFor:`title-${n.id}`,children:"Title"}),e.jsx(Ee,{id:`title-${n.id}`,value:n.title,placeholder:"Enter title"})]}),e.jsxs("div",{children:[e.jsx(he,{htmlFor:`location-${n.id}`,children:"Location"}),e.jsx(Ee,{id:`location-${n.id}`,value:n.location,placeholder:"Enter location"})]}),e.jsxs("div",{children:[e.jsx(he,{htmlFor:`date-${n.id}`,children:"Date"}),e.jsx(Ee,{id:`date-${n.id}`,type:"date",value:n.date})]}),e.jsxs("div",{children:[e.jsx(he,{htmlFor:`guests-${n.id}`,children:"Guests"}),e.jsxs(es,{value:n.guests.toString(),children:[e.jsx(ss,{children:e.jsx(ts,{})}),e.jsx(as,{children:[1,2,3,4,5,6].map(o=>e.jsxs(oe,{value:o.toString(),children:[o," guest",o>1?"s":""]},o))})]})]})]})]})},n.id))}),a.length>0&&e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.length," item",a.length>1?"s":""," selected"]})}),e.jsx(D,{children:"Create Package"})]})]})})]})]})},Fr=({onPointsRedeem:s,onEarnPoints:t,className:a})=>{const[r,c]=u.useState([]),[h,f]=u.useState([]),[l,d]=u.useState(null);u.useEffect(()=>{const m=[{id:"marriott-bonvoy",name:"Marriott Bonvoy",type:"hotel",membershipLevel:"Gold Elite",points:25750,pointsValue:257.5,nextTierPoints:5e4,benefits:["Free WiFi","Late Checkout","Room Upgrades","Bonus Points"],canRedeem:!0},{id:"chase-sapphire",name:"Chase Sapphire Reserve",type:"credit_card",membershipLevel:"Premium",points:42300,pointsValue:634.5,benefits:["Travel Credits","Airport Lounge Access","Travel Insurance"],canRedeem:!0},{id:"emirates-skywards",name:"Emirates Skywards",type:"airline",membershipLevel:"Silver",points:18400,pointsValue:368,nextTierPoints:25e3,benefits:["Priority Boarding","Extra Baggage","Lounge Access"],canRedeem:!0}],j=[{id:"1",type:"points",title:"Free Night Certificate",description:"Redeem for one free night at participating hotels",pointsRequired:25e3,value:250,available:!0},{id:"2",type:"points",title:"Room Upgrade",description:"Complimentary room upgrade to next category",pointsRequired:15e3,value:150,available:!0},{id:"3",type:"cashback",title:"Statement Credit",description:"Cash back applied to your statement",pointsRequired:1e4,value:100,available:!0}];c(m),f(j)},[]);const n=m=>{switch(m){case"hotel":return e.jsx(pa,{className:"h-4 w-4"});case"airline":return e.jsx(ua,{className:"h-4 w-4"});case"credit_card":return e.jsx($s,{className:"h-4 w-4"});default:return e.jsx(G,{className:"h-4 w-4"})}},o=m=>{switch(m){case"hotel":return"bg-blue-500/10 text-blue-500 border-blue-500/20";case"airline":return"bg-green-500/10 text-green-500 border-green-500/20";case"credit_card":return"bg-purple-500/10 text-purple-500 border-purple-500/20";default:return"bg-gray-500/10 text-gray-500 border-gray-500/20"}},i=m=>m.toLowerCase().includes("gold")||m.toLowerCase().includes("premium")?"text-yellow-600":m.toLowerCase().includes("silver")?"text-gray-600":m.toLowerCase().includes("platinum")?"text-purple-600":"text-blue-600",x=r.find(m=>m.id===l);return e.jsxs("div",{className:`space-y-6 ${a}`,children:[e.jsxs(R,{children:[e.jsxs(I,{children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5 text-primary"}),"Your Loyalty Programs"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your points and redeem rewards"})]}),e.jsx(P,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(m=>e.jsx(R,{className:`cursor-pointer transition-colors ${l===m.id?"ring-2 ring-primary":""}`,onClick:()=>d(m.id),children:e.jsxs(P,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs(T,{className:o(m.type),children:[n(m.type),m.type.replace("_"," ")]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold",children:m.points.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"points"})]})]}),e.jsx("h4",{className:"font-semibold mb-1",children:m.name}),e.jsx("p",{className:`text-sm font-medium mb-2 ${i(m.membershipLevel)}`,children:m.membershipLevel}),e.jsxs("div",{className:"text-sm text-muted-foreground mb-3",children:["Value: $",m.pointsValue.toFixed(2)]}),m.nextTierPoints&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Progress to next tier"}),e.jsxs("span",{children:[m.points," / ",m.nextTierPoints]})]}),e.jsx(Ce,{value:m.points/m.nextTierPoints*100,className:"h-2"})]})]})},m.id))})})]}),x&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(R,{children:[e.jsx(I,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-5 w-5 text-primary"}),x.name," Benefits"]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:x.benefits.map((m,j)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"}),e.jsx("span",{className:"text-sm",children:m})]},j))})})]}),e.jsxs(R,{children:[e.jsx(I,{children:e.jsx(F,{children:"Available Redemptions"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:h.map(m=>e.jsxs("div",{className:`p-3 border rounded-lg transition-opacity ${x.points>=m.pointsRequired?"cursor-pointer hover:shadow-sm":"opacity-50"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm",children:m.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:m.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-semibold",children:[m.pointsRequired.toLocaleString()," pts"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",m.value," value"]})]})]}),e.jsx(D,{size:"sm",variant:x.points>=m.pointsRequired?"default":"secondary",disabled:x.points<m.pointsRequired,onClick:()=>s==null?void 0:s(m),className:"w-full",children:x.points>=m.pointsRequired?"Redeem":"Insufficient Points"})]},m.id))})})]})]}),e.jsxs(R,{children:[e.jsxs(I,{children:[e.jsx(F,{children:"Earn More Points"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete your booking to earn points with participating programs"})]}),e.jsx(P,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:r.map(m=>e.jsxs("div",{className:"text-center p-4 bg-muted/30 rounded-lg",children:[e.jsxs(T,{className:`${o(m.type)} mb-2`,children:[n(m.type),m.name]}),e.jsxs("p",{className:"text-lg font-bold text-primary",children:["+",Math.floor(Math.random()*500+200)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"points on this booking"})]},m.id))})})]})]})},Lr=u.createContext(null),Ur=({children:s})=>{const[t,a]=u.useState({code:"USD",name:"US Dollar",symbol:"$",flag:"🇺🇸",rate:1}),[r]=u.useState([{code:"USD",name:"US Dollar",symbol:"$",flag:"🇺🇸",rate:1},{code:"EUR",name:"Euro",symbol:"€",flag:"🇪🇺",rate:.85},{code:"GBP",name:"British Pound",symbol:"£",flag:"🇬🇧",rate:.73},{code:"JPY",name:"Japanese Yen",symbol:"¥",flag:"🇯🇵",rate:110},{code:"AUD",name:"Australian Dollar",symbol:"A$",flag:"🇦🇺",rate:1.35},{code:"CAD",name:"Canadian Dollar",symbol:"C$",flag:"🇨🇦",rate:1.25},{code:"CHF",name:"Swiss Franc",symbol:"CHF",flag:"🇨🇭",rate:.92},{code:"AED",name:"UAE Dirham",symbol:"د.إ",flag:"🇦🇪",rate:3.67},{code:"SGD",name:"Singapore Dollar",symbol:"S$",flag:"🇸🇬",rate:1.35}]),[c,h]=u.useState(!1),f=(o,i="USD")=>{var m;return i===t.code?o:(i==="USD"?o:o/((m=r.find(j=>j.code===i))==null?void 0:m.rate)||1)*t.rate},l=(o,i=t)=>{const x=f(o);return new Intl.NumberFormat("en-US",{style:"currency",currency:i.code,minimumFractionDigits:i.code==="JPY"?0:2,maximumFractionDigits:i.code==="JPY"?0:2}).format(x)},d=o=>{const i=r.find(x=>x.code===o);i&&(a(i),localStorage.setItem("preferred-currency",o))};u.useEffect(()=>{const o=localStorage.getItem("preferred-currency");o&&d(o),o||(()=>{const x=Intl.DateTimeFormat().resolvedOptions().timeZone;x.includes("Europe")?d("EUR"):x.includes("Asia/Tokyo")?d("JPY"):x.includes("Australia")&&d("AUD")})()},[]);const n={selectedCurrency:t,currencies:r,convertPrice:f,formatPrice:l,setCurrency:d,isLoading:c};return e.jsx(Lr.Provider,{value:n,children:s})},_r=({rooms:s,onRoomsChange:t,promoCode:a="",onPromoCodeChange:r,className:c})=>{const[h,f]=u.useState(!1),[l,d]=u.useState(!1),n=s.reduce((p,g)=>p+g.adults+g.children.length,0),o=()=>{t([...s,{adults:1,children:[]}])},i=p=>{if(s.length>1){const g=s.filter((w,y)=>y!==p);t(g)}},x=(p,g)=>{const w=[...s],y=Math.max(1,Math.min(8,w[p].adults+g));w[p].adults=y,t(w)},m=p=>{const g=[...s];g[p].children.length<4&&(g[p].children.push(5),t(g))},j=(p,g)=>{const w=[...s];w[p].children.splice(g,1),t(w)},v=(p,g,w)=>{const y=[...s];y[p].children[g]=w,t(y)},b=()=>{if(s.length===1){const p=s[0],g=p.adults,w=p.children.length;return w===0?g===1?"1 Guest":`${g} Guests`:`${g} Adult${g>1?"s":""}, ${w} Child${w>1?"ren":""}`}else return`${n} Guests in ${s.length} Rooms`};return e.jsx("div",{className:"space-y-2",children:e.jsxs(ie,{open:h,onOpenChange:f,children:[e.jsx(le,{asChild:!0,children:e.jsxs(D,{variant:"outline",className:H("justify-start text-left font-normal",c),children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),b()]})}),e.jsx(ce,{className:"w-80 p-0",align:"start",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Rooms & Guests"}),s.map((p,g)=>e.jsxs("div",{className:"space-y-3 p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h5",{className:"font-medium text-sm",children:["Room ",g+1]}),s.length>1&&e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>i(g),className:"h-6 w-6 p-0",children:"×"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(he,{className:"text-sm",children:"Adults"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{variant:"outline",size:"sm",onClick:()=>x(g,-1),disabled:p.adults<=1,className:"h-8 w-8 p-0",children:e.jsx(ga,{className:"h-3 w-3"})}),e.jsx("span",{className:"w-8 text-center text-sm",children:p.adults}),e.jsx(D,{variant:"outline",size:"sm",onClick:()=>x(g,1),disabled:p.adults>=8,className:"h-8 w-8 p-0",children:e.jsx(de,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(he,{className:"text-sm",children:"Children"}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>m(g),disabled:p.children.length>=4,className:"h-8 px-2",children:[e.jsx(de,{className:"h-3 w-3 mr-1"}),"Add Child"]})]}),p.children.map((w,y)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground w-12",children:["Child ",y+1]}),e.jsxs(es,{value:w.toString(),onValueChange:k=>v(g,y,parseInt(k)),children:[e.jsx(ss,{className:"w-20 h-8",children:e.jsx(ts,{})}),e.jsx(as,{children:Array.from({length:18},(k,N)=>e.jsxs(oe,{value:N.toString(),children:[N," ",N===1?"year":"years"]},N))})]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>j(g,y),className:"h-8 w-8 p-0",children:"×"})]},y))]})]},g)),s.length<4&&e.jsxs(D,{variant:"outline",onClick:o,className:"w-full",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Add Another Room"]}),e.jsx(ee,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(D,{variant:"ghost",onClick:()=>d(!l),className:"w-full justify-start p-0 h-auto text-sm",children:[e.jsx(Ze,{className:"h-4 w-4 mr-2"}),l?"Hide":"Add"," promo code"]}),l&&r&&e.jsx(Ee,{placeholder:"Enter promo code",value:a,onChange:p=>r(p.target.value),className:"h-8"})]}),e.jsx(D,{onClick:()=>f(!1),className:"w-full",children:"Done"})]})})]})})},bs=s=>X(s,"yyyy-MM-dd"),Te=s=>{if(!s)return;const t=s.split("-");if(t.length!==3)return;const[a,r,c]=t.map(Number),h=new Date(a,(r||1)-1,c||1);return isNaN(h.getTime())?void 0:h},Or=({className:s})=>{const[t]=Ss(),a=We(),[r,c]=u.useState(t.get("destination")||""),h=Te(t.get("checkIn")),f=Te(t.get("checkOut")),[l,d]=u.useState({from:h,to:f}),n=Math.max(1,parseInt(t.get("guests")||"2")),[o,i]=u.useState([{adults:Math.min(n,8),children:[]}]),x=t.get("hotelName")||"";u.useEffect(()=>{const b=Math.max(1,parseInt(t.get("guests")||"2"));i([{adults:Math.min(b,8),children:[]}]),c(t.get("destination")||""),d({from:Te(t.get("checkIn")),to:Te(t.get("checkOut"))})},[t]);const m=u.useMemo(()=>o.reduce((b,p)=>b+p.adults+p.children.length,0),[o]),j=r.trim().length>0&&!!(l!=null&&l.from)&&!!(l!=null&&l.to),v=b=>{var g;if((g=b==null?void 0:b.preventDefault)==null||g.call(b),!j)return;const p=new URLSearchParams;p.set("destination",r.trim()),l!=null&&l.from&&p.set("checkIn",bs(l.from)),l!=null&&l.to&&p.set("checkOut",bs(l.to)),p.set("guests",String(m)),p.set("rooms",String(o.length)),p.set("searched","true"),a(`/search/hotels?${p.toString()}`)};return e.jsx("form",{onSubmit:v,className:H("w-full",s),"aria-label":"Hotel search",children:e.jsxs("div",{className:"rounded-2xl border bg-card text-card-foreground shadow-sm p-3 sm:p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx(ta,{value:r,onChange:c,onDestinationSelect:b=>c(b.name),placeholder:x?`${x} in ${r}`:"Search hotels or destinations",searchType:"hotel"}),x&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Searching for: ",x]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs(ie,{children:[e.jsx(le,{asChild:!0,children:e.jsxs(D,{variant:"outline",className:H("w-full justify-start text-left font-normal",!(l!=null&&l.from)&&!(l!=null&&l.to)&&"text-muted-foreground"),children:[e.jsx(je,{className:"mr-2 h-4 w-4"}),l!=null&&l.from?l.to?e.jsxs("span",{children:[X(l.from,"LLL dd, yyyy")," – ",X(l.to,"LLL dd, yyyy")]}):e.jsx("span",{children:X(l.from,"LLL dd, yyyy")}):e.jsx("span",{children:"Add dates"})]})}),e.jsx(ce,{className:"w-auto p-0",align:"start",children:e.jsx(la,{initialFocus:!0,mode:"range",defaultMonth:l==null?void 0:l.from,selected:l,onSelect:d,numberOfMonths:2,className:H("p-3 pointer-events-auto")})})]})}),e.jsx("div",{className:"md:col-span-1",children:e.jsx(_r,{rooms:o,onRoomsChange:i})})]}),e.jsx("div",{className:"flex justify-end mt-3",children:e.jsxs(D,{type:"submit",disabled:!j,children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Search Hotels"]})})]})})},mi=()=>{const[s]=Ss(),[t,a]=u.useState("price"),[r,c]=u.useState("list"),[h,f]=u.useState(!1),{healthStatus:l}=lr(),[d,n]=u.useState({priceRange:[0,1e3],starRating:[],guestRating:[0,10],amenities:[],propertyTypes:[],distanceFromCenter:50}),[o,i]=u.useState(!1),[x,m]=u.useState("healthy"),[j,v]=u.useState(""),b=s.get("destination")||"",[p,g]=u.useState({priceRange:[0,1e3],amenities:[],travelStyle:"leisure",starRating:4,location:b,previousBookings:[]}),w=s.get("checkIn")||"",y=s.get("checkOut")||"",k=parseInt(s.get("guests")||"2"),N=parseInt(s.get("adults")||s.get("guests")||"2"),C=parseInt(s.get("children")||"0");parseInt(s.get("rooms")||"1");const E=s.get("hotelName")||"";u.useEffect(()=>{s.get("searched")==="true"&&b&&w&&y&&i(!0)},[s,b,w,y]);const{hotels:L,loading:z,error:W}=dr(o?{destination:b,checkIn:w,checkOut:y,guests:N+C,hotelName:E||void 0}:null),Q=(A,$)=>{i(!0)},me=(A,$,is)=>{i(!0)},J=L.filter(A=>!(d.priceRange[0]>0&&A.pricePerNight<d.priceRange[0]||d.priceRange[1]<1e3&&A.pricePerNight>d.priceRange[1]||d.starRating.length>0&&!d.starRating.includes(A.starRating.toString())||d.propertyTypes.length>0&&!d.propertyTypes.includes(A.propertyType)||d.guestRating[0]>0&&A.rating<d.guestRating[0]||d.guestRating[1]<10&&A.rating>d.guestRating[1]||d.amenities.length>0&&!d.amenities.some($=>A.amenities.includes($))||A.distanceFromCenter>d.distanceFromCenter)).sort((A,$)=>{switch(t){case"price":return A.pricePerNight-$.pricePerNight;case"rating":return $.rating-A.rating;case"distance":return A.distanceFromCenter-$.distanceFromCenter;case"stars":return $.starRating-A.starRating;case"deals":return($.deals?$.deals.savings:0)-(A.deals?A.deals.savings:0);default:return 0}});return e.jsx(Ur,{children:e.jsx(Tr,{children:e.jsx(Ua,{searchType:"hotel",children:e.jsx(Cs,{children:e.jsx(aa,{componentName:"HotelSearchPage",children:e.jsx(Pr,{onBookingStart:()=>console.log("Mobile booking started"),onBookingComplete:()=>console.log("Mobile booking completed"),children:e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Dt,{}),e.jsx(Ht,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsx(Or,{})}),e.jsx(Dr,{destination:b,checkIn:w,checkOut:y,guests:k,onDestinationChange:A=>{const $=new URLSearchParams(s);$.set("destination",A),window.location.href=`/search/hotels?${$.toString()}`},onLocationSelect:A=>console.log("Location selected:",A),selectedAccessibility:[],onAccessibilityChange:A=>console.log("Accessibility filters:",A),className:"mb-6"}),o?e.jsxs(mr,{results:J,loading:z,filters:d,onFiltersChange:n,sortBy:t,onSortChange:a,viewMode:r,onViewModeChange:c,topBanner:e.jsxs(e.Fragment,{children:[e.jsx(xr,{destination:b,checkIn:w,checkOut:y,guests:k,hotelName:E}),e.jsx(Rt,{})]}),extrasBelowControls:e.jsx(hr,{filters:d,onFiltersChange:n}),sidebarAddon:e.jsx(pr,{destination:b}),children:[z&&e.jsx("div",{className:"space-y-6",children:[...Array(5)].map((A,$)=>e.jsx(ir,{},$))}),W&&e.jsx(R,{children:e.jsx(P,{className:"p-6 text-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-6xl",children:"⚠️"}),e.jsx("h3",{className:"text-xl font-semibold",children:"Unable to load hotels"}),e.jsx("p",{className:"text-destructive",children:W}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This could be due to a network connectivity issue or our booking service being temporarily unavailable."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors",children:"Try Again"}),e.jsx("button",{onClick:()=>{const A=new URLSearchParams(s);A.delete("searched"),window.location.href=`/search/hotels?${A.toString()}`},className:"px-4 py-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground rounded-md transition-colors",children:"Modify Search"})]}),l&&l.status!=="healthy"&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:[e.jsx("strong",{children:"Service Status:"})," Some of our booking services are currently experiencing issues. Please try again in a few minutes."]})]})})}),!z&&!W&&r==="list"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx($r,{basePrice:J.length>0?J[0].pricePerNight:100,className:"mb-4"}),J.map((A,$)=>e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"space-y-3",children:[$===0&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3",children:[e.jsx(yr,{hotelId:A.id}),e.jsx(vr,{hotelId:A.id,currentPrice:A.pricePerNight,checkInDate:w})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[$===0&&e.jsx(Ae,{type:"rooms_left",value:3}),A.deals&&e.jsx(Ae,{type:"flash_deal",endTime:new Date(Date.now()+2*60*60*1e3)}),$===1&&e.jsx(Ae,{type:"last_booking",value:7}),$===2&&e.jsx(Ae,{type:"high_demand"})]}),e.jsx(nr,{hotel:A})]})},A.id)),J.length===0&&e.jsx(R,{children:e.jsx(P,{className:"p-8 text-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-6xl",children:"🔍"}),e.jsx("h3",{className:"text-xl font-semibold",children:"No hotels found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your filters or search criteria to find more options."}),e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx("button",{onClick:()=>n({priceRange:[0,1e3],starRating:[],guestRating:[0,10],amenities:[],propertyTypes:[],distanceFromCenter:50}),className:"text-primary hover:underline text-sm",children:"Clear all filters"}),e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsx("button",{onClick:()=>window.history.back(),className:"text-primary hover:underline text-sm",children:"Try a different search"})]})]})})})]}),!z&&!W&&r==="map"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(gr,{hotels:J,destination:b,onHotelSelect:A=>{const $=new URLSearchParams(s);$.set("hotelName",A.name),window.location.href=`/search/hotels?${$.toString()}`}}),J.length===0&&e.jsx(R,{children:e.jsx(P,{className:"p-8 text-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-6xl",children:"🗺️"}),e.jsx("h3",{className:"text-xl font-semibold",children:"No hotels to display on map"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search criteria to find hotels in this area."})]})})})]})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsx(fr,{onHotelSelect:Q}),e.jsx(Nr,{onDealSelect:me}),e.jsx(Fr,{onPointsRedeem:A=>console.log("Points redeemed:",A)}),e.jsx(Ir,{onPackageSelect:A=>console.log("Package selected:",A)})]}),o&&J.length>0&&e.jsx("div",{className:"mt-8",children:e.jsx(Rr,{currentLocation:b,searchCriteria:{checkIn:w,checkOut:y,guests:k},className:"max-w-4xl mx-auto"})}),o&&J.length>0&&e.jsx("div",{className:"mt-8",children:e.jsx(Er,{userPreferences:p,onRecommendationClick:A=>console.log("Recommendation clicked:",A),className:"max-w-4xl mx-auto"})})]}),e.jsx(Ct,{children:e.jsx("div",{})}),e.jsx(Mr,{sessionId:`search-${Date.now()}`,currentStep:o?"results":"search",isVisible:!1,onOptimizationSuggestion:A=>console.log("Optimization:",A)}),!1]})})})})})})})};export{mi as default};
