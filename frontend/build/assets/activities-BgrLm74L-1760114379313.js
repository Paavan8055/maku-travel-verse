const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-4Iw_Ltix-1760114379313.js","assets/index-DTQh_tle-1760114379313.css"])))=>i.map(i=>d[i]);
import{k,u as E,h as T,r as p,j as e,a as g,T as C,B as f,b as P,_}from"./index-4Iw_Ltix-1760114379313.js";import{N as M}from"./Navbar--I72zT0y-1760114379313.js";import{S as D,a as L}from"./inputValidation-D8XWHn10-1760114379313.js";import{M as j}from"./map-pin-BbRlpc36-1760114379313.js";import{C as B}from"./clock-pZt6UlGg-1760114379313.js";import{f as I}from"./format-BxOk8A0D-1760114379313.js";import"./useApiHealth-CCyQCus0-1760114379313.js";import"./avatar-Ca2Jij-f-1760114379313.js";import"./index-B8-RXAC1-1760114379313.js";import"./globe-D0imvcW9-1760114379313.js";import"./useHealthMonitor-REY8nNlK-1760114379313.js";import"./useAIIntelligence-DzPQNBug-1760114379313.js";import"./plane-NTbHDsP2-1760114379313.js";import"./sparkles-a8iQ0dZr-1760114379313.js";import"./chevron-down-CMcIpBxA-1760114379313.js";import"./brain-CW1RTH-M-1760114379313.js";import"./calendar-B6U3eq7K-1760114379313.js";import"./zap-nbVlhlW4-1760114379313.js";import"./trophy-BhaNqtOm-1760114379313.js";import"./users-jKJMS9FS-1760114379313.js";import"./settings-RR2YdGrJ-1760114379313.js";import"./shield-BoMairJQ-1760114379313.js";import"./user-9qxAUHKD-1760114379313.js";import"./correlationId-qN4Y0LN8-1760114379313.js";import"./search-C7trl-BH-1760114379313.js";import"./en-US-CC7XSppg-1760114379313.js";const le=()=>{const[x]=k(),N=E(),{toast:b}=T(),i=x.get("destination")||"sydney",o=x.get("date")||"2025-08-24",n=parseInt(x.get("participants")||"2"),[d,h]=p.useState(!0),[u,v]=p.useState(null),[m,y]=p.useState([]);console.log("ActivitiesPage: Search criteria:",{destination:i,date:o,participants:n}),p.useEffect(()=>{(async()=>{h(!0),v(null);const t=L({destination:i,date:o,participants:n});if(!t.isValid){v(t.error||"Invalid search parameters"),h(!1),b({title:"Invalid Search",description:t.error,variant:"destructive"});return}try{console.log("Testing activity search with:",{destination:i,date:o,participants:n});const{supabase:a}=await _(async()=>{const{supabase:c}=await import("./index-4Iw_Ltix-1760114379313.js").then(S=>S.aW);return{supabase:c}},__vite__mapDeps([0,1])),{data:r,error:l}=await a.functions.invoke("provider-rotation",{body:{searchType:"activity",params:{destination:i,date:o,participants:n}}});if(console.log("Activity search response:",{data:r,error:l}),l)throw new Error(l.message||"Activity search failed");if(r!=null&&r.success&&(r!=null&&r.data)){const c=r.data.data||r.data.activities||r.data;y(Array.isArray(c)?c:[]),console.log("Found activities:",Array.isArray(c)?c.length:0)}else throw new Error((r==null?void 0:r.error)||"No activities found")}catch(a){console.error("Activity search error:",a),v(a instanceof Error?a.message:"Activity search failed")}finally{h(!1)}})()},[i,o,n]);const w=s=>{console.log("Activity selected:",s),s.bookingLink&&window.open(s.bookingLink,"_blank")},A=s=>{const t=document.createElement("div");return t.innerHTML=s,t.textContent||t.innerText||""};return e.jsx(D,{fallbackMessage:"Activity search is temporarily unavailable. Please try again later.",children:e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(M,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8 pt-24",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-4xl font-bold mb-4",children:["Activities in ",i]}),e.jsxs("p",{className:"text-muted-foreground",children:[I(new Date(o),"MMM dd, yyyy")," â€¢ ",n," participant",n!==1?"s":""]})]}),d&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-primary mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Finding activities..."}),e.jsx("p",{className:"text-muted-foreground",children:"Searching for the best experiences"})]}),u&&!d&&e.jsxs(g,{className:"p-12 text-center",children:[e.jsx(C,{className:"h-16 w-16 text-destructive mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Service Temporarily Unavailable"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Activity search providers are currently experiencing issues. Please try again in a few minutes."}),e.jsx(f,{onClick:()=>window.location.reload(),variant:"outline",children:"Try Again"})]}),!d&&!u&&m.length>0&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Found ",m.length," activities"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map((s,t)=>{var a,r;return e.jsxs(g,{className:"hover:shadow-lg transition-shadow",children:[s.pictures&&s.pictures[0]&&e.jsx("div",{className:"aspect-video relative overflow-hidden rounded-t-lg",children:e.jsx("img",{src:s.pictures[0],alt:s.name,className:"w-full h-full object-cover",onError:l=>{l.currentTarget.style.display="none"}})}),e.jsx(P,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:A(s.description)})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("span",{children:i})]}),s.minimumDuration&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{children:s.minimumDuration})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[((a=s.price)==null?void 0:a.currencyCode)||"AUD"," ",((r=s.price)==null?void 0:r.amount)||"99"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"per person"})]}),e.jsx(f,{onClick:()=>w(s),children:"Book Now"})]})]})})]},`${s.id}-${t}`)})})]}),!d&&!u&&m.length===0&&e.jsxs(g,{className:"p-12 text-center",children:[e.jsx(j,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Service Temporarily Unavailable"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Activity search providers are currently experiencing issues. Please try again later."}),e.jsx(f,{onClick:()=>N("/"),variant:"outline",children:"New Search"})]})]})]})})};export{le as default};
