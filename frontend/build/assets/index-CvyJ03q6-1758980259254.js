var ce=Object.defineProperty;var le=(a,s,r)=>s in a?ce(a,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[s]=r;var T=(a,s,r)=>le(a,typeof s!="symbol"?s+"":s,r);import{c as oe,r as u,j as e,a as w,d as ee,e as se,f as I,B as f,b as S,l as g,s as A,h as L,L as de,k as me}from"./index-BbpKd5pI-1758980259254.js";import{I as ue}from"./input-B6yXwn7W-1758980259254.js";import{S as Q,a as W,b as G,c as J,d as v}from"./select-DqcIEJ0Y-1758980259254.js";import{T as he,a as pe,b as K,c as X}from"./tabs-BUpaF3ow-1758980259254.js";import{u as B,N as xe}from"./Navbar-DEmKhWgz-1758980259254.js";import{C as O}from"./checkbox-MxQgYkPi-1758980259254.js";import{S as ge}from"./slider-EuvO4piK-1758980259254.js";import{u as _}from"./useAccessibility-CThe8w4A-1758980259254.js";import{F as te}from"./filter-CtMZIZDc-1758980259254.js";import{D as re}from"./dollar-sign-DjRUbFBU-1758980259254.js";import{S as z}from"./star-DdtvK_te-1758980259254.js";import{W as fe}from"./wifi-8UKbK3io-1758980259254.js";import{C as ye}from"./car-DiOIASWA-1758980259254.js";import{U as je}from"./utensils-DvFC5HMR-1758980259254.js";import{U as $}from"./users-Sq-S2vG5-1758980259254.js";import{S as E}from"./sparkles-BsWG6pMX-1758980259254.js";import{M as F}from"./map-pin-B8uBmwV_-1758980259254.js";import{H as ve}from"./heart-C10QEbn--1758980259254.js";import{T as Ne}from"./trending-up-ChiBJJEh-1758980259254.js";import{w as q}from"./correlationId-BD9wdO4T-1758980259254.js";import{C as be}from"./clock-B-sN1q9W-1758980259254.js";import{C as M}from"./calendar-C7ueGlhw-1758980259254.js";import{B as we,G as Se}from"./grid-3x3-BiJVpHo4-1758980259254.js";import{f as C}from"./format-DNlIFtmW-1758980259254.js";import{C as Y}from"./circle-check-big-Du5hC56T-1758980259254.js";import{C as ke}from"./circle-x-Dp5rmxR_-1758980259254.js";import{C as Ce}from"./circle-alert-CprkoT5Y-1758980259254.js";import{S as H}from"./search-DccZUlRV-1758980259254.js";import"./index-BdQq_4o_-1758980259254.js";import"./index-CsDGASWU-1758980259254.js";import"./chevron-down-ySX6Ggn0-1758980259254.js";import"./useApiHealth-Cwsl4QJt-1758980259254.js";import"./avatar-D6af4MZM-1758980259254.js";import"./index-BH28Msl4-1758980259254.js";import"./globe-I08qur1s-1758980259254.js";import"./useHealthMonitor-B53msORQ-1758980259254.js";import"./useAIIntelligence-gbKB27D2-1758980259254.js";import"./plane-N6gpiUrc-1758980259254.js";import"./brain-PK9hd1n6-1758980259254.js";import"./zap-sLvwSl5n-1758980259254.js";import"./menu-Cyc_uZJM-1758980259254.js";import"./settings-BMS1tau5-1758980259254.js";import"./shield-DeD6nqcd-1758980259254.js";import"./user-B1-sLbCK-1758980259254.js";import"./en-US-CC7XSppg-1758980259254.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=oe("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),Ae=({onFiltersChange:a,searchType:s})=>{const{t:r}=B();_();const[n,d]=u.useState({priceRange:[0,1e3],rating:null,amenities:[],propertyTypes:[],mealPlans:[],accessibility:[],sustainability:[],paymentOptions:[]}),[m,l]=u.useState(!1),t=[{id:"wifi",label:"Free WiFi",icon:fe},{id:"parking",label:"Free Parking",icon:ye},{id:"restaurant",label:"Restaurant",icon:je},{id:"pool",label:"Swimming Pool",icon:$},{id:"spa",label:"Spa",icon:z},{id:"gym",label:"Fitness Center",icon:$}],i=["Hotel","Resort","Apartment","Villa","Hostel","Boutique Hotel"],c=["Wheelchair Accessible","Accessible Bathroom","Roll-in Shower","Accessible Parking","Elevator","Hearing Accessible"],p=["Green Key Certified","LEED Certified","Solar Powered","Water Conservation","Organic Food Options","Local Sourcing"],y=(o,N)=>{const j={...n,[o]:N};d(j),a(j)},k=(o,N)=>{const j=n[o],V=j.includes(N)?j.filter(h=>h!==N):[...j,N];y(o,V)},R=()=>{const o={priceRange:[0,1e3],rating:null,amenities:[],propertyTypes:[],mealPlans:[],accessibility:[],sustainability:[],paymentOptions:[]};d(o),a(o)},D=(n.rating?1:0)+n.amenities.length+n.propertyTypes.length+n.accessibility.length+n.sustainability.length;return e.jsxs(w,{className:"w-full",children:[e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5"}),r("accessibility.filterBy"),D>0&&e.jsx(I,{variant:"secondary",className:"ml-2",children:D})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{variant:"ghost",size:"sm",onClick:R,disabled:D===0,children:r("common.clear")}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>l(!m),"aria-expanded":m,"aria-controls":"advanced-filters-content",children:r(m?"common.less":"common.more")})]})]})}),e.jsxs(S,{id:"advanced-filters-content",className:`space-y-6 ${m?"":"hidden"}`,children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-3",children:[e.jsx(re,{className:"inline h-4 w-4 mr-1"}),"Price Range ($",n.priceRange[0]," - $",n.priceRange[1],")"]}),e.jsx(ge,{value:n.priceRange,onValueChange:o=>y("priceRange",o),max:1e3,min:0,step:10,className:"w-full","aria-label":"Price range filter"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-3",children:"Minimum Star Rating"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(o=>e.jsxs(f,{variant:n.rating===o?"default":"outline",size:"sm",onClick:()=>y("rating",n.rating===o?null:o),className:"flex items-center gap-1","aria-pressed":n.rating===o,children:[e.jsx(z,{className:"h-3 w-3 fill-current"}),o,"+"]},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-3",children:"Amenities"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map(o=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{id:o.id,checked:n.amenities.includes(o.id),onCheckedChange:()=>k("amenities",o.id)}),e.jsxs("label",{htmlFor:o.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 flex items-center gap-2 cursor-pointer",children:[e.jsx(o.icon,{className:"h-4 w-4"}),o.label]})]},o.id))})]}),s==="hotels"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-3",children:"Property Type"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:i.map(o=>e.jsx(f,{variant:n.propertyTypes.includes(o)?"default":"outline",size:"sm",onClick:()=>k("propertyTypes",o),className:"text-xs","aria-pressed":n.propertyTypes.includes(o),children:o},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-3",children:"Accessibility Features"}),e.jsx("div",{className:"space-y-2",children:c.map(o=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{id:`accessibility-${o}`,checked:n.accessibility.includes(o),onCheckedChange:()=>k("accessibility",o)}),e.jsx("label",{htmlFor:`accessibility-${o}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:o})]},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-3",children:"Sustainability"}),e.jsx("div",{className:"space-y-2",children:p.map(o=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{id:`sustainability-${o}`,checked:n.sustainability.includes(o),onCheckedChange:()=>k("sustainability",o)}),e.jsx("label",{htmlFor:`sustainability-${o}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:o})]},o))})]})]})]})},Pe=({userPreferences:a={},searchContext:s={}})=>{const{t:r}=B();_();const n=[{id:"rec1",type:"personalized",title:"Zen Garden Resort",subtitle:"Perfect for spiritual retreats",location:"Ubud, Bali",price:180,originalPrice:240,rating:4.9,image:"https://images.unsplash.com/photo-1540541338287-41700207dee6?w=300&h=200&fit=crop&fm=webp&q=80",reasons:["Matches your spiritual travel preference","Highly rated meditation facilities","Similar to your previous bookings"],savings:"25% off",urgency:"3 rooms left at this price"},{id:"rec2",type:"trending",title:"Aurora Lodge",subtitle:"Trending destination",location:"Tromso, Norway",price:350,rating:4.8,image:"https://images.unsplash.com/photo-1483347756197-71ef80e95f73?w=300&h=200&fit=crop&fm=webp&q=80",reasons:["#1 trending destination this month","Perfect for Northern Lights viewing","Booking surge: +200%"],urgency:"Booking fast"},{id:"rec3",type:"deals",title:"Family Paradise Resort",subtitle:"Amazing deal",location:"Gold Coast, Australia",price:220,originalPrice:320,rating:4.7,image:"https://images.unsplash.com/photo-1566073771259-6a8506099945?w=300&h=200&fit=crop&fm=webp&q=80",reasons:["Kids stay free","Family-friendly amenities","Pool and beach access"],savings:"31% off",urgency:"Sale ends in 2 days"},{id:"rec4",type:"similar",title:"Urban Luxury Suites",subtitle:"Similar to your recent searches",location:"Tokyo, Japan",price:280,rating:4.6,image:"https://images.unsplash.com/photo-1564501049412-61c2a3083791?w=300&h=200&fit=crop&fm=webp&q=80",reasons:['Similar to "Tokyo hotels"',"Central location","Business traveler favorite"]}],d=l=>{switch(l){case"trending":return e.jsx(Ne,{className:"h-4 w-4"});case"personalized":return e.jsx(ve,{className:"h-4 w-4"});case"deals":return e.jsx(re,{className:"h-4 w-4"});case"similar":return e.jsx(E,{className:"h-4 w-4"});default:return e.jsx(E,{className:"h-4 w-4"})}},m=l=>{switch(l){case"trending":return"bg-orange-500";case"personalized":return"bg-pink-500";case"deals":return"bg-green-500";case"similar":return"bg-blue-500";default:return"bg-gray-500"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(E,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-xl font-semibold",children:"Smart Recommendations"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map((l,t)=>e.jsxs(w,{className:"travel-card overflow-hidden group cursor-pointer animate-fadeIn",style:{animationDelay:`${t*.1}s`},role:"article","aria-labelledby":`rec-title-${l.id}`,children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx("img",{src:l.image,alt:l.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),e.jsx("div",{className:"absolute top-3 left-3",children:e.jsxs(I,{className:`${m(l.type)} text-white flex items-center gap-1`,children:[d(l.type),l.type.charAt(0).toUpperCase()+l.type.slice(1)]})}),l.savings&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx(I,{variant:"secondary",className:"bg-green-500 text-white",children:l.savings})}),l.urgency&&e.jsx("div",{className:"absolute bottom-3 left-3 right-3",children:e.jsx(I,{variant:"destructive",className:"w-full justify-center",children:l.urgency})})]}),e.jsxs(S,{className:"p-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{id:`rec-title-${l.id}`,className:"font-bold text-lg leading-tight",children:l.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.subtitle}),e.jsxs("div",{className:"flex items-center text-muted-foreground text-sm mt-1",children:[e.jsx(F,{className:"h-4 w-4 mr-1"}),e.jsx("span",{children:l.location})]})]}),e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(z,{className:"h-4 w-4 text-yellow-400 fill-yellow-400"}),e.jsx("span",{className:"ml-1 font-semibold",children:l.rating})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Why we recommend this:"}),e.jsx("ul",{className:"space-y-1",children:l.reasons.slice(0,2).map((i,c)=>e.jsxs("li",{className:"text-xs text-foreground flex items-center",children:[e.jsx("span",{className:"w-1 h-1 bg-primary rounded-full mr-2"}),i]},c))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-xl font-bold",children:["$",l.price]}),l.originalPrice&&e.jsxs("span",{className:"text-sm text-muted-foreground line-through",children:["$",l.originalPrice]})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"per night"})]}),e.jsx(f,{size:"sm",className:"btn-primary",children:r("common.view")})]})]})]},l.id))})]})},b=class b{constructor(){T(this,"errorQueue",[]);T(this,"isProcessing",!1)}static getInstance(){return b.instance||(b.instance=new b),b.instance}async reportError({error:s,context:r={},severity:n="medium"}){const d=q({error:s.message,stack:s.stack,name:s.name,severity:n,timestamp:new Date().toISOString(),userAgent:typeof window<"u"?navigator.userAgent:"server",url:typeof window<"u"?window.location.href:"unknown",...r});g.error("Error reported:",d);try{await A.functions.invoke("enhanced-logging",{body:{logs:[{service_name:r.section||"frontend",log_level:n==="critical"||n==="high"?"error":"warn",message:`${s.name}: ${s.message}`,metadata:{error_id:d.correlationId,context:r,userAgent:d.userAgent,url:d.url},error_details:{name:s.name,message:s.message,stack:s.stack},user_id:r.userId,request_id:d.correlationId}]},headers:{"X-Correlation-ID":d.correlationId}})}catch(m){g.error("Enhanced logging failed:",m)}return this.errorQueue.push({error:s,context:{...r,correlationId:d.correlationId},severity:n}),this.isProcessing||this.processErrorQueue(),this.reportToSentry(s,d,n),await this.storeCorrelationData(d),d.correlationId}async processErrorQueue(){if(this.errorQueue.length!==0){this.isProcessing=!0;try{for(;this.errorQueue.length>0;){const s=this.errorQueue.shift();s&&await this.processErrorReport(s)}}catch(s){g.error("Error processing error queue:",s)}finally{this.isProcessing=!1}}}async processErrorReport(s){var r;g.info("Processing error report:",{correlationId:(r=s.context)==null?void 0:r.correlationId,severity:s.severity})}reportToSentry(s,r,n){if(typeof window<"u"&&window.Sentry){const d=window.Sentry;d.withScope(m=>{m.setTag("correlationId",r.correlationId),m.setTag("severity",n),r.section&&m.setTag("section",r.section),r.userId&&m.setUser({id:r.userId}),m.setContext("errorDetails",{correlationId:r.correlationId,timestamp:r.timestamp,url:r.url,userAgent:r.userAgent});const l=n==="critical"?"fatal":n==="high"?"error":n==="medium"?"warning":"info";m.setLevel(l),d.captureException(s)})}}async storeCorrelationData(s){try{await A.from("correlation_tracking").insert({correlation_id:s.correlationId,request_type:"error_report",request_data:{error:s.error,section:s.section,severity:s.severity,url:s.url,userAgent:s.userAgent},status:"error",user_id:s.userId||null})}catch(r){g.error("Failed to store correlation data:",r)}}async trackPerformance(s,r,n={}){const d=q({operation:s,duration:r,timestamp:new Date().toISOString(),...n});g.info("Performance tracked:",d);try{await A.from("correlation_tracking").insert({correlation_id:d.correlationId,request_type:"performance_tracking",request_data:{operation:s,duration:r,...n},status:"completed",duration_ms:r})}catch(m){g.error("Failed to store performance data:",m)}return d.correlationId}async trackUserAction(s,r={}){const n=q({action:s,timestamp:new Date().toISOString(),...r});return g.info("User action tracked:",n),typeof window<"u"&&window.Sentry&&window.Sentry.addBreadcrumb({message:s,category:"user-action",level:"info",data:{correlationId:n.correlationId,...r}}),n.correlationId}};T(b,"instance");let U=b;const De=U.getInstance(),Z=(a,s,r)=>De.trackPerformance(a,s,r),Re=a=>{const s=u.useRef(Date.now()),[r,n]=u.useState({renderTime:0});return u.useEffect(()=>{var t;const m=Date.now()-s.current;Z(`${a}_render`,m,{component:a,timestamp:new Date().toISOString()});const l=(t=performance.memory)==null?void 0:t.usedJSHeapSize;n(i=>({...i,renderTime:m,memoryUsage:l}))},[a]),{metrics:r,measureInteraction:m=>{const l=Date.now();return()=>{const i=Date.now()-l;Z(`${a}_${m}`,i,{component:a,interaction:m,timestamp:new Date().toISOString()}),n(c=>({...c,interactionDelay:i}))}}}},P={isSearchReady:!1,searchParams:null,results:null,loading:!1,error:null,provider:"amadeus",source:"api",timestamp:null},Te=()=>{const[a,s]=u.useState(P),{toast:r}=L(),n=u.useCallback(t=>{const i=[],c=[];return t.origin||i.push("Origin airport is required"),t.destination||i.push("Destination airport is required"),t.departureDate||i.push("Departure date is required"),t.adults&&t.adults<1&&i.push("At least 1 adult passenger is required"),t.returnDate&&new Date(t.returnDate)<=new Date(t.departureDate)&&i.push("Return date must be after departure date"),{isValid:i.length===0,errors:i,warnings:c}},[]),d=u.useCallback(t=>{const i=n(t);return i.isValid?(s(c=>({...c,searchParams:t,isSearchReady:!0,error:null,results:null})),i.warnings.length>0?r({title:"Search ready with notes",description:i.warnings.join(", "),variant:"default"}):r({title:"Flight search prepared",description:"Click 'Search Flights' to get results",variant:"default"}),!0):(s(c=>({...c,error:i.errors.join(", "),searchParams:null,isSearchReady:!1})),r({title:"Search validation failed",description:i.errors.join(", "),variant:"destructive"}),!1)},[n,r]),m=u.useCallback(async()=>{var t,i;if(!a.searchParams||!a.isSearchReady){r({title:"No search prepared",description:"Please prepare your search first",variant:"destructive"});return}s(c=>({...c,loading:!0,error:null}));try{const{data:c,error:p}=await A.functions.invoke("provider-rotation",{body:{searchType:"flight",params:{originLocationCode:(t=a.searchParams.origin)==null?void 0:t.toUpperCase(),destinationLocationCode:(i=a.searchParams.destination)==null?void 0:i.toUpperCase(),departureDate:a.searchParams.departureDate,returnDate:a.searchParams.returnDate,adults:a.searchParams.adults||1,children:a.searchParams.children||0,infants:a.searchParams.infants||0,travelClass:"ECONOMY",currency:"AUD"}}});if(p)throw p;if(c!=null&&c.success&&(c!=null&&c.flights))s(y=>({...y,results:c.flights,source:c.source||"api",provider:c.provider||"amadeus",timestamp:new Date().toISOString(),loading:!1})),r({title:"Flight search completed",description:`Found ${c.flights.length} flights via Amadeus`});else throw new Error((c==null?void 0:c.error)||"No flights found")}catch(c){const p=c.message||"Flight search failed";s(y=>({...y,error:p,loading:!1})),g.error("Flight search error:",c),r({title:"Search failed",description:p,variant:"destructive"})}},[a.searchParams,a.isSearchReady,r]),l=u.useCallback(()=>{s(P)},[]);return{...a,prepareSearch:d,executeSearch:m,clearSearch:l,validateSearch:n}},Me=()=>{const[a,s]=u.useState(P),{toast:r}=L(),n=u.useCallback(t=>{const i=[],c=[];return!t.destination&&!t.cityCode&&i.push("Destination is required"),t.checkIn||i.push("Check-in date is required"),t.checkOut||i.push("Check-out date is required"),t.guests&&t.guests<1&&i.push("At least 1 guest is required"),t.checkIn&&t.checkOut&&new Date(t.checkOut)<=new Date(t.checkIn)&&i.push("Check-out date must be after check-in date"),{isValid:i.length===0,errors:i,warnings:c}},[]),d=u.useCallback(t=>{const i=n(t);return i.isValid?(s(c=>({...c,searchParams:t,isSearchReady:!0,error:null,results:null})),r({title:"Hotel search prepared",description:"Click 'Search Hotels' to get results",variant:"default"}),!0):(s(c=>({...c,error:i.errors.join(", "),searchParams:null,isSearchReady:!1})),r({title:"Search validation failed",description:i.errors.join(", "),variant:"destructive"}),!1)},[n,r]),m=u.useCallback(async()=>{if(!a.searchParams||!a.isSearchReady){r({title:"No search prepared",description:"Please prepare your search first",variant:"destructive"});return}s(t=>({...t,loading:!0,error:null}));try{const{data:t,error:i}=await A.functions.invoke("provider-rotation",{body:{searchType:"hotel",params:{destination:a.searchParams.destination||a.searchParams.cityCode,checkIn:a.searchParams.checkIn,checkOut:a.searchParams.checkOut,adults:a.searchParams.adults||2,children:a.searchParams.children||0,rooms:a.searchParams.rooms||1,currency:"AUD"}}});if(i)throw i;if(t!=null&&t.success&&(t!=null&&t.hotels))s(c=>({...c,results:t.hotels,source:t.source||"api",provider:t.provider||"amadeus",timestamp:new Date().toISOString(),loading:!1})),r({title:"Hotel search completed",description:`Found ${t.hotels.length} hotels via Amadeus`});else throw new Error((t==null?void 0:t.error)||"No hotels found")}catch(t){const i=t.message||"Hotel search failed";s(c=>({...c,error:i,loading:!1})),g.error("Hotel search error:",t),r({title:"Search failed",description:i,variant:"destructive"})}},[a.searchParams,a.isSearchReady,r]),l=u.useCallback(()=>{s(P)},[]);return{...a,prepareSearch:d,executeSearch:m,clearSearch:l,validateSearch:n}},Fe=()=>{const[a,s]=u.useState(P),{toast:r}=L(),n=u.useCallback(t=>{const i=[],c=[];return!t.destination&&!t.cityCode&&i.push("Destination is required"),{isValid:i.length===0,errors:i,warnings:c}},[]),d=u.useCallback(t=>{const i=n(t);return i.isValid?(s(c=>({...c,searchParams:t,isSearchReady:!0,error:null,results:null})),r({title:"Activity search prepared",description:"Click 'Search Activities' to get results",variant:"default"}),!0):(s(c=>({...c,error:i.errors.join(", "),searchParams:null,isSearchReady:!1})),r({title:"Search validation failed",description:i.errors.join(", "),variant:"destructive"}),!1)},[n,r]),m=u.useCallback(async()=>{if(!a.searchParams||!a.isSearchReady){r({title:"No search prepared",description:"Please prepare your search first",variant:"destructive"});return}s(t=>({...t,loading:!0,error:null}));try{const{data:t,error:i}=await A.functions.invoke("provider-rotation",{body:{searchType:"activity",params:{destination:a.searchParams.destination||a.searchParams.cityCode,dateFrom:a.searchParams.checkIn,dateTo:a.searchParams.checkOut,currency:"AUD"}}});if(i)throw i;if(t!=null&&t.success&&(t!=null&&t.data))s(c=>({...c,results:t.data,source:t.source||"api",provider:t.provider||"amadeus",timestamp:new Date().toISOString(),loading:!1})),r({title:"Activity search completed",description:`Found ${t.data.length} activities via Amadeus`});else throw new Error((t==null?void 0:t.error)||"No activities found")}catch(t){const i=t.message||"Activity search failed";s(c=>({...c,error:i,loading:!1})),g.error("Activity search error:",t),r({title:"Search failed",description:i,variant:"destructive"})}},[a.searchParams,a.isSearchReady,r]),l=u.useCallback(()=>{s(P)},[]);return{...a,prepareSearch:d,executeSearch:m,clearSearch:l,validateSearch:n}},$e=({searchType:a,searchParams:s,isReady:r,className:n=""})=>{if(!s||!r)return null;const d=()=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:s.origin}),e.jsx("span",{className:"text-muted-foreground",children:"â†’"}),e.jsx("span",{className:"font-medium",children:s.destination})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Departure"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:C(new Date(s.departureDate),"MMM dd, yyyy")})]})]}),s.returnDate&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Return"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:C(new Date(s.returnDate),"MMM dd, yyyy")})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:[s.adults||1," adult",(s.adults||1)>1?"s":"",s.children>0&&`, ${s.children} child${s.children>1?"ren":""}`,s.infants>0&&`, ${s.infants} infant${s.infants>1?"s":""}`]})]})]}),m=()=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:s.destination||s.cityCode})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Check-in"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:C(new Date(s.checkIn),"MMM dd, yyyy")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Check-out"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:C(new Date(s.checkOut),"MMM dd, yyyy")})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:[s.adults||2," guest",(s.adults||2)>1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:[s.rooms||1," room",(s.rooms||1)>1?"s":""]})]})]})]}),l=()=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:s.destination||s.cityCode})]}),(s.checkIn||s.checkOut)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:[s.checkIn&&C(new Date(s.checkIn),"MMM dd"),s.checkIn&&s.checkOut&&" - ",s.checkOut&&C(new Date(s.checkOut),"MMM dd, yyyy")]})]})]}),t=()=>{switch(a){case"flight":return d();case"hotel":return m();case"activity":return l();default:return null}},i=()=>`${{flight:"Flight",hotel:"Hotel",activity:"Activity",flights:"Flight",hotels:"Hotel",activities:"Activity"}[a]||a.charAt(0).toUpperCase()+a.slice(1)} search ready`;return e.jsxs(w,{className:`border-success/20 bg-success/5 ${n}`,children:[e.jsx(ee,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(se,{className:"text-base font-medium",children:i()}),e.jsx(I,{variant:"default",className:"bg-success/10 text-success border-success/20",children:"Ready to search"})]})}),e.jsx(S,{className:"pt-0",children:t()})]})},Oe=({provider:a,status:s,className:r=""})=>{const d=(()=>{switch(s){case"healthy":return{icon:e.jsx(Y,{className:"w-3 h-3"}),text:`Powered by ${a}`,variant:"default",className:"bg-success/10 text-success border-success/20"};case"degraded":return{icon:e.jsx(Ce,{className:"w-3 h-3"}),text:`${a} (Limited)`,variant:"secondary",className:"bg-warning/10 text-warning border-warning/20"};case"disabled":return{icon:e.jsx(ke,{className:"w-3 h-3"}),text:`${a} Unavailable`,variant:"destructive",className:"bg-destructive/10 text-destructive border-destructive/20"};default:return{icon:e.jsx(Y,{className:"w-3 h-3"}),text:`Powered by ${a}`,variant:"default",className:"bg-success/10 text-success border-success/20"}}})();return e.jsxs(I,{variant:d.variant,className:`${d.className} ${r} flex items-center gap-1 text-xs`,children:[d.icon,d.text]})},ae=()=>e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(Oe,{provider:"Amadeus",status:"healthy"})}),Ee=({searchType:a,isReady:s,isLoading:r,onExecute:n,disabled:d=!1,className:m=""})=>{const l=()=>{const c={flight:"flights",hotel:"hotels",activity:"activities",flights:"flights",hotels:"hotels",activities:"activities"}[a]||a;return r?`Searching ${c}...`:s?`Search ${c}`:`Prepare ${c} search`},t=()=>r?e.jsx(de,{className:"w-4 h-4 animate-spin"}):e.jsx(H,{className:"w-4 h-4"});return e.jsxs("div",{className:"space-y-3",children:[e.jsxs(f,{onClick:n,disabled:!s||r||d,className:`w-full h-12 text-base font-medium ${m}`,size:"lg",children:[t(),l()]}),s&&!r&&e.jsx("div",{className:"flex justify-center",children:e.jsx(ae,{})})]})},Ds=()=>{const{t:a}=B(),[s]=me();Re("UnifiedSearchPage"),_({announceChanges:!0});const[r,n]=u.useState(s.get("q")||""),d=["all","hotels","flights","activities","cars"],m=x=>d.includes(x),l=s.get("type"),[t,i]=u.useState(l&&m(l)?l:"all"),[c,p]=u.useState("grid"),[y,k]=u.useState("relevance"),[R,D]=u.useState(!1),o=Te(),N=Me(),j=Fe(),h=(()=>{switch(t){case"flights":return o;case"hotels":return N;case"activities":return j;default:return null}})(),ie=()=>{const x={flights:{origin:"SYD",destination:"MEL",departureDate:"2025-09-15",adults:1},hotels:{destination:"Sydney",checkIn:"2025-09-15",checkOut:"2025-09-17",adults:2,rooms:1},activities:{destination:"Sydney",checkIn:"2025-09-15",checkOut:"2025-09-17"}};t==="flights"?o.prepareSearch(x.flights):t==="hotels"?N.prepareSearch(x.hotels):t==="activities"&&j.prepareSearch(x.activities)};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(xe,{}),e.jsx("main",{className:"pt-24 pb-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-4xl font-bold mb-4 font-['Playfair_Display']",children:[a("common.search")," ",e.jsx("span",{className:"hero-text",children:"Results"})]}),e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(H,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(ue,{placeholder:a("hero.searchPlaceholder"),value:r,onChange:x=>n(x.target.value),className:"pl-10"})]}),e.jsxs(Q,{value:t,onValueChange:x=>i(x),children:[e.jsx(W,{className:"w-48",children:e.jsx(G,{})}),e.jsxs(J,{children:[e.jsx(v,{value:"all",children:"All Results"}),e.jsx(v,{value:"hotels",children:a("navigation.hotels")}),e.jsx(v,{value:"flights",children:a("navigation.flights")}),e.jsx(v,{value:"activities",children:a("navigation.activities")}),e.jsx(v,{value:"cars",children:a("navigation.cars")})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(f,{variant:"outline",onClick:()=>D(!R),className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"Filters"]}),e.jsxs(Q,{value:y,onValueChange:k,children:[e.jsx(W,{className:"w-48",children:e.jsx(G,{})}),e.jsxs(J,{children:[e.jsx(v,{value:"relevance",children:"Most Relevant"}),e.jsx(v,{value:"price-low",children:"Price: Low to High"}),e.jsx(v,{value:"price-high",children:"Price: High to Low"}),e.jsx(v,{value:"rating",children:"Highest Rated"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{variant:c==="grid"?"default":"outline",size:"sm",onClick:()=>p("grid"),children:e.jsx(Se,{className:"h-4 w-4"})}),e.jsx(f,{variant:c==="list"?"default":"outline",size:"sm",onClick:()=>p("list"),children:e.jsx(Ie,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"flex gap-6",children:[R&&e.jsx("div",{className:"w-80 flex-shrink-0",children:e.jsx(Ae,{searchType:t==="all"?"hotels":t,onFiltersChange:()=>{}})}),e.jsx("div",{className:"flex-1",children:e.jsxs(he,{defaultValue:"results",className:"w-full",children:[e.jsxs(pe,{className:"mb-6",children:[e.jsx(K,{value:"results",children:"Search Results"}),e.jsx(K,{value:"recommendations",children:"Recommendations"})]}),e.jsx(X,{value:"results",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(ae,{})}),t!=="all"&&t!=="cars"&&e.jsx(w,{className:"p-6",children:e.jsx(S,{children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Test ",t," Search"]}),e.jsx("p",{className:"text-muted-foreground",children:"Prepare a demo search to test the new lazy loading system"}),e.jsx(f,{onClick:ie,variant:"outline",children:"Prepare Demo Search"})]})})}),(h==null?void 0:h.isSearchReady)&&e.jsx($e,{searchType:t,searchParams:h.searchParams,isReady:h.isSearchReady}),h&&e.jsx(Ee,{searchType:t,isReady:h.isSearchReady,isLoading:h.loading,onExecute:h.executeSearch}),(h==null?void 0:h.results)&&h.results.length>0&&e.jsx(w,{children:e.jsxs(S,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Search Results (",h.results.length," found)"]}),e.jsx("div",{className:"space-y-4",children:h.results.slice(0,5).map((x,ne)=>e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("pre",{className:"text-sm text-muted-foreground overflow-x-auto",children:[JSON.stringify(x,null,2).substring(0,200),"..."]})},ne))})]})}),(h==null?void 0:h.error)&&e.jsx(w,{className:"border-destructive",children:e.jsxs(S,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Search Error"}),e.jsx("p",{className:"text-muted-foreground",children:h.error})]})}),!h&&e.jsx(w,{className:"text-center p-12",children:e.jsxs(S,{children:[e.jsx(H,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Advanced Search Ready"}),e.jsx("p",{className:"text-muted-foreground",children:"Select flights, hotels, or activities to start searching. APIs are now optimized with Amadeus as the primary provider."})]})})]})}),e.jsx(X,{value:"recommendations",children:e.jsx(Pe,{})})]})})]})]})})]})};export{Ds as default};
