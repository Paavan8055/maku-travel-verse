import{h as y,i as v,r as o,j as e,a as w,f as N,g as A,k as S,e as L,B as k,s as c,l as b,n as C,N as x}from"./index-BienadRX-1758298210899.js";import{I as g}from"./input-D_CWKZY2-1758298210899.js";import{L as j}from"./label-DD-bAk-H-1758298210899.js";import{S as E}from"./shield-CER-1Pvb-1758298210899.js";import{M as I}from"./mail-B57-zPyD-1758298210899.js";import{L as D}from"./lock-BDXdVJ4e-1758298210899.js";import{L as F}from"./LoginForm-BUahk867-1758298210899.js";import"./separator-DVtTFL3--1758298210899.js";import"./github-DxmmMrvC-1758298210899.js";const T=({onSwitchToRegular:i})=>{const{signIn:m}=y(),{toast:r}=v(),[d,n]=o.useState(!1),[s,u]=o.useState({email:"",password:""}),p=async t=>{t.preventDefault(),n(!0);try{const{error:a}=await m(s.email,s.password);if(a){r({title:"Admin Sign In Error",description:a.message,variant:"destructive"});return}const{data:h,error:l}=await c.rpc("get_admin_status");if(l){b.error("Admin status check failed:",l),await c.auth.signOut(),r({title:"Security Error",description:"Unable to verify admin status. Please try again.",variant:"destructive"});return}if(!h){await c.auth.signOut(),r({title:"Access Denied",description:"You don't have admin privileges.",variant:"destructive"});return}r({title:"Admin Access Granted",description:"Welcome to the admin dashboard."})}catch{r({title:"Error",description:"An unexpected error occurred",variant:"destructive"})}finally{n(!1)}};return e.jsxs(w,{className:"w-full max-w-md mx-auto border-none shadow-2xl bg-card/80 backdrop-blur-sm",children:[e.jsxs(N,{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(E,{className:"w-6 h-6 text-primary"})}),e.jsx(A,{className:"text-2xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"Admin Access"}),e.jsx(S,{className:"text-muted-foreground",children:"Sign in to the administrative dashboard"})]}),e.jsxs(L,{className:"space-y-6",children:[e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"admin-email",children:"Admin Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(g,{id:"admin-email",type:"email",placeholder:"admin@maku.travel",value:s.email,onChange:t=>u(a=>({...a,email:t.target.value})),className:"pl-10",required:!0,"aria-label":"Admin email address"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"admin-password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(g,{id:"admin-password",type:"password",placeholder:"••••••••",value:s.password,onChange:t=>u(a=>({...a,password:t.target.value})),className:"pl-10",required:!0,"aria-label":"Password"})]})]}),e.jsx(k,{type:"submit",className:"w-full h-11 bg-gradient-to-r from-primary to-secondary hover:opacity-90 transition-all duration-200",disabled:d,children:d?"Signing In...":"Access Admin Dashboard"})]}),e.jsxs("div",{className:"text-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Not an admin? "}),e.jsx("button",{type:"button",className:"text-primary hover:underline font-medium",onClick:i,children:"Regular sign in"})]})]})]})},H=()=>{var t,a;const{user:i,loading:m}=y(),[r,d]=o.useState(!0),[n,s]=o.useState(null),p=((a=(t=C().state)==null?void 0:t.from)==null?void 0:a.pathname)||"/admin/dashboard";return o.useEffect(()=>{(async()=>{if(i){const{data:l,error:f}=await c.rpc("get_admin_status");f?(b.error("Admin status check failed:",f),s(!1)):s(!!l)}else s(null)})()},[i]),m?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 to-secondary/5",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i&&n?e.jsx(x,{to:p,replace:!0}):i&&n===!1?e.jsx(x,{to:"/auth",replace:!0}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/5 to-secondary/5 p-4",children:e.jsx("div",{className:"w-full max-w-md",children:r?e.jsx(T,{onSwitchToRegular:()=>d(!1)}):e.jsx(F,{onSwitchToSignUp:()=>{}})})})};export{H as default};
