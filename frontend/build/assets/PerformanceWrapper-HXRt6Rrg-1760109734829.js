import{c as K,r as u,h as P,s as I,l as p,j as s,t as $,L as H,B as O}from"./index-Cmnr9LP--1760109734829.js";import{I as T}from"./input-CvRviaNF-1760109734829.js";import{M as B}from"./map-pin-C4oG_6Pe-1760109734829.js";import{u as G}from"./usePerformanceOptimizer-D5_2SrpS-1760109734829.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=K("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]),W=[{iata:"SYD",name:"Kingsford Smith",city:"Sydney",country:"Australia"},{iata:"MEL",name:"Tullamarine",city:"Melbourne",country:"Australia"},{iata:"BNE",name:"Brisbane",city:"Brisbane",country:"Australia"},{iata:"AKL",name:"Auckland",city:"Auckland",country:"New Zealand"},{iata:"LAX",name:"Los Angeles International",city:"Los Angeles",country:"United States"},{iata:"SFO",name:"San Francisco International",city:"San Francisco",country:"United States"},{iata:"JFK",name:"John F. Kennedy International",city:"New York",country:"United States"},{iata:"EWR",name:"Newark Liberty International",city:"Newark",country:"United States"},{iata:"BOS",name:"Logan International",city:"Boston",country:"United States"},{iata:"ORD",name:"O'Hare International",city:"Chicago",country:"United States"},{iata:"DFW",name:"Dallas/Fort Worth International",city:"Dallas-Fort Worth",country:"United States"},{iata:"ATL",name:"Hartsfieldâ€“Jackson Atlanta International",city:"Atlanta",country:"United States"},{iata:"MIA",name:"Miami International",city:"Miami",country:"United States"},{iata:"SEA",name:"Seattleâ€“Tacoma International",city:"Seattle",country:"United States"},{iata:"DEN",name:"Denver International",city:"Denver",country:"United States"},{iata:"LAS",name:"Harry Reid International",city:"Las Vegas",country:"United States"},{iata:"PHX",name:"Phoenix Sky Harbor",city:"Phoenix",country:"United States"},{iata:"HNL",name:"Daniel K. Inouye International",city:"Honolulu",country:"United States"},{iata:"LHR",name:"Heathrow",city:"London",country:"United Kingdom"},{iata:"LGW",name:"Gatwick",city:"London",country:"United Kingdom"},{iata:"MAN",name:"Manchester",city:"Manchester",country:"United Kingdom"},{iata:"CDG",name:"Charles de Gaulle",city:"Paris",country:"France"},{iata:"ORY",name:"Orly",city:"Paris",country:"France"},{iata:"AMS",name:"Schiphol",city:"Amsterdam",country:"Netherlands"},{iata:"FRA",name:"Frankfurt",city:"Frankfurt",country:"Germany"},{iata:"MUC",name:"Munich",city:"Munich",country:"Germany"},{iata:"ZRH",name:"Zurich",city:"Zurich",country:"Switzerland"},{iata:"MAD",name:"Adolfo SuÃ¡rez Madridâ€“Barajas",city:"Madrid",country:"Spain"},{iata:"BCN",name:"Barcelonaâ€“El Prat",city:"Barcelona",country:"Spain"},{iata:"FCO",name:"Leonardo da Vinciâ€“Fiumicino",city:"Rome",country:"Italy"},{iata:"VCE",name:"Venice Marco Polo",city:"Venice",country:"Italy"},{iata:"DOH",name:"Hamad International",city:"Doha",country:"Qatar"},{iata:"DXB",name:"Dubai International",city:"Dubai",country:"United Arab Emirates"},{iata:"AUH",name:"Abu Dhabi International",city:"Abu Dhabi",country:"United Arab Emirates"},{iata:"SIN",name:"Changi",city:"Singapore",country:"Singapore"},{iata:"HKG",name:"Hong Kong International",city:"Hong Kong",country:"Hong Kong"},{iata:"NRT",name:"Narita",city:"Tokyo",country:"Japan"},{iata:"HND",name:"Haneda",city:"Tokyo",country:"Japan"},{iata:"KIX",name:"Kansai International",city:"Osaka",country:"Japan"},{iata:"ICN",name:"Incheon International",city:"Seoul",country:"South Korea"},{iata:"BKK",name:"Suvarnabhumi",city:"Bangkok",country:"Thailand"},{iata:"KUL",name:"Kuala Lumpur International",city:"Kuala Lumpur",country:"Malaysia"},{iata:"DEL",name:"Indira Gandhi International",city:"Delhi",country:"India"},{iata:"BOM",name:"Chhatrapati Shivaji Maharaj",city:"Mumbai",country:"India"},{iata:"JNB",name:"O. R. Tambo International",city:"Johannesburg",country:"South Africa"},{iata:"CPT",name:"Cape Town International",city:"Cape Town",country:"South Africa"}],z=()=>{const[y,g]=u.useState(!1),{toast:f}=P();return{searchDestinations:u.useCallback(async(m,h=10)=>{var w;if(!m||m.length<2)return{success:!0,suggestions:[]};g(!0),console.log("ðŸ¨ HotelBeds autocomplete query:",m);try{const{data:i,error:L}=await I.functions.invoke("hotelbeds-autocomplete",{body:{query:m,limit:h}});if(console.log("ðŸ¨ HotelBeds autocomplete response:",{hasData:!!i,hasError:!!L,suggestions:(w=i==null?void 0:i.suggestions)==null?void 0:w.length}),L)throw new Error(L.message);return i!=null&&i.success&&Array.isArray(i.suggestions)?{success:!0,suggestions:i.suggestions.map(d=>({id:d.code||d.id,name:d.name,type:d.type||"city",code:d.code,country:d.country,displayName:d.displayName||d.name}))}:{success:!1,suggestions:[],error:"Invalid response format"}}catch(i){return p.error("HotelBeds autocomplete failed:",i),f({title:"Search Error",description:"Unable to fetch HotelBeds destinations. Please try again.",variant:"destructive"}),{success:!1,suggestions:[],error:i instanceof Error?i.message:"Unknown error"}}finally{g(!1)}},[f]),isLoading:y}},q=({value:y,onChange:g,onDestinationSelect:f,placeholder:S="Where to?",className:m,searchType:h="city"})=>{const[w,i]=u.useState([]),[L,N]=u.useState(!1),[d,C]=u.useState(!1),[k,D]=u.useState(!1),A=u.useRef(null),x=u.useRef(null),R=u.useRef(null),{searchDestinations:U}=z(),v=[{id:"syd",name:"Sydney",country:"Australia",type:"city"},{id:"mel",name:"Melbourne",country:"Australia",type:"city"},{id:"bri",name:"Brisbane",country:"Australia",type:"city"},{id:"per",name:"Perth",country:"Australia",type:"city"},{id:"nyc",name:"New York",country:"United States",type:"city"},{id:"lon",name:"London",country:"United Kingdom",type:"city"},{id:"par",name:"Paris",country:"France",type:"city"},{id:"tok",name:"Tokyo",country:"Japan",type:"city"}],E=e=>{const o=e.toLowerCase().trim();return W.filter(a=>{const n=a.name.toLowerCase().includes(o),c=a.city.toLowerCase().includes(o),t=a.iata.toLowerCase().includes(o),l=new RegExp(`${a.city.toLowerCase()}.*\\(${a.iata.toLowerCase()}\\)`).test(o),b=o===a.iata.toLowerCase();return n||c||t||l||b}).slice(0,8).map(a=>({id:a.iata,name:a.name,city:a.city,country:a.country,code:a.iata,type:"airport",coordinates:{lat:0,lng:0}}))};u.useEffect(()=>((async()=>{if(!y||y.length<2){i([]);return}A.current&&clearTimeout(A.current),A.current=setTimeout(async()=>{N(!0);const o=y.trim();let a=[];try{if(h==="hotel"){try{const n=await U(o,6);n.success&&n.suggestions.length>0&&(a=[...n.suggestions.map(t=>({id:t.id,name:t.name,city:t.name,country:t.country||"",code:t.code||t.id,type:t.type==="hotel"?"hotel":"city",coordinates:{lat:0,lng:0},displayName:t.displayName}))],console.log("Found HotelBeds results:",a.length))}catch(n){p.warn("HotelBeds search failed, trying Amadeus:",n)}if(a.length<3)try{const{data:n}=await I.functions.invoke("amadeus-hotel-autocomplete",{body:{query:o,limit:8}});n!=null&&n.success&&n.suggestions&&Array.isArray(n.suggestions)&&(n.suggestions.map(t=>{var r,l;return{id:t.hotelId||t.id,name:t.name,city:((r=t.address)==null?void 0:r.cityName)||"",country:((l=t.address)==null?void 0:l.countryCode)||"",code:t.hotelId||t.id,type:"hotel",coordinates:t.geoCode?{lat:parseFloat(t.geoCode.latitude),lng:parseFloat(t.geoCode.longitude)}:{lat:0,lng:0}}}).forEach(t=>{a.some(l=>l.id===t.id||l.name.toLowerCase()===t.name.toLowerCase()&&l.city===t.city)||a.push(t)}),console.log("Added Amadeus hotel results, total:",a.length))}catch(n){p.warn("Amadeus hotel search failed:",n)}}if(h==="airport"){const n=E(o);if(n.length>0&&(console.log("Found local airports:",n.length),a=[...n]),a.length<3)try{const{data:c}=await I.functions.invoke("amadeus-locations-autocomplete",{body:{query:o,types:["AIRPORT"],limit:8}});c!=null&&c.results&&Array.isArray(c.results)&&c.results.map(r=>({id:r.id||r.code,name:r.name,city:r.city,country:r.country,code:r.code,type:"airport",coordinates:r.coordinates?{lat:r.coordinates[1],lng:r.coordinates[0]}:{lat:0,lng:0}})).forEach(r=>{a.some(b=>b.code===r.code||b.name.toLowerCase()===r.name.toLowerCase()&&b.city===r.city)||a.push(r)})}catch(c){p.warn("Amadeus airport search failed, using local results:",c)}}if((h==="city"||h==="both")&&a.length<3)try{const{data:n}=await I.functions.invoke("amadeus-locations-autocomplete",{body:{query:o,types:["CITY"],limit:8}});n!=null&&n.results&&Array.isArray(n.results)&&n.results.map(t=>({id:t.id,name:t.name,city:t.city,country:t.country,code:t.code,type:"city",coordinates:t.coordinates?{lat:t.coordinates[1],lng:t.coordinates[0]}:{lat:0,lng:0}})).forEach(t=>{a.some(l=>l.id===t.id||l.name.toLowerCase()===t.name.toLowerCase()&&l.city===t.city)||a.push(t)})}catch(n){p.warn("Amadeus city search failed:",n)}a.length===0&&(a=[...v.filter(c=>c.name.toLowerCase().includes(o.toLowerCase())||c.country.toLowerCase().includes(o.toLowerCase())).slice(0,5)]),i(a.slice(0,8))}catch(n){if(p.error("Error fetching suggestions:",n),h==="airport"){const c=E(o);i(c)}else i([])}finally{N(!1)}},300)})(),()=>{A.current&&clearTimeout(A.current)}),[y,h]);const M=e=>{const o=e.type==="hotel"?"ðŸ¨":e.type==="airport"?"âœˆï¸":"ðŸ™ï¸";return e.type==="hotel"?`${o} ${e.name}${e.city?` â€” ${e.city}`:""}`:e.code&&e.code!==e.name?`${o} ${e.name} (${e.code})`:e.city&&e.city!==e.name?`${o} ${e.name}, ${e.city}`:`${o} ${e.name}`},j=e=>{var a;const o=M(e);g(o),f(e),C(!1),(a=x.current)==null||a.blur()},F=async()=>{D(!0);try{const e=await new Promise((a,n)=>{navigator.geolocation.getCurrentPosition(a,n)}),o={id:"current",name:"Current Location",country:"Your Area",type:"city",coordinates:{lat:e.coords.latitude,lng:e.coords.longitude}};f(o),g("Current Location"),C(!1)}catch(e){p.error("Error getting location:",e)}finally{D(!1)}};return u.useEffect(()=>{const e=o=>{var a;R.current&&!R.current.contains(o.target)&&!((a=x.current)!=null&&a.contains(o.target))&&C(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"relative",children:[s.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s.jsx(T,{ref:x,type:"text",placeholder:S,value:y,onChange:e=>g(e.target.value),onFocus:()=>{y.length>=2&&C(!0)},className:$("pl-10 pr-12",m)}),k&&s.jsx(H,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 animate-spin"}),h!=="hotel"&&s.jsx(O,{type:"button",variant:"ghost",size:"sm",onClick:F,disabled:k,className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-8 w-8 p-0",children:s.jsx(J,{className:"h-4 w-4"})})]}),d&&s.jsx("div",{ref:R,className:"absolute top-full left-0 right-0 mt-1 bg-background border border-border rounded-lg shadow-lg z-50 max-h-64 overflow-y-auto",children:L?s.jsxs("div",{className:"p-4 text-center",children:[s.jsx(H,{className:"h-4 w-4 animate-spin mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Searching destinations..."})]}):w.length>0?w.map((e,o)=>s.jsxs("button",{className:"w-full px-4 py-3 text-left hover:bg-accent/50 flex items-center gap-3 transition-colors",onClick:()=>j(e),children:[s.jsx(B,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium text-foreground truncate",children:M(e)}),e.country&&s.jsx("div",{className:"text-sm text-muted-foreground truncate",children:e.country})]})]},`${e.id}-${e.type}-${o}`)):s.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"No destinations found. Try a different search term."})})]})},Q=({children:y,componentName:g,enableMonitoring:f=!0})=>{const{startRender:S,endRender:m}=G({componentName:g,enableMonitoring:f,reportToAnalytics:!0});return u.useEffect(()=>(S(),()=>{m()}),[S,m]),s.jsx(s.Fragment,{children:y})};export{q as D,J as N,Q as P};
