import{j as e,B as D,R as L,a as n,d as r,e as i,b as l,f as o,s as M}from"./index-Dq_nR5Ff-1759933122431.js";import{T as P,a as R,b as j,c as u}from"./tabs-DDxIM2Do-1759933122431.js";import{u as B}from"./useQuery-l-DXYOLS-1759933122431.js";import{S as b}from"./search-Arty_OFn-1759933122431.js";import{T as w}from"./trending-up-8NwDTHBm-1759933122431.js";import{M as k}from"./map-pin-CXdknln7-1759933122431.js";import{U}from"./users-CC_Ry8Hn-1759933122431.js";import{C as _}from"./calendar-eJGRJjLP-1759933122431.js";const V=()=>{var p,g,y,N,v;const{data:s,isLoading:f,refetch:S}=B({queryKey:["admin-search-analytics"],queryFn:async()=>{const{data:t}=await M.from("search_audit").select("*").order("created_at",{ascending:!1}).limit(1e3),d=(t==null?void 0:t.length)||0,x=(t==null?void 0:t.filter(a=>a.product==="flight").length)||0,C=(t==null?void 0:t.filter(a=>a.product==="hotel").length)||0,T=(t==null?void 0:t.filter(a=>a.product==="activity").length)||0,A=t==null?void 0:t.reduce((a,h)=>{const c=h.params,m=(c==null?void 0:c.destination)||(c==null?void 0:c.city_iata);return m&&(a[m]=(a[m]||0)+1),a},{});return{totalSearches:d,flightSearches:x,hotelSearches:C,activitySearches:T,popularDestinations:Object.entries(A||{}).sort(([,a],[,h])=>h-a).slice(0,10)}},refetchInterval:3e4});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(b,{className:"h-8 w-8"}),"Search Analytics"]}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor search patterns and user behavior across all products"})]}),e.jsxs(D,{onClick:()=>S(),disabled:f,children:[e.jsx(L,{className:`h-4 w-4 mr-2 ${f?"animate-spin":""}`}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(n,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Total Searches"}),e.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((p=s==null?void 0:s.totalSearches)==null?void 0:p.toLocaleString())||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All products combined"})]})]}),e.jsxs(n,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Flight Searches"}),e.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((g=s==null?void 0:s.flightSearches)==null?void 0:g.toLocaleString())||0}),e.jsxs(o,{variant:"secondary",children:[s!=null&&s.totalSearches?Math.round(s.flightSearches/s.totalSearches*100):0,"%"]})]})]}),e.jsxs(n,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Hotel Searches"}),e.jsx(k,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((y=s==null?void 0:s.hotelSearches)==null?void 0:y.toLocaleString())||0}),e.jsxs(o,{variant:"secondary",children:[s!=null&&s.totalSearches?Math.round(s.hotelSearches/s.totalSearches*100):0,"%"]})]})]}),e.jsxs(n,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium",children:"Activity Searches"}),e.jsx(U,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((N=s==null?void 0:s.activitySearches)==null?void 0:N.toLocaleString())||0}),e.jsxs(o,{variant:"secondary",children:[s!=null&&s.totalSearches?Math.round(s.activitySearches/s.totalSearches*100):0,"%"]})]})]})]}),e.jsxs(P,{defaultValue:"destinations",className:"space-y-6",children:[e.jsxs(R,{children:[e.jsx(j,{value:"destinations",children:"Popular Destinations"}),e.jsx(j,{value:"patterns",children:"Search Patterns"}),e.jsx(j,{value:"conversion",children:"Conversion Rates"})]}),e.jsx(u,{value:"destinations",children:e.jsxs(n,{children:[e.jsx(r,{children:e.jsx(i,{children:"Top Destinations"})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-4",children:(v=s==null?void 0:s.popularDestinations)==null?void 0:v.map(([t,d],x)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{variant:"outline",children:x+1}),e.jsx("span",{className:"font-medium",children:t})]}),e.jsxs(o,{children:[d," searches"]})]},t))})})]})}),e.jsx(u,{value:"patterns",children:e.jsxs(n,{children:[e.jsx(r,{children:e.jsx(i,{children:"Search Patterns Analysis"})}),e.jsx(l,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Search Pattern Analytics"}),e.jsx("p",{className:"text-muted-foreground",children:"Detailed search pattern analysis coming soon"})]})})]})}),e.jsx(u,{value:"conversion",children:e.jsxs(n,{children:[e.jsx(r,{children:e.jsx(i,{children:"Search to Booking Conversion"})}),e.jsx(l,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Conversion Rate Analysis"}),e.jsx("p",{className:"text-muted-foreground",children:"Search-to-booking conversion analytics coming soon"})]})})]})})]})]})};export{V as default};
