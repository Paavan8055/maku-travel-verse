import{r as n,t as U,a2 as m,j as e,O as k,B as j,ac as P,I as z,a1 as O,k as g,n as _,o as I,m as x,p as M,l as f,M as $,d as H,x as J}from"./index-sjMrv3Ur-1758787615240.js";import{T as q,a as G,b as v,c as N}from"./tabs-O1Phtj_U-1758787615240.js";import{S as X,a as Y,b as K,c as Q,d as i}from"./select-_L-I_tXd-1758787615240.js";import{S as W}from"./search-DF0qoHZs-1758787615240.js";import{C as Z}from"./circle-x-CW2ABLsS-1758787615240.js";import{C as ee}from"./circle-check-big-8AA0xNe3-1758787615240.js";import{C as b}from"./clock-Di0Wnbwb-1758787615240.js";import{D as se}from"./dollar-sign-1iBj2j8--1758787615240.js";import"./index-BdQq_4o_-1758787615240.js";import"./index-Ds7e5B5O-1758787615240.js";const D={pending:b,running:P,completed:ee,cancelled:Z,failed:O},L={pending:"bg-muted text-muted-foreground",running:"bg-travel-sunset text-white animate-pulse",completed:"bg-travel-forest text-white",cancelled:"bg-muted text-muted-foreground",failed:"bg-destructive text-destructive-foreground"},xe=()=>{const[A,w]=n.useState([]),[B,E]=n.useState(!0),[c,R]=n.useState("all"),[l,V]=n.useState(""),[a,y]=n.useState(null),{toast:C}=U();n.useEffect(()=>{T(),F()},[]);const T=async()=>{try{const{data:{user:s}}=await m.auth.getUser();if(!s)return;const{data:r,error:t}=await m.from("agentic_tasks").select("*").eq("user_id",s.id).order("created_at",{ascending:!1});if(t)throw t;w(r||[])}catch(s){console.error("Error fetching tasks:",s),C({title:"Error loading tasks",description:"Failed to load your trip planning tasks",variant:"destructive"})}finally{E(!1)}},F=()=>{const s=m.channel("agentic-tasks-changes").on("postgres_changes",{event:"*",schema:"public",table:"agentic_tasks"},r=>{const t=r.new;t&&(w(p=>{const S=p.findIndex(o=>o.id===t.id);if(S>=0){const o=[...p];return o[S]=t,o}else return[t,...p]}),t.status==="completed"&&C({title:"Task Completed",description:`Your ${t.intent.replace("_"," ")} task has finished!`}))}).subscribe();return()=>{m.removeChannel(s)}},u=A.filter(s=>{const r=c==="all"||s.status===c,t=l===""||s.intent.toLowerCase().includes(l.toLowerCase())||s.agent_id.toLowerCase().includes(l.toLowerCase());return r&&t}),h=s=>({"trip-planner":"Trip Planner","price-monitor":"Price Monitor","booking-assistant":"Booking Assistant","itinerary-optimizer":"Itinerary Optimizer"})[s]||s.replace("-"," ").toUpperCase(),d=s=>new Date(s).toLocaleString();return B?e.jsxs("div",{className:"min-h-screen bg-background p-6",children:[e.jsxs(k,{children:[e.jsx("title",{children:"My Trips - Maku Travel"}),e.jsx("meta",{name:"description",content:"Track your travel planning tasks and trip bookings with Maku's AI agents"})]}),e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})})]}):e.jsxs("div",{className:"min-h-screen bg-background p-6",children:[e.jsxs(k,{children:[e.jsx("title",{children:"My Trips - Maku Travel"}),e.jsx("meta",{name:"description",content:"Track your travel planning tasks and trip bookings with Maku's AI agents"})]}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"My Trips & Tasks"}),e.jsx("p",{className:"text-muted-foreground",children:"Track your AI-powered travel planning and booking tasks"})]}),e.jsxs(j,{onClick:T,variant:"outline",className:"gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Refresh"]})]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(W,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(z,{placeholder:"Search tasks...",value:l,onChange:s=>V(s.target.value),className:"max-w-md pl-10"})]}),e.jsxs(X,{value:c,onValueChange:R,children:[e.jsx(Y,{className:"w-48",children:e.jsx(K,{placeholder:"Filter by status"})}),e.jsxs(Q,{children:[e.jsx(i,{value:"all",children:"All Tasks"}),e.jsx(i,{value:"pending",children:"Pending"}),e.jsx(i,{value:"running",children:"Running"}),e.jsx(i,{value:"completed",children:"Completed"}),e.jsx(i,{value:"cancelled",children:"Cancelled"}),e.jsx(i,{value:"failed",children:"Failed"})]})]})]}),e.jsxs(q,{defaultValue:"grid",className:"space-y-6",children:[e.jsxs(G,{children:[e.jsx(v,{value:"grid",children:"Grid View"}),e.jsx(v,{value:"list",children:"List View"}),e.jsx(v,{value:"detail",children:"Task Details"})]}),e.jsxs(N,{value:"grid",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(s=>{const r=D[s.status]||b;return e.jsxs(g,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>y(s),children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(I,{className:"text-lg flex items-center gap-2",children:[e.jsx(x,{className:"h-5 w-5"}),h(s.agent_id)]}),e.jsxs(M,{className:L[s.status],children:[e.jsx(r,{className:"h-3 w-3 mr-1"}),s.status]})]})}),e.jsx(f,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.intent.replace("_"," ").toUpperCase()}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Created: ",d(s.created_at)]})]}),s.status==="running"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[s.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${s.progress}%`}})})]}),s.params&&e.jsxs("div",{className:"text-sm space-y-1",children:[s.params.destination&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-3 w-3"}),e.jsx("span",{children:s.params.destination})]}),s.params.dates&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-3 w-3"}),e.jsx("span",{children:s.params.dates})]}),s.params.budget&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-3 w-3"}),e.jsxs("span",{children:["$",s.params.budget]})]})]}),(s.status==="pending"||s.status==="running")&&e.jsx(j,{variant:"outline",size:"sm",onClick:t=>{t.stopPropagation()},className:"w-full",children:"Cancel Task"})]})})]},s.id)})}),u.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(x,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No tasks found"}),e.jsx("p",{className:"text-muted-foreground",children:l||c!=="all"?"Try adjusting your filters or search terms":"Start planning your next trip to see tasks here"})]})]}),e.jsx(N,{value:"list",children:e.jsx("div",{className:"space-y-4",children:u.map(s=>{const r=D[s.status]||b;return e.jsx(g,{children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(x,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:h(s.agent_id)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.intent.replace("_"," ")})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(M,{className:L[s.status],children:[e.jsx(r,{className:"h-3 w-3 mr-1"}),s.status]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:d(s.created_at)}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>y(s),children:"View Details"})]})]})})},s.id)})})}),e.jsx(N,{value:"detail",children:a?e.jsxs(g,{children:[e.jsx(_,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-5 w-5"}),h(a.agent_id)," - Task Details"]})}),e.jsxs(f,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Task Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Intent:"})," ",a.intent]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"})," ",a.status]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Progress:"})," ",a.progress,"%"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Created:"})," ",d(a.created_at)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Updated:"})," ",d(a.updated_at)]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Parameters"}),e.jsx("pre",{className:"text-sm bg-muted p-3 rounded overflow-auto",children:JSON.stringify(a.params,null,2)})]})]}),a.result&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Result"}),e.jsx("div",{className:"bg-muted p-4 rounded",children:typeof a.result=="string"?e.jsx("p",{children:a.result}):e.jsx("pre",{className:"text-sm overflow-auto",children:JSON.stringify(a.result,null,2)})})]}),a.error_message&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2 text-destructive",children:"Error"}),e.jsx("div",{className:"bg-destructive/10 border border-destructive/20 p-4 rounded",children:e.jsx("p",{className:"text-destructive",children:a.error_message})})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(J,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No task selected"}),e.jsx("p",{className:"text-muted-foreground",children:"Select a task from the grid or list view to see detailed information"})]})})]})]})]})};export{xe as default};
