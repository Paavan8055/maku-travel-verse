import{r as c,h as H,s as n,j as e,d as g,f as p,g as j,e as f,a as P,B as m,b as O}from"./index-DJr1750g-1761372786103.js";import{T as R,a as q,b as _,c as k}from"./tabs-ChPi7Wai-1761372786103.js";import{N as G}from"./Navbar-BsidW7ha-1761372786103.js";import{I as d}from"./input-DqGcWsQw-1761372786103.js";import{L as l}from"./label-_gSJFdDg-1761372786103.js";import{S as T,a as D,b as $,c as B,d as h}from"./select-1lOxQt2b-1761372786103.js";import{S as J}from"./switch-Dtgejps--1761372786103.js";import{B as o}from"./bell-_TjBG-0o-1761372786103.js";import{P as K}from"./plus-B8ZgQiQz-1761372786103.js";import{T as Q}from"./trash-2-BhHf7wc1-1761372786103.js";import{T as W}from"./trending-down-BzBSFI0D-1761372786103.js";import{T as X}from"./trending-up-DwP9sF2f-1761372786103.js";import{C as Z}from"./chevron-left-DWkROGy5-1761372786103.js";import{U as M}from"./user-d1mCht9P-1761372786103.js";import"./useApiHealth-nqc67E7W-1761372786103.js";import"./avatar-C-jVzCdJ-1761372786103.js";import"./index-DsQq8d_h-1761372786103.js";import"./globe-BIc4cSc9-1761372786103.js";import"./useHealthMonitor-B6XLbbaC-1761372786103.js";import"./useAIIntelligence-u1xm4jYe-1761372786103.js";import"./plane-C31ePVtH-1761372786103.js";import"./map-pin-DCTTjC40-1761372786103.js";import"./sparkles-1TFqtcdt-1761372786103.js";import"./chevron-down-9xMs7EAx-1761372786103.js";import"./brain-Cw34cxNH-1761372786103.js";import"./calendar-BHB0CqgJ-1761372786103.js";import"./zap-DVLc29wt-1761372786103.js";import"./users-DVHEI_ct-1761372786103.js";import"./settings-BNbhqb_d-1761372786103.js";import"./shield-Dyr_tcSc-1761372786103.js";import"./index-BdQq_4o_-1761372786103.js";import"./index-BxHCFFya-1761372786103.js";const ee=()=>{const[x,w]=c.useState([]),[E,C]=c.useState(!0),[F,v]=c.useState(!1),[N,A]=c.useState(!0),[L,z]=c.useState(!1),[t,i]=c.useState({type:"hotel",destination:"",origin:"",startDate:"",endDate:"",passengers:2,rooms:1,targetPrice:0,threshold:10,notificationMethod:"email"}),{toast:b}=H();c.useEffect(()=>{y()},[]);const y=async()=>{try{C(!0);const{data:{session:s}}=await n.auth.getSession();if(!s){C(!1);return}const{data:a,error:r}=await n.functions.invoke("price-alert-manager",{body:{action:"get_alerts"},headers:{Authorization:`Bearer ${s.access_token}`}});r?(console.warn("Price alert service not available:",r.message),A(!1),L||z(!0),w([])):(A(!0),w((a==null?void 0:a.alerts)||[]))}catch(s){console.warn("Price alert feature not configured:",s==null?void 0:s.message),A(!1),w([])}finally{C(!1)}},U=async()=>{if(!N){b({title:"Service Unavailable",description:"Price alert service is currently being set up",variant:"default"});return}try{const{data:{session:s}}=await n.auth.getSession();if(!s)return;const a={search_criteria:{type:t.type,destination:t.destination,origin:t.origin||void 0,dates:{start:t.startDate,end:t.endDate||void 0},passengers:t.passengers,rooms:t.rooms},target_price:t.targetPrice,current_price:t.targetPrice,threshold_percentage:t.threshold,notification_method:t.notificationMethod},{data:r,error:u}=await n.functions.invoke("price-alert-manager",{body:{action:"create_alert",...a},headers:{Authorization:`Bearer ${s.access_token}`}});u?console.warn("Failed to create alert:",u.message):(b({title:"Alert Created",description:"Your price alert has been set up successfully"}),v(!1),y(),S())}catch(s){console.warn("Alert creation error:",s==null?void 0:s.message)}},I=async(s,a)=>{if(N)try{const{data:{session:r}}=await n.auth.getSession();if(!r)return;const{error:u}=await n.functions.invoke("price-alert-manager",{body:{action:"update_alert",alert_id:s,updates:{is_active:a}},headers:{Authorization:`Bearer ${r.access_token}`}});u?console.warn("Failed to update alert:",u.message):(b({title:a?"Alert Activated":"Alert Paused",description:`Price monitoring has been ${a?"enabled":"disabled"}`}),y())}catch(r){console.warn("Alert toggle error:",r==null?void 0:r.message)}},V=async s=>{if(N)try{const{data:{session:a}}=await n.auth.getSession();if(!a)return;const{error:r}=await n.functions.invoke("price-alert-manager",{body:{action:"delete_alert",alert_id:s},headers:{Authorization:`Bearer ${a.access_token}`}});r?console.warn("Failed to delete alert:",r.message):(b({title:"Alert Deleted",description:"Price alert has been removed"}),y())}catch(a){console.warn("Alert deletion error:",a==null?void 0:a.message)}},S=()=>{i({type:"hotel",destination:"",origin:"",startDate:"",endDate:"",passengers:2,rooms:1,targetPrice:0,threshold:10,notificationMethod:"email"})},Y=s=>{const a=[];return s.origin&&a.push(`${s.origin} →`),a.push(s.destination),s.dates.end?a.push(`${s.dates.start} to ${s.dates.end}`):a.push(s.dates.start),s.passengers&&a.push(`${s.passengers} passengers`),s.rooms&&a.push(`${s.rooms} rooms`),a.join(" • ")};return E?e.jsxs(g,{children:[e.jsx(p,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5"}),"Price Alerts"]})}),e.jsx(f,{children:e.jsx("div",{className:"animate-pulse space-y-4",children:[...Array(3)].map((s,a)=>e.jsx("div",{className:"h-20 bg-muted rounded-lg"},a))})})]}):N?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(g,{children:[e.jsx(p,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5"}),"Price Alerts (",x.length,")"]}),e.jsxs(m,{onClick:()=>v(!0),size:"sm",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Create Alert"]})]})}),e.jsx(f,{children:x.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Price Alerts"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Set up alerts to get notified when prices drop for your searches"}),e.jsx(m,{onClick:()=>v(!0),children:"Create Your First Alert"})]}):e.jsx("div",{className:"space-y-4",children:x.map(s=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(P,{variant:"outline",className:"capitalize",children:s.search_criteria.type}),e.jsx(P,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Paused"})]}),e.jsx("p",{className:"text-sm font-medium",children:Y(s.search_criteria)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{checked:s.is_active,onCheckedChange:a=>I(s.id,a)}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>V(s.id),children:e.jsx(Q,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:["Target: $",s.target_price]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{children:["Current: $",s.current_price]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-4 w-4 text-yellow-600"}),e.jsxs("span",{children:["±",s.threshold_percentage,"% threshold"]})]})]}),s.last_checked&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Last checked: ",new Date(s.last_checked).toLocaleString()]})]},s.id))})})]}),F&&e.jsxs(g,{children:[e.jsx(p,{children:e.jsx(j,{children:"Create New Price Alert"})}),e.jsxs(f,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Travel Type"}),e.jsxs(T,{value:t.type,onValueChange:s=>i({...t,type:s}),children:[e.jsx(D,{children:e.jsx($,{})}),e.jsxs(B,{children:[e.jsx(h,{value:"hotel",children:"Hotel"}),e.jsx(h,{value:"flight",children:"Flight"}),e.jsx(h,{value:"activity",children:"Activity"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Destination"}),e.jsx(d,{placeholder:"e.g., Sydney, Melbourne, Paris",value:t.destination,onChange:s=>i({...t,destination:s.target.value})})]}),t.type==="flight"&&e.jsxs("div",{children:[e.jsx(l,{children:"Origin"}),e.jsx(d,{placeholder:"e.g., SYD, MEL, NYC",value:t.origin,onChange:s=>i({...t,origin:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Start Date"}),e.jsx(d,{type:"date",value:t.startDate,onChange:s=>i({...t,startDate:s.target.value})})]}),(t.type==="hotel"||t.type==="activity")&&e.jsxs("div",{children:[e.jsx(l,{children:"End Date"}),e.jsx(d,{type:"date",value:t.endDate,onChange:s=>i({...t,endDate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Target Price ($)"}),e.jsx(d,{type:"number",placeholder:"200",value:t.targetPrice||"",onChange:s=>i({...t,targetPrice:Number(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Alert Threshold (%)"}),e.jsx(d,{type:"number",placeholder:"10",value:t.threshold,onChange:s=>i({...t,threshold:Number(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Notification Method"}),e.jsxs(T,{value:t.notificationMethod,onValueChange:s=>i({...t,notificationMethod:s}),children:[e.jsx(D,{children:e.jsx($,{})}),e.jsxs(B,{children:[e.jsx(h,{value:"email",children:"Email"}),e.jsx(h,{value:"push",children:"Push Notification"}),e.jsx(h,{value:"both",children:"Both"})]})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(m,{onClick:U,disabled:!t.destination||!t.targetPrice,children:"Create Alert"}),e.jsx(m,{variant:"outline",onClick:()=>{v(!1),S()},children:"Cancel"})]})]})]})]}):e.jsxs(g,{children:[e.jsx(p,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5"}),"Price Alerts"]})}),e.jsx(f,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(o,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Coming Soon"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Price alert monitoring is currently being set up. This feature will be available soon!"}),e.jsx(P,{variant:"secondary",children:"In Development"})]})})]})},Be=()=>{const x=O();return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(G,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8 pt-24",children:[e.jsxs(m,{variant:"ghost",onClick:()=>x(-1),className:"mb-4",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("h1",{className:"text-3xl font-bold mb-8 flex items-center",children:[e.jsx(M,{className:"h-8 w-8 mr-3"}),"Profile"]}),e.jsxs(R,{defaultValue:"alerts",className:"w-full",children:[e.jsxs(q,{className:"grid w-full grid-cols-2",children:[e.jsxs(_,{value:"alerts",className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-4 w-4"}),"Price Alerts"]}),e.jsxs(_,{value:"profile",className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),"Profile Settings"]})]}),e.jsx(k,{value:"alerts",className:"mt-6",children:e.jsx(ee,{})}),e.jsx(k,{value:"profile",className:"mt-6",children:e.jsxs(g,{children:[e.jsx(p,{children:e.jsx(j,{children:"Profile Settings"})}),e.jsx(f,{children:e.jsx("p",{className:"text-muted-foreground",children:"Profile settings coming soon..."})})]})})]})]})]})};export{Be as default};
