import{r as i,j as e,B as E,a as t,b as a,T as p,A as g,q as f,d as n,e as d,i as o,f as v}from"./index-DCRQEUcE-1760115652904.js";import{T as D,a as I,b as m,c as x}from"./tabs-LSycJ_P_-1760115652904.js";import{A as u}from"./activity-WCbq80ca-1760115652904.js";import{U as N}from"./users-BFwUlY6U-1760115652904.js";import{B as U}from"./ban-C3UGhLUW-1760115652904.js";import{T as _}from"./trending-up-CuNjAAey-1760115652904.js";import{S as h}from"./shield-BL4n2Pad-1760115652904.js";import{C as L}from"./clock-d4DfbCUF-1760115652904.js";import{L as M}from"./lock-n3qgqJv1-1760115652904.js";import{E as W}from"./eye-DVaT_nzT-1760115652904.js";function G(){const[j,y]=i.useState([]),[r,w]=i.useState({total_events:0,failed_logins:0,successful_logins:0,blocked_attempts:0,unique_ips:0,mfa_success_rate:0}),[b,S]=i.useState(!0),[c,k]=i.useState(!0);i.useEffect(()=>{const s=()=>{const l=[{id:"1",type:"login_attempt",severity:"medium",user_email:"admin@maku.travel",ip_address:"203.123.45.67",user_agent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",event_data:{method:"password",country:"Australia"},timestamp:new Date(Date.now()-3e5).toISOString(),status:"success"},{id:"2",type:"mfa_verification",severity:"low",user_email:"admin@maku.travel",ip_address:"203.123.45.67",user_agent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",event_data:{method:"totp",attempts:1},timestamp:new Date(Date.now()-29e4).toISOString(),status:"success"},{id:"3",type:"login_attempt",severity:"high",ip_address:"45.123.89.12",user_agent:"curl/7.68.0",event_data:{method:"password",country:"Unknown",suspicious:!0},timestamp:new Date(Date.now()-18e4).toISOString(),status:"blocked"},{id:"4",type:"admin_action",severity:"medium",user_email:"admin@maku.travel",ip_address:"203.123.45.67",user_agent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",event_data:{action:"user_role_modification",target_user:"user@example.com"},timestamp:new Date(Date.now()-12e4).toISOString(),status:"success"},{id:"5",type:"data_access",severity:"low",user_email:"admin@maku.travel",ip_address:"203.123.45.67",user_agent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",event_data:{resource:"booking_data",query_type:"audit_logs"},timestamp:new Date(Date.now()-6e4).toISOString(),status:"success"}];y(l),w({total_events:147,failed_logins:8,successful_logins:23,blocked_attempts:5,unique_ips:12,mfa_success_rate:96.5}),S(!1)};if(s(),c){const l=setInterval(s,3e4);return()=>clearInterval(l)}},[c]);const T=s=>{switch(s){case"critical":return"destructive";case"high":return"destructive";case"medium":return"secondary";case"low":return"outline";default:return"outline"}},A=s=>{switch(s){case"success":return"default";case"failure":return"destructive";case"blocked":return"secondary";default:return"outline"}},C=s=>{switch(s){case"login_attempt":return e.jsx(N,{className:"h-4 w-4"});case"mfa_verification":return e.jsx(h,{className:"h-4 w-4"});case"permission_escalation":return e.jsx(_,{className:"h-4 w-4"});case"data_access":return e.jsx(W,{className:"h-4 w-4"});case"admin_action":return e.jsx(M,{className:"h-4 w-4"});default:return e.jsx(u,{className:"h-4 w-4"})}};return b?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Security Event Monitoring"}),e.jsx("p",{className:"text-muted-foreground",children:"Real-time security events and threat detection"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(E,{variant:"outline",size:"sm",onClick:()=>k(!c),children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),c?"Disable":"Enable"," Auto-refresh"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx(t,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-4 w-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.total_events}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Events"})]})]})})}),e.jsx(t,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-4 w-4 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.successful_logins}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Successful Logins"})]})]})})}),e.jsx(t,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.failed_logins}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Failed Logins"})]})]})})}),e.jsx(t,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.blocked_attempts}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Blocked Attempts"})]})]})})}),e.jsx(t,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.unique_ips}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Unique IPs"})]})]})})}),e.jsx(t,{children:e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-green-500"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:[r.mfa_success_rate,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"MFA Success"})]})]})})})]}),j.some(s=>s.severity==="critical"||s.severity==="high")&&e.jsxs(g,{className:"border-red-200 bg-red-50",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsxs(f,{children:[e.jsx("strong",{children:"Security Alert:"})," High-severity security events detected. Immediate review recommended."]})]}),e.jsxs(D,{defaultValue:"events",className:"space-y-4",children:[e.jsxs(I,{children:[e.jsx(m,{value:"events",children:"Recent Events"}),e.jsx(m,{value:"threats",children:"Threat Analysis"}),e.jsx(m,{value:"trends",children:"Security Trends"})]}),e.jsx(x,{value:"events",className:"space-y-4",children:e.jsxs(t,{children:[e.jsxs(n,{children:[e.jsx(d,{children:"Security Events Log"}),e.jsx(o,{children:"Real-time security events from the last 24 hours"})]}),e.jsx(a,{children:e.jsx("div",{className:"space-y-3",children:j.map(s=>e.jsxs("div",{className:"flex items-start gap-4 p-3 rounded-lg border bg-card",children:[e.jsx("div",{className:"mt-0.5",children:C(s.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(v,{variant:T(s.severity),className:"text-xs",children:s.severity.toUpperCase()}),e.jsx(v,{variant:A(s.status),className:"text-xs",children:s.status.toUpperCase()}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.type.replace("_"," ").toUpperCase()})]}),e.jsxs("p",{className:"text-sm font-medium",children:[s.user_email||"Unknown User"," from ",s.ip_address]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:JSON.stringify(s.event_data)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(L,{className:"h-3 w-3"}),new Date(s.timestamp).toLocaleTimeString()]})]},s.id))})})]})}),e.jsx(x,{value:"threats",children:e.jsxs(t,{children:[e.jsxs(n,{children:[e.jsx(d,{children:"Threat Analysis"}),e.jsx(o,{children:"Automated threat detection and analysis"})]}),e.jsx(a,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(g,{children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(f,{children:"Suspicious login pattern detected from IP 45.123.89.12 - Automated blocking activated"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{children:"• 3 failed login attempts in the last hour"}),e.jsx("p",{children:"• Non-standard user agent detected"}),e.jsx("p",{children:"• IP geolocation: Unknown/VPN suspected"})]})]})})]})}),e.jsx(x,{value:"trends",children:e.jsxs(t,{children:[e.jsxs(n,{children:[e.jsx(d,{children:"Security Trends"}),e.jsx(o,{children:"Security metrics over time"})]}),e.jsx(a,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Login Success Rate"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"94.2%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"↑ 2.1% from last week"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Blocked Threats"}),e.jsx("div",{className:"text-2xl font-bold text-red-600",children:"12"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"↓ 8 from last week"})]})]})})]})})]})]})}export{G as SecurityEventMonitoring};
