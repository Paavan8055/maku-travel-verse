import{c as ks,r as i,s as Ne,l as W,w as $s,O as $e,Q as Ys,U as _s,j as e,y as Ye,V as Gs,W as te,x as ve,Y as Ks,z as ue,Z as zs,$ as Hs,t as ye,n as Ws,g as Js,u as _e,B as C,a as U,b as k,a0 as be,o as _,f as J,C as Vs,X as Xs,T as qs}from"./index-7HSUJgza-1759930941462.js";import{N as Qs,P as K,a as z,b as H}from"./Navbar-o8_N-Duy-1759930941462.js";import{D as Zs,a as et,b as st,c as tt,d as rt}from"./dialog-CNjJ0msH-1759930941462.js";import{u as at}from"./index-DMwMdLt4-1759930941462.js";import{u as nt}from"./useBookingPayment-bC4-_SiT-1759930941462.js";import{I as it}from"./info-5I0Sqq51-1759930941462.js";import{m as Ge}from"./hero-maldives-B2o6a7jv-1759930941462.js";import{T as Te}from"./trending-up-hDmOjmJw-1759930941462.js";import{P as V}from"./plane-CcAjdWCA-1759930941462.js";import{P as Oe}from"./percent-Bm8D6kC4-1759930941462.js";import{C as G}from"./calendar-DZe91egs-1759930941462.js";import{P as lt,D as Z}from"./PerformanceWrapper-C5h-inQI-1759930941462.js";import{F as ot}from"./FlightBookingProgress-Bq8WpxGN-1759930941462.js";import{M as ct}from"./map-pin-DWB_nDS6-1759930941462.js";import{U as Ke}from"./users-Bzlfk3AE-1759930941462.js";import{f as P}from"./format-SLKapaWq-1759930941462.js";import{a as xe,i as ce,C as ee}from"./calendar-UOsmZ8Yx-1759930941462.js";import{C as dt}from"./chevron-left-CK1xkntt-1759930941462.js";import{E as mt}from"./external-link-DI7mGgpY-1759930941462.js";import{S as pe,a as he,b as fe,c as ge,d as T}from"./select-BH1o79_M-1759930941462.js";import{F as ut}from"./filter-Cf3pj5b7-1759930941462.js";import{I as de}from"./input-B0BzcVH8-1759930941462.js";import{S as xt}from"./search-CRzdypr2-1759930941462.js";import"./useApiHealth-D7dXMEnM-1759930941462.js";import"./avatar-CAn_Sof--1759930941462.js";import"./index-CVZIOD8e-1759930941462.js";import"./globe-TPfiTbfc-1759930941462.js";import"./useHealthMonitor-yZrw-rWv-1759930941462.js";import"./useAIIntelligence-BAX8jRs9-1759930941462.js";import"./sparkles-txvMzh8g-1759930941462.js";import"./chevron-down-F990gvlW-1759930941462.js";import"./brain-DM9TtRFK-1759930941462.js";import"./zap-CHSdTv2p-1759930941462.js";import"./menu-B6RjQ9Ul-1759930941462.js";import"./settings-hfDWc7pn-1759930941462.js";import"./shield-_-CGtLvW-1759930941462.js";import"./user-rxp6EPp9-1759930941462.js";import"./index-CPc6MCQd-1759930941462.js";import"./usePerformanceOptimizer--X9OI5o2-1759930941462.js";import"./circle-check-C1I2Jmg7-1759930941462.js";import"./en-US-CC7XSppg-1759930941462.js";import"./endOfMonth-BRh7JuDV-1759930941462.js";import"./index-BdQq_4o_-1759930941462.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=ks("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);function Be(s,t,r){return xe(s,-t,r)}const ke={SYD:"AUD",MEL:"AUD",BNE:"AUD",PER:"AUD",ADL:"AUD",DRW:"AUD",CNS:"AUD",OOL:"AUD",DEL:"INR",BOM:"INR",BLR:"INR",MAA:"INR",CCU:"INR",HYD:"INR",PNQ:"INR",AMD:"INR",COK:"INR",TRV:"INR",GOI:"INR",IXC:"INR",JAI:"INR",LKO:"INR",PAT:"INR",IXB:"INR",LHR:"EUR",CDG:"EUR",FRA:"EUR",AMS:"EUR",FCO:"EUR",BCN:"EUR",MAD:"EUR",MUC:"EUR",ZUR:"EUR",VIE:"EUR",BRU:"EUR",CPH:"EUR",ARN:"EUR",HEL:"EUR",OSL:"EUR",DUB:"EUR",LGW:"GBP",STN:"GBP",LTN:"GBP",MAN:"GBP",EDI:"GBP",GLA:"GBP",BHX:"GBP",SIN:"USD",BKK:"USD",KUL:"USD",CGK:"USD",MNL:"USD",HKG:"USD",TPE:"USD",NRT:"JPY",HND:"JPY",KIX:"JPY",ICN:"KRW",PVG:"CNY",PEK:"CNY",CAN:"CNY",DXB:"USD",DOH:"USD",AUH:"USD",RUH:"USD",JED:"USD",KWI:"USD",JFK:"USD",LAX:"USD",ORD:"USD",DFW:"USD",ATL:"USD",DEN:"USD",SEA:"USD",SFO:"USD",YYZ:"CAD",YVR:"CAD",YUL:"CAD"},ht=(s,t)=>{const r=ke[s],c=ke[t];return r&&c&&r===c||r?r:c||"USD"},ft=s=>{const[t,r]=i.useState([]),[c,o]=i.useState(!1),[g,h]=i.useState(null);return i.useEffect(()=>{if(!s||!s.origin||!s.destination||!s.departureDate||s.departureDate===""){console.log("useFlightSearch: Missing or invalid criteria",s),r([]),h(null),o(!1);return}if(!/^\d{4}-\d{2}-\d{2}$/.test(s.departureDate)){console.error("useFlightSearch: Invalid date format",s.departureDate),h("Invalid departure date format. Please select a valid date."),o(!1);return}console.log("useFlightSearch: Starting search with criteria:",s),(async()=>{var j;o(!0),h(null);try{const d=ht(s.origin,s.destination);console.log(`useFlightSearch: Using currency ${d} for route ${s.origin}-${s.destination}`);const{data:u,error:v}=await Ne.functions.invoke("provider-rotation",{body:{searchType:"flight",params:{origin:s.origin.toUpperCase(),destination:s.destination.toUpperCase(),departure_date:s.departureDate,return_date:s.returnDate,passengers:s.passengers||1,adults:s.passengers||1,children:0,infants:0,travelClass:"ECONOMY",cabin:"ECONOMY",nonStop:!1,currency:d}}});if(v)throw v;if(u!=null&&u.success&&((j=u==null?void 0:u.data)!=null&&j.flights)&&Array.isArray(u.data.flights)){const y=u.data.flights;if(console.log("useFlightSearch: Provider rotation success, transforming",y.length,"flights"),console.log("Used provider:",u.provider,"Fallback used:",u.fallbackUsed),y.length===0){console.log("useFlightSearch: No flights found in provider response"),r([]),h("No flights found for your search criteria. Please try different dates or destinations.");return}console.log("Raw provider flights:",y.length);const N=y.map((m,w)=>{var x,b,p,f,S,M,F,R,I,O,D,$,B;return console.log(`Processing flight ${w+1}:`,{flightId:m.id,airline:(x=m.airline)==null?void 0:x.name,price:m.price}),{id:m.id,airline:((b=m.airline)==null?void 0:b.name)||((p=m.airline)==null?void 0:p.code)||"Unknown",airlineCode:(f=m.airline)==null?void 0:f.code,airlineLogo:(S=m.airline)==null?void 0:S.logo,flightNumber:m.flightNumber,outboundFlightNumber:m.outboundFlightNumber,returnFlightNumber:m.returnFlightNumber,aircraft:m.aircraft,origin:(M=m.departure)==null?void 0:M.airport,destination:(F=m.arrival)==null?void 0:F.airport,departureTime:(R=m.departure)==null?void 0:R.time,arrivalTime:(I=m.arrival)==null?void 0:I.time,departure:m.departure,arrival:m.arrival,duration:m.durationMinutes||m.duration,stops:m.stops||0,stopoverInfo:m.stopoverInfo,price:((O=m.price)==null?void 0:O.amount)||0,currency:((D=m.price)==null?void 0:D.currency)||"USD",availableSeats:m.availableSeats||9,cabin:m.cabinClass||"ECONOMY",baggage:m.baggage||{carry:!0,checked:!1},segments:m.segments||[],fareOptions:[{type:"economy",price:(($=m.price)==null?void 0:$.amount)||0,currency:((B=m.price)==null?void 0:B.currency)||"USD",features:["Standard seat selection","Carry-on bag included"],seatsAvailable:9,bookingClass:"M"}],isRoundTrip:!!s.returnDate,amadeusOfferId:m.id}});console.log("useFlightSearch: Setting",N.length,"transformed flights"),r(N)}else console.log("useFlightSearch: No flight data from API",u),r([]),u!=null&&u.error?h(`Amadeus API Error: ${u.error}. Please try different search criteria or check back later.`):h("No flights found for your search criteria. Please try different dates, destinations, or check our flight alternatives.")}catch(d){W.error("Flight search error:",d);const u=d instanceof Error?d.message:"Failed to search flights";u.includes("credentials")||u.includes("auth")?h("Flight search service is temporarily unavailable due to authentication issues. Please try again in a few minutes."):u.includes("network")||u.includes("fetch")?h("Network connection issue. Please check your internet connection and try again."):u.includes("rate limit")?h("Too many requests. Please wait a moment before searching again."):h(`Amadeus Flight Search Error: ${u}. Please try different search criteria or check back later.`),$s.error("Flight search temporarily unavailable. Please try again in a few minutes."),r([])}finally{o(!1)}})()},[s==null?void 0:s.origin,s==null?void 0:s.destination,s==null?void 0:s.departureDate,s==null?void 0:s.returnDate,s==null?void 0:s.passengers]),{flights:t,loading:c,error:g}};var Se="Radio",[gt,ze]=Ye(Se),[jt,Nt]=gt(Se),He=i.forwardRef((s,t)=>{const{__scopeRadio:r,name:c,checked:o=!1,required:g,disabled:h,value:n="on",onCheck:l,form:j,...d}=s,[u,v]=i.useState(null),y=ve(t,w=>v(w)),N=i.useRef(!1),m=u?j||!!u.closest("form"):!0;return e.jsxs(jt,{scope:r,checked:o,disabled:h,children:[e.jsx(te.button,{type:"button",role:"radio","aria-checked":o,"data-state":Xe(o),"data-disabled":h?"":void 0,disabled:h,value:n,...d,ref:y,onClick:ue(s.onClick,w=>{o||l==null||l(),m&&(N.current=w.isPropagationStopped(),N.current||w.stopPropagation())})}),m&&e.jsx(Ve,{control:u,bubbles:!N.current,name:c,value:n,checked:o,required:g,disabled:h,form:j,style:{transform:"translateX(-100%)"}})]})});He.displayName=Se;var We="RadioIndicator",Je=i.forwardRef((s,t)=>{const{__scopeRadio:r,forceMount:c,...o}=s,g=Nt(We,r);return e.jsx(zs,{present:c||g.checked,children:e.jsx(te.span,{"data-state":Xe(g.checked),"data-disabled":g.disabled?"":void 0,...o,ref:t})})});Je.displayName=We;var vt="RadioBubbleInput",Ve=i.forwardRef(({__scopeRadio:s,control:t,checked:r,bubbles:c=!0,...o},g)=>{const h=i.useRef(null),n=ve(h,g),l=at(r),j=Hs(t);return i.useEffect(()=>{const d=h.current;if(!d)return;const u=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(u,"checked").set;if(l!==r&&y){const N=new Event("click",{bubbles:c});y.call(d,r),d.dispatchEvent(N)}},[l,r,c]),e.jsx(te.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...o,tabIndex:-1,ref:n,style:{...o.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Ve.displayName=vt;function Xe(s){return s?"checked":"unchecked"}var yt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],re="RadioGroup",[bt]=Ye(re,[$e,ze]),qe=$e(),Qe=ze(),[St,wt]=bt(re),Ze=i.forwardRef((s,t)=>{const{__scopeRadioGroup:r,name:c,defaultValue:o,value:g,required:h=!1,disabled:n=!1,orientation:l,dir:j,loop:d=!0,onValueChange:u,...v}=s,y=qe(r),N=Ys(j),[m,w]=_s({prop:g,defaultProp:o!=null?o:null,onChange:u,caller:re});return e.jsx(St,{scope:r,name:c,required:h,disabled:n,value:m,onValueChange:w,children:e.jsx(Gs,{asChild:!0,...y,orientation:l,dir:N,loop:d,children:e.jsx(te.div,{role:"radiogroup","aria-required":h,"aria-orientation":l,"data-disabled":n?"":void 0,dir:N,...v,ref:t})})})});Ze.displayName=re;var es="RadioGroupItem",ss=i.forwardRef((s,t)=>{const{__scopeRadioGroup:r,disabled:c,...o}=s,g=wt(es,r),h=g.disabled||c,n=qe(r),l=Qe(r),j=i.useRef(null),d=ve(t,j),u=g.value===o.value,v=i.useRef(!1);return i.useEffect(()=>{const y=m=>{yt.includes(m.key)&&(v.current=!0)},N=()=>v.current=!1;return document.addEventListener("keydown",y),document.addEventListener("keyup",N),()=>{document.removeEventListener("keydown",y),document.removeEventListener("keyup",N)}},[]),e.jsx(Ks,{asChild:!0,...n,focusable:!h,active:u,children:e.jsx(He,{disabled:h,required:g.required,checked:u,...l,...o,name:g.name,ref:d,onCheck:()=>g.onValueChange(o.value),onKeyDown:ue(y=>{y.key==="Enter"&&y.preventDefault()}),onFocus:ue(o.onFocus,()=>{var y;v.current&&((y=j.current)==null||y.click())})})})});ss.displayName=es;var Ct="RadioGroupIndicator",ts=i.forwardRef((s,t)=>{const{__scopeRadioGroup:r,...c}=s,o=Qe(r);return e.jsx(Je,{...o,...c,ref:t})});ts.displayName=Ct;var rs=Ze,as=ss,Rt=ts;const ns=i.forwardRef(({className:s,...t},r)=>e.jsx(rs,{className:ye("grid gap-2",s),...t,ref:r}));ns.displayName=rs.displayName;const je=i.forwardRef(({className:s,...t},r)=>e.jsx(as,{ref:r,className:ye("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:e.jsx(Rt,{className:"flex items-center justify-center",children:e.jsx(Ws,{className:"h-2.5 w-2.5 fill-current text-current"})})}));je.displayName=as.displayName;const Mt=({bookingType:s,bookingData:t,amount:r,currency:c="USD",className:o=""})=>{const[g,h]=i.useState(!1),[n,l]=i.useState({email:"",firstName:"",lastName:"",phone:""}),[j,d]=i.useState("card"),[u,v]=i.useState(0),{user:y}=Js();nt();const N=_e();return g?e.jsx(U,{className:"travel-card",children:e.jsx(k,{className:"p-4"})}):e.jsxs(C,{onClick:()=>{var m,w,x,b;if(s==="flight"){if((t==null?void 0:t.tripType)==="multicity"&&(t!=null&&t.segments)){const S=new URLSearchParams({tripType:"multicity",segments:JSON.stringify(t.segments),amount:String(r),currency:c});console.log("Navigating to flight checkout with multi-city params:",S.toString()),N(`/flight-checkout?${S.toString()}`);return}if(t&&t.outbound&&t.inbound){const S=new URLSearchParams({tripType:"roundtrip",outboundId:((m=t.outbound)==null?void 0:m.id)||"",inboundId:((w=t.inbound)==null?void 0:w.id)||"",outboundFare:((x=t.outbound)==null?void 0:x.fareType)||"basic",inboundFare:((b=t.inbound)==null?void 0:b.fareType)||"basic",amount:String(r),currency:c});console.log("Navigating to flight checkout with roundtrip params:",S.toString()),N(`/flight-checkout?${S.toString()}`);return}const f=new URLSearchParams({flightId:(t==null?void 0:t.id)||"",fareType:(t==null?void 0:t.fareType)||"basic",tripType:(t==null?void 0:t.tripType)||"oneway",amount:String(r),currency:c});console.log("Navigating to flight checkout with one-way params:",f.toString()),N(`/flight-checkout?${f.toString()}`)}else if(s==="hotel"){const p=new URLSearchParams({hotelId:(t==null?void 0:t.hotelId)||"",hotelName:(t==null?void 0:t.name)||"Hotel",checkIn:(t==null?void 0:t.checkIn)||"",checkOut:(t==null?void 0:t.checkOut)||"",adults:String((t==null?void 0:t.adults)||2),children:String((t==null?void 0:t.children)||0),rooms:String((t==null?void 0:t.rooms)||1),price:String(r),currency:c});N(`/hotel-checkout?${p.toString()}`)}else if(s==="activity"){const p=new URLSearchParams({activityId:(t==null?void 0:t.id)||"",title:(t==null?void 0:t.title)||"Activity",date:(t==null?void 0:t.date)||"",time:(t==null?void 0:t.time)||"",participants:String((t==null?void 0:t.participants)||1),total:String(r),currency:c});N(`/activity-checkout?${p.toString()}`)}else h(!0)},className:`btn-primary h-12 ${o}`,size:"lg",children:["Continue - ",c," ",r]})},Et=({open:s,onOpenChange:t,flight:r,outbound:c,tripType:o="oneway",returnFlights:g=[],multiCitySelections:h=[]})=>{var b;const{convert:n,formatCurrency:l,selectedCurrency:j}=be(),[d,u]=i.useState("basic"),v=i.useMemo(()=>{if(o!=="multicity"||h.length===0)return{basic:0,flex:0};let p=0,f=0;return h.forEach(S=>{const M=n(S.flight.price,S.flight.currency),F=Math.max(Math.round(S.flight.price*.15),15),R=n(F,S.flight.currency);p+=M,f+=M+R}),{basic:p,flex:f}},[o,h,n]),y=i.useMemo(()=>{if(!r)return{baseLocal:0,flexDiffLocal:0,totals:{basic:0,flex:0}};const p=n(r.price,r.currency),f=Math.max(Math.round(r.price*.15),15),S=n(f,r.currency),M={basic:p,flex:p+S};return{baseLocal:p,flexDiffLocal:S,totals:M}},[n,r]),N=i.useMemo(()=>c?n(c.price,c.currency):0,[c,n]),m=i.useMemo(()=>{if(o==="roundtrip"&&g.length>0&&!c){const p=g.reduce((f,S)=>S.price<f.price?S:f,g[0]);return n(p.price,p.currency)}return 0},[o,g,c,n]),w=i.useMemo(()=>{if(o==="multicity")return d==="flex"?v.flex:v.basic;const p=d==="flex"?y.totals.flex:y.totals.basic;return c?N+p:p+m},[o,d,v,y,c,N,m]),x=e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-primary"})," 1 carry-on bag"]}),((b=r==null?void 0:r.baggage)==null?void 0:b.checked)&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-primary"})," Checked bag(s) included"]})]});return e.jsx(Zs,{open:s,onOpenChange:t,children:e.jsxs(et,{className:"max-w-3xl",children:[e.jsxs(st,{children:[e.jsx(tt,{children:"Fare Selection"}),e.jsx(rt,{children:o==="multicity"?e.jsxs(e.Fragment,{children:["Complete Multi-City Journey (",h.length," flights)"]}):c?e.jsxs(e.Fragment,{children:["Departing: ",c.origin," → ",c.destination," · ",c.airline," ",c.flightNumber," (Basic)",e.jsx("br",{}),"Returning: ",r==null?void 0:r.origin," → ",r==null?void 0:r.destination]}):e.jsxs(e.Fragment,{children:["Departure: ",r==null?void 0:r.origin," to ",r==null?void 0:r.destination]})})]}),o==="multicity"?e.jsx("div",{className:"space-y-3",children:h.map((p,f)=>e.jsxs("div",{className:"flex items-center gap-3 border rounded-lg p-3 bg-background",children:[e.jsx("div",{className:"w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-medium",children:f+1}),e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center","aria-hidden":!0,children:e.jsx("span",{className:"text-xs font-semibold text-primary",children:p.flight.airlineCode})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-foreground",children:p.flight.airline}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[p.flight.origin," → ",p.flight.destination," · ",p.flight.departureTime," → ",p.flight.arrivalTime]})]}),e.jsx(J,{variant:"secondary",className:"shrink-0",children:p.flight.cabin})]},p.segmentIndex))}):r?e.jsxs("div",{className:"flex items-center gap-3 border rounded-lg p-3 bg-background",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center","aria-hidden":!0,children:e.jsx("span",{className:"text-sm font-semibold text-primary",children:r.airlineCode})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-foreground",children:r.airline}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.departureTime," → ",r.arrivalTime," · ",r.stops==="0"?"Direct":`${r.stops} stop${r.stops==="1"?"":"s"}`]})]}),e.jsx(J,{variant:"secondary",className:"shrink-0",children:r.cabin})]}):null,e.jsxs(ns,{value:d,onValueChange:p=>u(p),className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(U,{className:d==="basic"?"ring-2 ring-primary shadow-sm":"",children:e.jsxs(k,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-semibold text-foreground",children:"Basic"}),e.jsx(je,{value:"basic",id:"fare-basic"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Inclusions per passenger"}),x]}),e.jsxs("div",{className:"mt-4 text-right font-semibold text-primary",children:["+",l(0,j)]})]})}),e.jsx(U,{className:d==="flex"?"ring-2 ring-primary shadow-sm":"",children:e.jsxs(k,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-semibold text-foreground",children:"Flex"}),e.jsx(je,{value:"flex",id:"fare-flex"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Inclusions per passenger"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-primary"})," 1 carry-on bag"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-primary"})," Checked bag(s) included"]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Flexibility"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-primary"})," Changeable"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-primary"})," Refundable"]})]})]})]}),e.jsxs("div",{className:"mt-4 text-right font-semibold text-primary",children:["+",l(y.flexDiffLocal,j)]})]})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-3 border-t pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(it,{className:"h-4 w-4"}),"Total amount"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-xl font-bold text-foreground",children:l(w,j)}),e.jsx(Mt,{bookingType:"flight",bookingData:o==="multicity"?{segments:h.map(p=>({...p.flight,fareType:d})),tripType:"multicity"}:c?{outbound:{...c,fareType:"basic"},inbound:{...r,fareType:d},tripType:"roundtrip"}:{...r,fareType:d,tripType:o},amount:w,currency:j})]})]})]})})},is="/assets/tokyo-B98Jxy2y-1759930941462.jpg",ls="/assets/london-9NPVdl8d-1759930941462.jpg",os="/assets/bangkok-vn2wb8fG-1759930941462.jpg",cs="/assets/new-york-D_B4y4NL-1759930941462.jpg",ds="/assets/singapore-qd2vjyYB-1759930941462.jpg",ms="/assets/dubai-DQWtp3jm-1759930941462.jpg",us="/assets/mumbai-Aq1WMVmZ-1759930941462.jpg",xs="/assets/los-angeles-xpzmGObk-1759930941462.jpg",ps="/assets/sydney-CeFhYBEa-1759930941462.jpg",hs="/assets/melbourne-0EaFpfKU-1759930941462.jpg",fs="/assets/perth-DMIGCA1a-1759930941462.jpg",gs="/assets/brisbane-CLZgek_Q-1759930941462.jpg",me=s=>({BOM:"Mumbai",LON:"London",NYC:"New York",BKK:"Bangkok",LAX:"Los Angeles",SIN:"Singapore",NRT:"Tokyo",DXB:"Dubai",SYD:"Sydney",MEL:"Melbourne",PER:"Perth",BNE:"Brisbane"})[s]||s,It=s=>({NRT:is,LON:ls,BKK:os,NYC:cs,SIN:ds,DXB:ms,BOM:us,LAX:xs,SYD:ps,MEL:hs,PER:fs,BNE:gs})[s]||Ge;function Ft({onRouteSelect:s,origin:t="SYD"}){const[r,c]=i.useState([]),[o,g]=i.useState(!0);i.useEffect(()=>{async function n(){var l;try{g(!0);const{data:j,error:d}=await Ne.functions.invoke("amadeus-flight-inspiration",{body:{origin:t,type:"inspiration"}});if(d){W.error("Error fetching popular routes:",d);return}j!=null&&j.success&&((l=j==null?void 0:j.data)!=null&&l.inspiration)&&c(j.data.inspiration)}catch(j){W.error("Error fetching popular routes:",j)}finally{g(!1)}}n()},[t]);const h=n=>{s&&s(n.departure,n.destination,n.departureDate,n.returnDate)};return o?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Popular Routes"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((n,l)=>e.jsx(U,{className:"animate-pulse",children:e.jsxs(k,{className:"p-4",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-1/2 mb-3"}),e.jsx("div",{className:"h-8 bg-muted rounded"})]})},l))})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Popular Routes"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["from ",me(t)]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:r.slice(0,8).map(n=>e.jsxs(U,{className:"hover:shadow-xl transition-all duration-300 cursor-pointer group overflow-hidden border-0 bg-white shadow-lg",onClick:()=>h(n),children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx("img",{src:It(n.destination),alt:me(n.destination),className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),e.jsxs("div",{className:"absolute top-3 left-3 flex items-center gap-2 bg-white/90 backdrop-blur-sm rounded-full px-3 py-1",children:[e.jsx("span",{className:"font-medium text-sm",children:n.departure}),e.jsx(V,{className:"h-3 w-3 text-primary rotate-45"}),e.jsx("span",{className:"font-medium text-sm",children:n.destination})]}),e.jsx("div",{className:"absolute bottom-3 left-3 text-white",children:e.jsx("h3",{className:"font-bold text-lg",children:me(n.destination)})})]}),e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[n.price&&e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"from"}),e.jsxs("p",{className:"font-bold text-xl text-primary",children:["$",n.price.total]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n.price.currency})]}),e.jsx(C,{variant:"default",size:"sm",className:"group-hover:bg-primary-600 transition-colors shadow-md",children:"Search"})]})})]},n.id))})]})}const se=s=>({BOM:"Mumbai",LON:"London",NYC:"New York",BKK:"Bangkok",LAX:"Los Angeles",SIN:"Singapore",NRT:"Tokyo",DXB:"Dubai",SYD:"Sydney",MEL:"Melbourne",PER:"Perth",BNE:"Brisbane"})[s]||s,Pt=s=>{const t=parseInt(s);return Math.floor(t*.15).toString()},At=s=>({NRT:is,LON:ls,BKK:os,NYC:cs,SIN:ds,DXB:ms,BOM:us,LAX:xs,SYD:ps,MEL:hs,PER:fs,BNE:gs})[s]||Ge;function Ut({onDealSelect:s,origin:t="SYD"}){const[r,c]=i.useState([]),[o,g]=i.useState(!0);i.useEffect(()=>{async function l(){var j;try{g(!0);const{data:d,error:u}=await Ne.functions.invoke("amadeus-flight-inspiration",{body:{origin:t,type:"inspiration"}});if(u){W.error("Error fetching featured deals:",u);return}if(d!=null&&d.success&&((j=d==null?void 0:d.data)!=null&&j.inspiration)){const v=d.data.inspiration.map(y=>({...y,savings:y.price?Pt(y.price.total):"50",airline:["Qantas","Emirates","Singapore Airlines","Thai Airways"][Math.floor(Math.random()*4)]}));c(v)}}catch(d){W.error("Error fetching featured deals:",d)}finally{g(!1)}}l()},[t]);const h=l=>{s&&s(l.departure,l.destination,l.departureDate,l.returnDate)},n=l=>l?new Date(l).toLocaleDateString("en-AU",{day:"2-digit",month:"short"}):"";return o?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Featured Deals"})]}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4",children:[...Array(3)].map((l,j)=>e.jsx(U,{className:"flex-shrink-0 w-80 animate-pulse",children:e.jsxs(k,{className:"p-6",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-6 bg-muted rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-8 bg-muted rounded mb-4"}),e.jsx("div",{className:"h-10 bg-muted rounded"})]})},j))})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Featured Deals"}),e.jsx(J,{variant:"secondary",className:"bg-primary/10 text-primary",children:"Limited Time"})]}),e.jsx("div",{className:"flex gap-6 overflow-x-auto pb-4",children:r.slice(0,6).map(l=>e.jsxs(U,{className:"flex-shrink-0 w-96 hover:shadow-2xl transition-all duration-300 cursor-pointer group overflow-hidden border-0 bg-white shadow-xl",onClick:()=>h(l),children:[e.jsxs("div",{className:"relative h-56 overflow-hidden",children:[e.jsx("img",{src:At(l.destination),alt:se(l.destination),className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/30 to-transparent"}),e.jsxs(J,{className:"absolute top-4 left-4 bg-gradient-to-r from-orange-500 to-red-500 text-white font-bold px-3 py-1",children:["Save $",l.savings]}),e.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-1 bg-white/90 backdrop-blur-sm rounded-full px-3 py-1 text-sm",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{children:n(l.departureDate)})]}),e.jsx("div",{className:"absolute bottom-20 left-4 right-4",children:e.jsxs("div",{className:"flex items-center justify-between text-white",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-bold text-lg",children:l.departure}),e.jsx("p",{className:"text-xs opacity-90",children:se(l.departure)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-px bg-white/50"}),e.jsx(V,{className:"h-5 w-5 mx-2 rotate-45"}),e.jsx("div",{className:"w-8 h-px bg-white/50"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-bold text-lg",children:l.destination}),e.jsx("p",{className:"text-xs opacity-90",children:se(l.destination)})]})]})}),e.jsxs("div",{className:"absolute bottom-4 left-4",children:[e.jsx("h3",{className:"font-bold text-2xl text-white",children:se(l.destination)}),l.airline&&e.jsx("p",{className:"text-sm text-white/80",children:l.airline})]})]}),e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsxs("span",{className:"text-sm text-muted-foreground line-through",children:["$",(parseInt(l.price.total)+parseInt(l.savings||"0")).toString()]})}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsxs("span",{className:"text-3xl font-bold text-primary",children:["$",l.price.total]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:l.price.currency})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"per person"})]}),e.jsx(C,{className:"bg-gradient-to-r from-primary to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white font-semibold px-6 py-3 rounded-xl shadow-lg group-hover:shadow-xl transition-all",size:"lg",children:"Book Deal"})]})})]},l.id))})]})}const Dt=({origin:s,destination:t,departureDate:r,returnDate:c,passengers:o,tripType:g,onModify:h})=>e.jsx(U,{className:"mb-6",children:e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ct,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-semibold text-lg",children:s}),e.jsx("span",{className:"text-muted-foreground",children:"→"}),e.jsx("span",{className:"font-semibold text-lg",children:t})]})]}),r&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("span",{className:"font-medium",children:[P(r,"EEE, MMM dd"),g==="roundtrip"&&c&&e.jsxs(e.Fragment,{children:[" - ",P(c,"EEE, MMM dd")]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ke,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("span",{className:"font-medium",children:[o," passenger",o>1?"s":""]})]})]}),h&&e.jsxs(C,{variant:"outline",onClick:h,size:"sm",children:[e.jsx(pt,{className:"h-4 w-4 mr-2"}),"Modify Search"]})]})}),Lt=({selectedDate:s,onDateSelect:t,origin:r,destination:c,passengers:o,cabin:g,className:h,existingFlights:n=[],currentSearchDate:l})=>{const{formatCurrency:j}=be(),[d,u]=i.useState(s?Be(s,3):new Date),[v,y]=i.useState([]),[N,m]=i.useState(!1);i.useEffect(()=>{(()=>{m(!0);const S=[],M=Array.from({length:14},(R,I)=>xe(d,I));for(const R of M)if(l&&ce(R,l)&&n.length>0){const I=Math.min(...n.map(O=>O.price||0));S.push({date:R,price:I,flightCount:n.length,isLowest:!1})}else if(n.length>0){const I=Math.min(...n.map($=>$.price||0)),O=(Math.random()-.5)*.4,D=Math.round(I*(1+O));S.push({date:R,price:D,flightCount:Math.floor(Math.random()*5)+3,isLowest:!1})}else S.push({date:R,price:0,flightCount:0,isLowest:!1});const F=S.filter(R=>R.price>0);if(F.length>0){const R=Math.min(...F.map(I=>I.price));F.forEach(I=>{I.price===R&&(I.isLowest=!0)})}y(S),m(!1)})()},[d,r,c,o,g,n==null?void 0:n.length,l==null?void 0:l.getTime()]);const w=()=>{u(f=>Be(f,7))},x=()=>{u(f=>xe(f,7))},b=f=>{t&&f.price>0&&t(f.date)},p=v.length>0?Math.min(...v.filter(f=>f.price>0).map(f=>f.price)):0;return e.jsx("div",{className:"bg-background sticky top-0 z-20 border-b border-border py-4",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground",children:[r," → ",c]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[o," passenger",o!==1?"s":""," • ",g]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{variant:"outline",size:"sm",onClick:w,className:"p-2",disabled:N,children:e.jsx(dt,{className:"h-4 w-4"})}),e.jsx(C,{variant:"outline",size:"sm",onClick:x,className:"p-2",disabled:N,children:e.jsx(Vs,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"overflow-x-auto scrollbar-hide",children:e.jsx("div",{className:"flex space-x-3 min-w-max pb-2",children:v.map((f,S)=>{const M=s&&ce(f.date,s),F=f.price>0&&f.price===p,R=f.price>0,I=l&&ce(f.date,l);return e.jsxs("button",{onClick:()=>b(f),disabled:!R||N,className:`
                    flex-shrink-0 p-4 rounded-xl border-2 text-center transition-all min-w-[140px]
                    ${M?"border-destructive bg-destructive text-destructive-foreground shadow-card":R?"border-border bg-card hover:border-destructive/30 hover:shadow-soft cursor-pointer":"border-border bg-muted text-muted-foreground cursor-not-allowed opacity-50"}
                    ${F&&!M&&R&&"ring-2 ring-travel-gold/30 border-travel-gold/50"}
                    ${N&&"animate-pulse"}
                  `,children:[e.jsx("div",{className:`text-sm font-medium mb-2 ${M?"text-destructive-foreground":"text-muted-foreground"}`,children:P(f.date,"EEE")}),e.jsx("div",{className:`text-lg font-semibold mb-2 ${M?"text-destructive-foreground":R?"text-foreground":"text-muted-foreground"}`,children:P(f.date,"d MMM")}),R?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`text-lg font-bold ${M?"text-destructive-foreground":"text-foreground"}`,children:j(f.price)}),I&&e.jsx("div",{className:"text-xs text-blue-600 font-bold mt-1 bg-blue-100 px-2 py-1 rounded",children:"CURRENT"}),F&&!M&&!I&&e.jsx("div",{className:"text-xs text-travel-gold font-bold mt-2 bg-travel-gold/10 px-2 py-1 rounded",children:"BEST PRICE"})]}):e.jsx("div",{className:"text-sm text-muted-foreground",children:N?"Loading...":"No flights"})]},S)})})})]})})},Tt=({flight:s,onSelectFare:t,showFareOptions:r=!0})=>{var y,N,m,w;const{formatCurrency:c}=be(),[o,g]=i.useState("economy"),h=x=>{if(typeof x=="string")return x;const b=Math.floor(x/60),p=x%60;return`${b}H ${p}Min`},n=(x,b)=>x===0?"Direct":b?`${x} Stop ${b}`:`${x} stop${x>1?"s":""}`,l=x=>x<=3?`Only ${x} left`:x<=9?`${x} seats left`:`${x}+ available`,j=x=>x.split(" ").map(b=>b[0]).join("").toUpperCase().slice(0,2),d=x=>{const b=x.currentTarget,p=b.nextElementSibling;p&&(b.style.display="none",p.style.display="flex")},u=s.fareOptions&&s.fareOptions.length>0?s.fareOptions.filter(x=>x.type.toLowerCase()==="economy"||x.type.toLowerCase()==="business"):[{type:"economy",price:typeof s.price=="number"?s.price:399,currency:s.currency||"USD",features:["Standard seat","Carry-on included"],seatsAvailable:12},{type:"business",price:typeof s.price=="number"?Math.round(s.price*3.2):1299,currency:s.currency||"USD",features:["Extra legroom","Premium service","Lounge access"],seatsAvailable:4}],v=x=>{const b=["SUN","MON","TUE","WED","THU","FRI","SAT"],p=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],f=x?new Date(x):new Date,S=b[f.getDay()],M=f.getDate(),F=p[f.getMonth()],R=f.getFullYear().toString().slice(-2);return`${S}, ${M} ${F} ${R}`};return e.jsx(U,{className:"mb-3 hover:shadow-lg transition-all duration-300 border border-border/30 w-full max-w-none",children:e.jsx("div",{className:"px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex-1 max-w-4xl",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex-shrink-0",children:[s.airlineLogo&&e.jsx("img",{src:s.airlineLogo,alt:`${s.airline} logo`,className:"w-8 h-8 object-contain",onError:d}),e.jsx("div",{className:"w-8 h-8 bg-muted rounded-full flex items-center justify-center text-xs font-bold",style:{display:s.airlineLogo?"none":"flex"},children:j(s.airline)})]}),e.jsx("div",{className:"bg-muted text-foreground px-2.5 py-1 rounded text-xs font-medium border",children:s.outboundFlightNumber||s.flightNumber})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-sm",children:s.airline}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.aircraft||"Aircraft Type"})]})]}),e.jsxs("div",{className:"flex items-center justify-between max-w-3xl",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:v((y=s.departure)==null?void 0:y.date)}),e.jsx("div",{className:"text-lg font-semibold text-foreground mb-1",children:((N=s.departure)==null?void 0:N.time)||s.departureTime}),e.jsx("div",{className:"text-base font-medium text-muted-foreground",children:s.origin})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center px-8",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:h(s.duration)}),e.jsx("div",{className:"w-full border-t-2 border-dotted border-muted-foreground/30 relative",children:e.jsx(V,{className:"h-4 w-4 text-muted-foreground absolute left-1/2 top-0 transform -translate-x-1/2 -translate-y-1/2 bg-background px-1 rotate-90"})}),e.jsx("div",{className:"text-xs text-muted-foreground mt-2 font-medium",children:n(s.stops,s.stopoverInfo)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:v((m=s.arrival)==null?void 0:m.date)}),e.jsx("div",{className:"text-lg font-semibold text-foreground mb-1",children:((w=s.arrival)==null?void 0:w.time)||s.arrivalTime}),e.jsx("div",{className:"text-base font-medium text-muted-foreground",children:s.destination})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs(C,{variant:"link",className:"text-destructive hover:text-destructive/80 p-0 h-auto text-sm font-medium",children:["View Flight Details",e.jsx(mt,{className:"h-3 w-3 ml-1"})]})})]}),e.jsx("div",{className:"ml-8 min-w-[320px]",children:r&&u.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-4",children:u.map((x,b)=>e.jsx("div",{className:"border border-border rounded-lg p-4 hover:border-primary/50 transition-all cursor-pointer min-h-[180px] flex flex-col",onClick:()=>g(x.type),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"text-center mb-3",children:e.jsx("h4",{className:"font-bold text-sm uppercase tracking-wide",children:x.type})}),x.seatsAvailable!==void 0&&x.seatsAvailable<=9&&e.jsx("div",{className:"bg-orange-500 text-white px-2 py-1 rounded text-xs font-bold text-center mb-3",children:l(x.seatsAvailable)}),e.jsxs("div",{className:"text-center mb-3 flex-1",children:[e.jsx("div",{className:"text-xl font-bold text-foreground",children:c(x.price,x.currency||s.currency||"USD")}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"per person"})]}),x.features&&x.features.length>0&&e.jsx("ul",{className:"text-xs text-muted-foreground space-y-1 mb-4",children:x.features.slice(0,2).map((p,f)=>e.jsxs("li",{className:"flex items-start space-x-1",children:[e.jsx("span",{className:"w-1 h-1 bg-primary rounded-full mt-1.5 flex-shrink-0"}),e.jsx("span",{children:p})]},f))}),t&&e.jsx(C,{className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold text-xs py-2 mt-auto",onClick:p=>{p.stopPropagation(),t(s,x)},children:"SELECT"})]})},b))})})]})})})},Ot=[{value:"price_asc",label:"Price: Low to High"},{value:"price_desc",label:"Price: High to Low"},{value:"duration_asc",label:"Duration"},{value:"departure_asc",label:"Departure: Earliest"},{value:"departure_desc",label:"Departure: Latest"},{value:"stops_asc",label:"Stops: Fewest"}],Bt=({sortBy:s,onSortChange:t,activeFilters:r,onRemoveFilter:c,onClearAllFilters:o,resultsCount:g,className:h})=>e.jsxs("div",{className:ye("bg-background sticky top-0 z-10 border-b border-border pb-4 mb-6",h),children:[e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-foreground",children:[g," flight",g!==1?"s":""," found"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Sort by:"}),e.jsxs(pe,{value:s,onValueChange:t,children:[e.jsx(he,{className:"w-[160px] border-border",children:e.jsx(fe,{placeholder:"Sort by"})}),e.jsx(ge,{children:Ot.map(n=>e.jsx(T,{value:n.value,children:n.label},n.value))})]})]})]}),e.jsxs(C,{variant:"outline",size:"sm",className:"border-border hover:border-primary",children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),"Filters"]})]}),r.length>0&&e.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-2 pt-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Active filters:"}),r.map(n=>e.jsxs(J,{variant:"secondary",className:"flex items-center space-x-1 pr-1",children:[e.jsx("span",{children:n.label}),n.removable!==!1&&e.jsx(C,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>c(n.key),children:e.jsx(Xs,{className:"h-3 w-3"})})]},n.key)),e.jsx(C,{variant:"ghost",size:"sm",onClick:o,className:"text-xs text-muted-foreground hover:text-foreground",children:"Clear all"})]})]}),Pr=()=>{const[s,t]=i.useState("roundtrip"),[r,c]=i.useState("SYD"),[o,g]=i.useState("MEL"),[h,n]=i.useState("Sydney (SYD)"),[l,j]=i.useState("Melbourne (MEL)"),[d,u]=i.useState(new Date),[v,y]=i.useState(new Date(Date.now()+7*24*60*60*1e3)),[N,m]=i.useState(1),[w,x]=i.useState(0),[b,p]=i.useState(0),[f,S]=i.useState("economy"),[M,F]=i.useState(!1),R=_e(),[I,O]=i.useState([{origin:"SYD",destination:"MEL",date:P(new Date,"yyyy-MM-dd")},{origin:"MEL",destination:"BNE",date:P(new Date(Date.now()+7*24*60*60*1e3),"yyyy-MM-dd")}]),[D,$]=i.useState([]),[B,ae]=i.useState(!1),[js,Ns]=i.useState("price_asc"),[we,Ce]=i.useState([]),[Re,vs]=i.useState([0,5e3]),[ne,Me]=i.useState([]),[Ee,Ie]=i.useState([]),[Fe,ys]=i.useState([]),[ie,bs]=i.useState(null),[kt,Ss]=i.useState(null),[ws,Cs]=i.useState(!1),[Rs,Pe]=i.useState(!1),[Ms,$t]=i.useState(null),Ae={origin:r,destination:o,departureDate:d?P(d,"yyyy-MM-dd"):"",returnDate:v?P(v,"yyyy-MM-dd"):void 0,passengers:N+w+b},Es=ws&&ie?{origin:o,destination:r,departureDate:v?P(v,"yyyy-MM-dd"):"",passengers:N+w+b}:Ae,{flights:X,loading:le,error:Y}=ft(Es);i.useEffect(()=>{r&&o&&d&&!M&&F(!0)},[r,o,d]);const q=()=>{F(!0),ae(!1)},Is=a=>{c(a.departure),g(a.destination),n(`${a.departureCity} (${a.departure})`),j(`${a.destinationCity} (${a.destination})`),F(!0)},Fs=a=>{c("SYD"),g(a.destination),n("Sydney (SYD)"),j(`${a.destinationCity} (${a.destination})`),a.departureDate&&u(new Date(a.departureDate)),F(!0)},Ue=a=>{c(a.code||a.id),n(a.code?`${a.city} (${a.code})`:a.name)},De=a=>{g(a.code||a.id),j(a.code?`${a.city} (${a.code})`:a.name)},Ps=(a,E)=>{const A={id:a.id,airline:a.airline,flightNumber:a.flightNumber,outboundFlightNumber:a.outboundFlightNumber,returnFlightNumber:a.returnFlightNumber,origin:a.origin,destination:a.destination,departureTime:a.departureTime,arrivalTime:a.arrivalTime,duration:a.duration,stops:a.stops,fareType:E.type,price:E.price,currency:E.currency||"AUD",date:P(d||new Date,"EEE, MMM dd"),segments:a.segments,amenities:a.amenities,amadeusOfferId:a.id,offerData:a};if(s==="roundtrip")if(ie){const L={...A,date:P(v||new Date,"EEE, MMM dd")};Ss({flight:a,fare:E}),sessionStorage.setItem("selectedInboundFlight",JSON.stringify(L)),R("/flight-booking-review")}else{bs({flight:a,fare:E}),sessionStorage.setItem("selectedOutboundFlight",JSON.stringify(A)),sessionStorage.setItem("tripType","roundtrip"),sessionStorage.setItem("searchCriteria",JSON.stringify(Ae)),Cs(!0);const L={origin:o,destination:r,departureDate:v?P(v,"yyyy-MM-dd"):"",passengers:N+w+b};sessionStorage.setItem("returnSearchCriteria",JSON.stringify(L))}else s==="multicity"?(Ls(0,{flight:a,fare:E}),D.length>=I.length-1&&(sessionStorage.setItem("multiCityFlights",JSON.stringify([...D,{segmentIndex:0,flight:{flight:a,fare:E}}])),sessionStorage.setItem("tripType","multicity"),R("/flight-booking-review"))):(sessionStorage.setItem("selectedOutboundFlight",JSON.stringify(A)),sessionStorage.setItem("tripType",s),R("/flight-booking-review"))},As=a=>{u(a),F(!0)},Us=()=>{ae(!B)},Ds=a=>{if(Ce(we.filter(E=>E.key!==a)),a.startsWith("airline-")){const E=a.replace("airline-","");Me(ne.filter(A=>A!==E))}else a==="stops"&&Ie([])},Le=()=>{Ce([]),Me([]),Ie([]),ys([]),vs([0,5e3])},Ls=(a,E)=>{const A=[...D],L=A.findIndex(Bs=>Bs.segmentIndex===a);L>=0?A[L]={segmentIndex:a,flight:E}:A.push({segmentIndex:a,flight:E}),$(A),A.length===I.length&&Pe(!0)},Ts=a=>({...a,outboundFlightNumber:a.outboundFlightNumber,returnFlightNumber:a.returnFlightNumber,departure:a.departure,arrival:a.arrival,stopoverInfo:a.stopoverInfo,fareOptions:[{type:"economy",price:a.price,currency:a.currency,features:["Standard seat","Carry-on bag","In-flight entertainment"],seatsAvailable:a.availableSeats},{type:"business",price:a.price*2.5,currency:a.currency,features:["Premium seat","Priority boarding","Meal included","Extra baggage"],seatsAvailable:Math.max(0,Math.floor(a.availableSeats/4))}],amenities:["WiFi","Meal","Entertainment"],duration:a.duration||120,stops:parseInt(a.stops)||0}),Q=X.map(Ts).filter(a=>{let E=0;if(typeof a.price=="number"?E=a.price:typeof a.price=="string"&&(E=parseFloat(a.price.replace(/[^0-9.]/g,""))),E>0&&(E<Re[0]||E>Re[1])||ne.length>0&&!ne.includes(a.airline))return!1;if(Ee.length>0){const A=typeof a.stops=="number"?a.stops:parseInt(a.stops),L=A===0?"nonstop":A===1?"1stop":"2+stops";if(!Ee.includes(L))return!1}return!(Fe.length>0&&!Fe.includes(a.cabin))}),oe=s==="roundtrip",Os=s==="multicity";return e.jsx(lt,{componentName:"FlightSearchPage",children:e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Qs,{}),M&&e.jsx(ot,{currentStep:1}),e.jsxs("div",{className:"container mx-auto px-4 py-8 space-y-6",children:[e.jsxs("div",{className:"bg-card border border-border rounded-lg p-4 mb-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Trip"}),e.jsxs(pe,{value:s,onValueChange:t,children:[e.jsx(he,{children:e.jsx(fe,{})}),e.jsxs(ge,{children:[e.jsx(T,{value:"oneway",children:"One-way"}),e.jsx(T,{value:"roundtrip",children:"Round trip"}),e.jsx(T,{value:"multicity",children:"Multi-city"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Passengers"}),e.jsxs(K,{children:[e.jsx(z,{asChild:!0,children:e.jsxs(C,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),N+w+b," passenger",N+w+b!==1?"s":""]})}),e.jsx(H,{className:"w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Adults"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{size:"sm",variant:"outline",onClick:()=>m(Math.max(1,N-1)),children:"-"}),e.jsx("span",{className:"w-8 text-center",children:N}),e.jsx(C,{size:"sm",variant:"outline",onClick:()=>m(N+1),children:"+"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Children"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{size:"sm",variant:"outline",onClick:()=>x(Math.max(0,w-1)),children:"-"}),e.jsx("span",{className:"w-8 text-center",children:w}),e.jsx(C,{size:"sm",variant:"outline",onClick:()=>x(w+1),children:"+"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Infants"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{size:"sm",variant:"outline",onClick:()=>p(Math.max(0,b-1)),children:"-"}),e.jsx("span",{className:"w-8 text-center",children:b}),e.jsx(C,{size:"sm",variant:"outline",onClick:()=>p(b+1),children:"+"})]})]})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Cabin"}),e.jsxs(pe,{value:f,onValueChange:S,children:[e.jsx(he,{children:e.jsx(fe,{})}),e.jsxs(ge,{children:[e.jsx(T,{value:"economy",children:"Economy"}),e.jsx(T,{value:"premium_economy",children:"Premium Economy"}),e.jsx(T,{value:"business",children:"Business"}),e.jsx(T,{value:"first",children:"First"})]})]})]})]}),Os?e.jsx("div",{className:"space-y-3",children:I.map((a,E)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 p-3 border rounded",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"From"}),e.jsx(de,{value:a.origin,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"To"}),e.jsx(de,{value:a.destination,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Date"}),e.jsx(de,{type:"date",value:a.date,readOnly:!0})]})]},E))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"From"}),e.jsx(Z,{value:h,onChange:n,onDestinationSelect:Ue,placeholder:"From where?",searchType:"airport"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"To"}),e.jsx(Z,{value:l,onChange:j,onDestinationSelect:De,placeholder:"Where to?",searchType:"airport"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Departure"}),e.jsxs(K,{children:[e.jsx(z,{asChild:!0,children:e.jsxs(C,{variant:"outline",className:"w-full justify-start",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),d?P(d,"MMM dd"):"Select date"]})}),e.jsx(H,{className:"w-auto p-0",children:e.jsx(ee,{mode:"single",selected:d,onSelect:u,initialFocus:!0,className:"pointer-events-auto"})})]})]}),oe&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Return"}),e.jsxs(K,{children:[e.jsx(z,{asChild:!0,children:e.jsxs(C,{variant:"outline",className:"w-full justify-start",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),v?P(v,"MMM dd"):"Select date"]})}),e.jsx(H,{className:"w-auto p-0",children:e.jsx(ee,{mode:"single",selected:v,onSelect:y,initialFocus:!0,className:"pointer-events-auto"})})]})]})]}),e.jsxs(C,{onClick:q,className:"w-full md:w-auto",children:[e.jsx(xt,{className:"h-4 w-4 mr-2"}),"Search flights"]})]}),M?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Dt,{origin:r,destination:o,departureDate:d,returnDate:oe?v:void 0,passengers:N+w+b,tripType:s,onModify:Us}),!B&&e.jsxs(e.Fragment,{children:[e.jsx(Lt,{selectedDate:d,onDateSelect:As,origin:r,destination:o,passengers:N+w+b,cabin:f}),e.jsx(Bt,{sortBy:js,onSortChange:Ns,activeFilters:we,onRemoveFilter:Ds,onClearAllFilters:Le,resultsCount:Q.length})]})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsx(Ft,{onRouteSelect:Is,origin:r}),e.jsx(Ut,{onDealSelect:Fs,origin:r})]}),M&&B&&e.jsxs(U,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Modify your search"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"From"}),e.jsx(Z,{value:h,onChange:n,onDestinationSelect:Ue,placeholder:"From where?",searchType:"airport"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"To"}),e.jsx(Z,{value:l,onChange:j,onDestinationSelect:De,placeholder:"Where to?",searchType:"airport"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Departure"}),e.jsxs(K,{children:[e.jsx(z,{asChild:!0,children:e.jsxs(C,{variant:"outline",className:"w-full justify-start",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),d?P(d,"MMM dd"):"Select date"]})}),e.jsx(H,{className:"w-auto p-0",children:e.jsx(ee,{mode:"single",selected:d,onSelect:u,initialFocus:!0,className:"pointer-events-auto"})})]})]}),oe&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Return"}),e.jsxs(K,{children:[e.jsx(z,{asChild:!0,children:e.jsxs(C,{variant:"outline",className:"w-full justify-start",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),v?P(v,"MMM dd"):"Select date"]})}),e.jsx(H,{className:"w-auto p-0",children:e.jsx(ee,{mode:"single",selected:v,onSelect:y,initialFocus:!0,className:"pointer-events-auto"})})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(C,{onClick:q,children:"Update Search"}),e.jsx(C,{variant:"outline",onClick:()=>ae(!1),children:"Cancel"})]})]}),le&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-primary mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Searching flights..."}),e.jsx("p",{className:"text-muted-foreground",children:"Finding the best options for your trip"})]}),Y&&!le&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(qs,{className:"h-16 w-16 text-destructive mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:Y.includes("temporarily unavailable")?"Service Temporarily Unavailable":"Search Error"}),e.jsxs("div",{className:"mb-4 space-y-2",children:[e.jsx("p",{className:"text-muted-foreground",children:Y}),Y.includes("temporarily unavailable")&&e.jsx("div",{className:"bg-amber-50 dark:bg-amber-950 border border-amber-200 dark:border-amber-800 rounded-lg p-4 mx-auto max-w-md",children:e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:"Our flight search providers are experiencing temporary issues. This usually resolves within a few minutes."})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsx(C,{onClick:q,variant:"outline",children:"Try Again"}),e.jsx(C,{onClick:()=>window.location.reload(),variant:"ghost",className:"text-sm",children:"Refresh Page"})]}),Y.includes("temporarily unavailable")&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-4",children:["Last attempt: ",new Date().toLocaleTimeString()]})]}),M&&!B&&!le&&!Y&&e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-4 text-sm text-muted-foreground",children:["Showing ",Q.length," of ",X.length," flights"]}),Q.map((a,E)=>e.jsx(Tt,{flight:a,onSelectFare:Ps,showFareOptions:!0},`${a.id}-${E}`)),Q.length===0&&X.length>0&&e.jsxs(U,{className:"p-12 text-center",children:[e.jsx(V,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No flights match your filters"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your price range or filter criteria."}),e.jsx(C,{onClick:Le,variant:"outline",children:"Clear Filters"})]}),X.length===0&&e.jsxs(U,{className:"p-12 text-center",children:[e.jsx(V,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No flights found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Try different dates or destinations."}),e.jsx(C,{onClick:q,variant:"outline",children:"Search Again"})]})]})})]}),e.jsx(Et,{open:Rs,onOpenChange:Pe,flight:Ms,outbound:ie,tripType:s,multiCitySelections:D})]})})};export{Pr as default};
