import{c as Zs,bE as Gs,r as S,a$ as qs,ao as k,a2 as hn,ag as _e,j as C,k as Tt,n as At,o as $t,B as Se,I as sr,R as Xr,l as zt,au as Ks,C as Js,X as Qs,ac as ir,p as Nn,v as ar}from"./index-sjMrv3Ur-1758787615240.js";import{S as ei}from"./separator-Dkfs-3lo-1758787615240.js";import{C as ti,a as ni,b as ri}from"./collapsible-oHcehRA6-1758787615240.js";import{D as oi,f as si,a as ii,b as ai,c as ci,d as li,e as ui}from"./dialog-UfzsA5JK-1758787615240.js";import{L as cr}from"./label-BgKM8khV-1758787615240.js";import{T as fi}from"./textarea-DcrZb0w5-1758787615240.js";import{T as di,a as hi,b as mn,c as pn}from"./tabs-O1Phtj_U-1758787615240.js";import{i as Xe,a as lr,b as mi,d as ur}from"./string-D4TST8LD-1758787615240.js";import{S as pi}from"./search-DF0qoHZs-1758787615240.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gi=Zs("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var fr=180/Math.PI,bn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Wr(e,t,n,r,o,i){var s,a,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*fr,skewX:Math.atan(c)*fr,scaleX:s,scaleY:a}}var It;function yi(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?bn:Wr(t.a,t.b,t.c,t.d,t.e,t.f)}function wi(e){return e==null||(It||(It=document.createElementNS("http://www.w3.org/2000/svg","g")),It.setAttribute("transform",e),!(e=It.transform.baseVal.consolidate()))?bn:(e=e.matrix,Wr(e.a,e.b,e.c,e.d,e.e,e.f))}function Ur(e,t,n,r){function o(u){return u.length?u.pop()+" ":""}function i(u,l,f,d,m,y){if(u!==f||l!==d){var p=m.push("translate(",null,t,null,n);y.push({i:p-4,x:Xe(u,f)},{i:p-2,x:Xe(l,d)})}else(f||d)&&m.push("translate("+f+t+d+n)}function s(u,l,f,d){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),d.push({i:f.push(o(f)+"rotate(",null,r)-2,x:Xe(u,l)})):l&&f.push(o(f)+"rotate("+l+r)}function a(u,l,f,d){u!==l?d.push({i:f.push(o(f)+"skewX(",null,r)-2,x:Xe(u,l)}):l&&f.push(o(f)+"skewX("+l+r)}function c(u,l,f,d,m,y){if(u!==f||l!==d){var p=m.push(o(m)+"scale(",null,",",null,")");y.push({i:p-4,x:Xe(u,f)},{i:p-2,x:Xe(l,d)})}else(f!==1||d!==1)&&m.push(o(m)+"scale("+f+","+d+")")}return function(u,l){var f=[],d=[];return u=e(u),l=e(l),i(u.translateX,u.translateY,l.translateX,l.translateY,f,d),s(u.rotate,l.rotate,f,d),a(u.skewX,l.skewX,f,d),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,f,d),u=l=null,function(m){for(var y=-1,p=d.length,E;++y<p;)f[(E=d[y]).i]=E.x(m);return f.join("")}}}var xi=Ur(yi,"px, ","px)","deg)"),vi=Ur(wi,", ",")",")"),_i=1e-12;function dr(e){return((e=Math.exp(e))+1/e)/2}function Si(e){return((e=Math.exp(e))-1/e)/2}function Ei(e){return((e=Math.exp(2*e))-1)/(e+1)}const Ni=function e(t,n,r){function o(i,s){var a=i[0],c=i[1],u=i[2],l=s[0],f=s[1],d=s[2],m=l-a,y=f-c,p=m*m+y*y,E,g;if(p<_i)g=Math.log(d/u)/t,E=function(V){return[a+V*m,c+V*y,u*Math.exp(t*V*g)]};else{var b=Math.sqrt(p),M=(d*d-u*u+r*p)/(2*u*n*b),x=(d*d-u*u-r*p)/(2*d*n*b),$=Math.log(Math.sqrt(M*M+1)-M),I=Math.log(Math.sqrt(x*x+1)-x);g=(I-$)/t,E=function(V){var O=V*g,D=dr($),H=u/(n*b)*(D*Ei(t*O+$)-Si($));return[a+H*m,c+H*y,u*D/dr(t*O+$)]}}return E.duration=g*1e3*t/Math.SQRT2,E}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,c=a*a;return e(s,a,c)},o}(Math.SQRT2,2,4);function le(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=le(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Zr={exports:{}},Gr={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kt=S,bi=Gs;function Ci(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ki=typeof Object.is=="function"?Object.is:Ci,Mi=bi.useSyncExternalStore,Ti=Kt.useRef,Ai=Kt.useEffect,$i=Kt.useMemo,zi=Kt.useDebugValue;Gr.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var i=Ti(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=$i(function(){function c(m){if(!u){if(u=!0,l=m,m=r(m),o!==void 0&&s.hasValue){var y=s.value;if(o(y,m))return f=y}return f=m}if(y=f,ki(l,m))return y;var p=r(m);return o!==void 0&&o(y,p)?(l=m,y):(l=m,f=p)}var u=!1,l,f,d=n===void 0?null:n;return[function(){return c(t())},d===null?void 0:function(){return c(d())}]},[t,n,r,o]);var a=Mi(e,i[0],i[1]);return Ai(function(){s.hasValue=!0,s.value=a},[a]),zi(a),a};Zr.exports=Gr;var Ii=Zr.exports;const Di=qs(Ii),Ri={},hr=e=>{let t;const n=new Set,r=(l,f)=>{const d=typeof l=="function"?l(t):l;if(!Object.is(d,t)){const m=t;t=(f!=null?f:typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(y=>y(t,m))}},o=()=>t,c={setState:r,getState:o,getInitialState:()=>u,subscribe:l=>(n.add(l),()=>n.delete(l)),destroy:()=>{(Ri?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,o,c);return c},Pi=e=>e?hr(e):hr,{useDebugValue:Hi}=k,{useSyncExternalStoreWithSelector:Li}=Di,Vi=e=>e;function qr(e,t=Vi,n){const r=Li(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Hi(r),r}const mr=(e,t)=>{const n=Pi(e),r=(o,i=t)=>qr(n,o,i);return Object.assign(r,n),r},Oi=(e,t)=>e?mr(e,t):mr;function de(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var Fi={value:()=>{}};function Jt(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ot(n)}function Ot(e){this._=e}function Bi(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ot.prototype=Jt.prototype={constructor:Ot,on:function(e,t){var n=this._,r=Bi(e+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(e=r[i]).type)&&(o=ji(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(o=(e=r[i]).type)n[o]=pr(n[o],e.name,t);else if(t==null)for(o in n)n[o]=pr(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ot(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};function ji(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function pr(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Fi,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Cn="http://www.w3.org/1999/xhtml";const gr={svg:"http://www.w3.org/2000/svg",xhtml:Cn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Qt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),gr.hasOwnProperty(t)?{space:gr[t],local:e}:e}function Yi(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Cn&&t.documentElement.namespaceURI===Cn?t.createElement(e):t.createElementNS(n,e)}}function Xi(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Kr(e){var t=Qt(e);return(t.local?Xi:Yi)(t)}function Wi(){}function Vn(e){return e==null?Wi:function(){return this.querySelector(e)}}function Ui(e){typeof e!="function"&&(e=Vn(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=new Array(s),c,u,l=0;l<s;++l)(c=i[l])&&(u=e.call(c,c.__data__,l,i))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new he(r,this._parents)}function Zi(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Gi(){return[]}function Jr(e){return e==null?Gi:function(){return this.querySelectorAll(e)}}function qi(e){return function(){return Zi(e.apply(this,arguments))}}function Ki(e){typeof e=="function"?e=qi(e):e=Jr(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s=t[i],a=s.length,c,u=0;u<a;++u)(c=s[u])&&(r.push(e.call(c,c.__data__,u,s)),o.push(c));return new he(r,o)}function Qr(e){return function(){return this.matches(e)}}function eo(e){return function(t){return t.matches(e)}}var Ji=Array.prototype.find;function Qi(e){return function(){return Ji.call(this.children,e)}}function ea(){return this.firstElementChild}function ta(e){return this.select(e==null?ea:Qi(typeof e=="function"?e:eo(e)))}var na=Array.prototype.filter;function ra(){return Array.from(this.children)}function oa(e){return function(){return na.call(this.children,e)}}function sa(e){return this.selectAll(e==null?ra:oa(typeof e=="function"?e:eo(e)))}function ia(e){typeof e!="function"&&(e=Qr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],c,u=0;u<s;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&a.push(c);return new he(r,this._parents)}function to(e){return new Array(e.length)}function aa(){return new he(this._enter||this._groups.map(to),this._parents)}function Yt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Yt.prototype={constructor:Yt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function ca(e){return function(){return e}}function la(e,t,n,r,o,i){for(var s=0,a,c=t.length,u=i.length;s<u;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new Yt(e,i[s]);for(;s<c;++s)(a=t[s])&&(o[s]=a)}function ua(e,t,n,r,o,i,s){var a,c,u=new Map,l=t.length,f=i.length,d=new Array(l),m;for(a=0;a<l;++a)(c=t[a])&&(d[a]=m=s.call(c,c.__data__,a,t)+"",u.has(m)?o[a]=c:u.set(m,c));for(a=0;a<f;++a)m=s.call(e,i[a],a,i)+"",(c=u.get(m))?(r[a]=c,c.__data__=i[a],u.delete(m)):n[a]=new Yt(e,i[a]);for(a=0;a<l;++a)(c=t[a])&&u.get(d[a])===c&&(o[a]=c)}function fa(e){return e.__data__}function da(e,t){if(!arguments.length)return Array.from(this,fa);var n=t?ua:la,r=this._parents,o=this._groups;typeof e!="function"&&(e=ca(e));for(var i=o.length,s=new Array(i),a=new Array(i),c=new Array(i),u=0;u<i;++u){var l=r[u],f=o[u],d=f.length,m=ha(e.call(l,l&&l.__data__,u,r)),y=m.length,p=a[u]=new Array(y),E=s[u]=new Array(y),g=c[u]=new Array(d);n(l,f,p,E,g,m,t);for(var b=0,M=0,x,$;b<y;++b)if(x=p[b]){for(b>=M&&(M=b+1);!($=E[M])&&++M<y;);x._next=$||null}}return s=new he(s,r),s._enter=a,s._exit=c,s}function ha(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ma(){return new he(this._exit||this._groups.map(to),this._parents)}function pa(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function ga(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),c=0;c<s;++c)for(var u=n[c],l=r[c],f=u.length,d=a[c]=new Array(f),m,y=0;y<f;++y)(m=u[y]||l[y])&&(d[y]=m);for(;c<o;++c)a[c]=n[c];return new he(a,this._parents)}function ya(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function wa(e){e||(e=xa);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],a=s.length,c=o[i]=new Array(a),u,l=0;l<a;++l)(u=s[l])&&(c[l]=u);c.sort(t)}return new he(o,this._parents).order()}function xa(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function va(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function _a(){return Array.from(this)}function Sa(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function Ea(){let e=0;for(const t of this)++e;return e}function Na(){return!this.node()}function ba(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,s=o.length,a;i<s;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this}function Ca(e){return function(){this.removeAttribute(e)}}function ka(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ma(e,t){return function(){this.setAttribute(e,t)}}function Ta(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Aa(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function $a(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function za(e,t){var n=Qt(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?ka:Ca:typeof t=="function"?n.local?$a:Aa:n.local?Ta:Ma)(n,t))}function no(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ia(e){return function(){this.style.removeProperty(e)}}function Da(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ra(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Pa(e,t,n){return arguments.length>1?this.each((t==null?Ia:typeof t=="function"?Ra:Da)(e,t,n==null?"":n)):ct(this.node(),e)}function ct(e,t){return e.style.getPropertyValue(t)||no(e).getComputedStyle(e,null).getPropertyValue(t)}function Ha(e){return function(){delete this[e]}}function La(e,t){return function(){this[e]=t}}function Va(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Oa(e,t){return arguments.length>1?this.each((t==null?Ha:typeof t=="function"?Va:La)(e,t)):this.node()[e]}function ro(e){return e.trim().split(/^|\s+/)}function On(e){return e.classList||new oo(e)}function oo(e){this._node=e,this._names=ro(e.getAttribute("class")||"")}oo.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function so(e,t){for(var n=On(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function io(e,t){for(var n=On(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Fa(e){return function(){so(this,e)}}function Ba(e){return function(){io(this,e)}}function ja(e,t){return function(){(t.apply(this,arguments)?so:io)(this,e)}}function Ya(e,t){var n=ro(e+"");if(arguments.length<2){for(var r=On(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?ja:t?Fa:Ba)(n,t))}function Xa(){this.textContent=""}function Wa(e){return function(){this.textContent=e}}function Ua(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function Za(e){return arguments.length?this.each(e==null?Xa:(typeof e=="function"?Ua:Wa)(e)):this.node().textContent}function Ga(){this.innerHTML=""}function qa(e){return function(){this.innerHTML=e}}function Ka(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function Ja(e){return arguments.length?this.each(e==null?Ga:(typeof e=="function"?Ka:qa)(e)):this.node().innerHTML}function Qa(){this.nextSibling&&this.parentNode.appendChild(this)}function ec(){return this.each(Qa)}function tc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function nc(){return this.each(tc)}function rc(e){var t=typeof e=="function"?e:Kr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function oc(){return null}function sc(e,t){var n=typeof e=="function"?e:Kr(e),r=t==null?oc:typeof t=="function"?t:Vn(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ic(){var e=this.parentNode;e&&e.removeChild(this)}function ac(){return this.each(ic)}function cc(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function lc(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function uc(e){return this.select(e?lc:cc)}function fc(e){return arguments.length?this.property("__data__",e):this.node().__data__}function dc(e){return function(t){e.call(this,t,this.__data__)}}function hc(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function mc(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function pc(e,t,n){return function(){var r=this.__on,o,i=dc(t);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function gc(e,t,n){var r=hc(e+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(o=0,l=a[c];o<i;++o)if((s=r[o]).type===l.type&&s.name===l.name)return l.value}return}for(a=t?pc:mc,o=0;o<i;++o)this.each(a(r[o],t,n));return this}function ao(e,t,n){var r=no(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function yc(e,t){return function(){return ao(this,e,t)}}function wc(e,t){return function(){return ao(this,e,t.apply(this,arguments))}}function xc(e,t){return this.each((typeof t=="function"?wc:yc)(e,t))}function*vc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var co=[null];function he(e,t){this._groups=e,this._parents=t}function kt(){return new he([[document.documentElement]],co)}function _c(){return this}he.prototype=kt.prototype={constructor:he,select:Ui,selectAll:Ki,selectChild:ta,selectChildren:sa,filter:ia,data:da,enter:aa,exit:ma,join:pa,merge:ga,selection:_c,order:ya,sort:wa,call:va,nodes:_a,node:Sa,size:Ea,empty:Na,each:ba,attr:za,style:Pa,property:Oa,classed:Ya,text:Za,html:Ja,raise:ec,lower:nc,append:rc,insert:sc,remove:ac,clone:uc,datum:fc,on:gc,dispatch:xc,[Symbol.iterator]:vc};function me(e){return typeof e=="string"?new he([[document.querySelector(e)]],[document.documentElement]):new he([[e]],co)}function Sc(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ye(e,t){if(e=Sc(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Ec={passive:!1},St={capture:!0,passive:!1};function gn(e){e.stopImmediatePropagation()}function it(e){e.preventDefault(),e.stopImmediatePropagation()}function lo(e){var t=e.document.documentElement,n=me(e).on("dragstart.drag",it,St);"onselectstart"in t?n.on("selectstart.drag",it,St):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function uo(e,t){var n=e.document.documentElement,r=me(e).on("dragstart.drag",null);t&&(r.on("click.drag",it,St),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Dt=e=>()=>e;function kn(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}kn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Nc(e){return!e.ctrlKey&&!e.button}function bc(){return this.parentNode}function Cc(e,t){return t==null?{x:e.x,y:e.y}:t}function kc(){return navigator.maxTouchPoints||"ontouchstart"in this}function Mc(){var e=Nc,t=bc,n=Cc,r=kc,o={},i=Jt("start","drag","end"),s=0,a,c,u,l,f=0;function d(x){x.on("mousedown.drag",m).filter(r).on("touchstart.drag",E).on("touchmove.drag",g,Ec).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(x,$){if(!(l||!e.call(this,x,$))){var I=M(this,t.call(this,x,$),x,$,"mouse");I&&(me(x.view).on("mousemove.drag",y,St).on("mouseup.drag",p,St),lo(x.view),gn(x),u=!1,a=x.clientX,c=x.clientY,I("start",x))}}function y(x){if(it(x),!u){var $=x.clientX-a,I=x.clientY-c;u=$*$+I*I>f}o.mouse("drag",x)}function p(x){me(x.view).on("mousemove.drag mouseup.drag",null),uo(x.view,u),it(x),o.mouse("end",x)}function E(x,$){if(e.call(this,x,$)){var I=x.changedTouches,V=t.call(this,x,$),O=I.length,D,H;for(D=0;D<O;++D)(H=M(this,V,x,$,I[D].identifier,I[D]))&&(gn(x),H("start",x,I[D]))}}function g(x){var $=x.changedTouches,I=$.length,V,O;for(V=0;V<I;++V)(O=o[$[V].identifier])&&(it(x),O("drag",x,$[V]))}function b(x){var $=x.changedTouches,I=$.length,V,O;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),V=0;V<I;++V)(O=o[$[V].identifier])&&(gn(x),O("end",x,$[V]))}function M(x,$,I,V,O,D){var H=i.copy(),P=ye(D||I,$),F,L,h;if((h=n.call(x,new kn("beforestart",{sourceEvent:I,target:d,identifier:O,active:s,x:P[0],y:P[1],dx:0,dy:0,dispatch:H}),V))!=null)return F=h.x-P[0]||0,L=h.y-P[1]||0,function N(w,z,R){var _=P,v;switch(w){case"start":o[O]=N,v=s++;break;case"end":delete o[O],--s;case"drag":P=ye(R||z,$),v=s;break}H.call(w,x,new kn(w,{sourceEvent:z,subject:h,target:d,identifier:O,active:v,x:P[0]+F,y:P[1]+L,dx:P[0]-_[0],dy:P[1]-_[1],dispatch:H}),V)}}return d.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Dt(!!x),d):e},d.container=function(x){return arguments.length?(t=typeof x=="function"?x:Dt(x),d):t},d.subject=function(x){return arguments.length?(n=typeof x=="function"?x:Dt(x),d):n},d.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:Dt(!!x),d):r},d.on=function(){var x=i.on.apply(i,arguments);return x===i?d:x},d.clickDistance=function(x){return arguments.length?(f=(x=+x)*x,d):Math.sqrt(f)},d}var lt=0,xt=0,mt=0,fo=1e3,Xt,vt,Wt=0,Ge=0,en=0,Et=typeof performance=="object"&&performance.now?performance:Date,ho=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Fn(){return Ge||(ho(Tc),Ge=Et.now()+en)}function Tc(){Ge=0}function Ut(){this._call=this._time=this._next=null}Ut.prototype=mo.prototype={constructor:Ut,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Fn():+n)+(t==null?0:+t),!this._next&&vt!==this&&(vt?vt._next=this:Xt=this,vt=this),this._call=e,this._time=n,Mn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Mn())}};function mo(e,t,n){var r=new Ut;return r.restart(e,t,n),r}function Ac(){Fn(),++lt;for(var e=Xt,t;e;)(t=Ge-e._time)>=0&&e._call.call(void 0,t),e=e._next;--lt}function yr(){Ge=(Wt=Et.now())+en,lt=xt=0;try{Ac()}finally{lt=0,zc(),Ge=0}}function $c(){var e=Et.now(),t=e-Wt;t>fo&&(en-=t,Wt=e)}function zc(){for(var e,t=Xt,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Xt=n);vt=e,Mn(r)}function Mn(e){if(!lt){xt&&(xt=clearTimeout(xt));var t=e-Ge;t>24?(e<1/0&&(xt=setTimeout(yr,e-Et.now()-en)),mt&&(mt=clearInterval(mt))):(mt||(Wt=Et.now(),mt=setInterval($c,fo)),lt=1,ho(yr))}}function wr(e,t,n){var r=new Ut;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var Ic=Jt("start","end","cancel","interrupt"),Dc=[],po=0,xr=1,Tn=2,Ft=3,vr=4,An=5,Bt=6;function tn(e,t,n,r,o,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;Rc(e,n,{name:t,index:r,group:o,on:Ic,tween:Dc,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:po})}function Bn(e,t){var n=xe(e,t);if(n.state>po)throw new Error("too late; already scheduled");return n}function Ne(e,t){var n=xe(e,t);if(n.state>Ft)throw new Error("too late; already running");return n}function xe(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Rc(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=mo(i,0,n.time);function i(u){n.state=xr,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var l,f,d,m;if(n.state!==xr)return c();for(l in r)if(m=r[l],m.name===n.name){if(m.state===Ft)return wr(s);m.state===vr?(m.state=Bt,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[l]):+l<t&&(m.state=Bt,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[l])}if(wr(function(){n.state===Ft&&(n.state=vr,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=Tn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Tn){for(n.state=Ft,o=new Array(d=n.tween.length),l=0,f=-1;l<d;++l)(m=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(o[++f]=m);o.length=f+1}}function a(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=An,1),f=-1,d=o.length;++f<d;)o[f].call(e,l);n.state===An&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Bt,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function jt(e,t){var n=e.__transition,r,o,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){i=!1;continue}o=r.state>Tn&&r.state<An,r.state=Bt,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}i&&delete e.__transition}}function Pc(e){return this.each(function(){jt(this,e)})}function Hc(e,t){var n,r;return function(){var o=Ne(this,e),i=o.tween;if(i!==n){r=n=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function Lc(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=Ne(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:t,value:n},c=0,u=o.length;c<u;++c)if(o[c].name===t){o[c]=a;break}c===u&&o.push(a)}i.tween=o}}function Vc(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=xe(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===e)return s.value;return null}return this.each((t==null?Hc:Lc)(n,e,t))}function jn(e,t,n){var r=e._id;return e.each(function(){var o=Ne(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return xe(o,r).value[t]}}function go(e,t){var n;return(typeof t=="number"?Xe:t instanceof ur?lr:(n=ur(t))?(t=n,lr):mi)(e,t)}function Oc(e){return function(){this.removeAttribute(e)}}function Fc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Bc(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function jc(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function Yc(e,t,n){var r,o,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a)))}}function Xc(e,t,n){var r,o,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a)))}}function Wc(e,t){var n=Qt(e),r=n==="transform"?vi:go;return this.attrTween(e,typeof t=="function"?(n.local?Xc:Yc)(n,r,jn(this,"attr."+e,t)):t==null?(n.local?Fc:Oc)(n):(n.local?jc:Bc)(n,r,t))}function Uc(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Zc(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Gc(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Zc(e,i)),n}return o._value=t,o}function qc(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Uc(e,i)),n}return o._value=t,o}function Kc(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Qt(e);return this.tween(n,(r.local?Gc:qc)(r,t))}function Jc(e,t){return function(){Bn(this,e).delay=+t.apply(this,arguments)}}function Qc(e,t){return t=+t,function(){Bn(this,e).delay=t}}function el(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Jc:Qc)(t,e)):xe(this.node(),t).delay}function tl(e,t){return function(){Ne(this,e).duration=+t.apply(this,arguments)}}function nl(e,t){return t=+t,function(){Ne(this,e).duration=t}}function rl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?tl:nl)(t,e)):xe(this.node(),t).duration}function ol(e,t){if(typeof t!="function")throw new Error;return function(){Ne(this,e).ease=t}}function sl(e){var t=this._id;return arguments.length?this.each(ol(t,e)):xe(this.node(),t).ease}function il(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ne(this,e).ease=n}}function al(e){if(typeof e!="function")throw new Error;return this.each(il(this._id,e))}function cl(e){typeof e!="function"&&(e=Qr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],c,u=0;u<s;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&a.push(c);return new $e(r,this._parents,this._name,this._id)}function ll(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var c=t[a],u=n[a],l=c.length,f=s[a]=new Array(l),d,m=0;m<l;++m)(d=c[m]||u[m])&&(f[m]=d);for(;a<r;++a)s[a]=t[a];return new $e(s,this._parents,this._name,this._id)}function ul(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function fl(e,t,n){var r,o,i=ul(t)?Bn:Ne;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(t,n),s.on=o}}function dl(e,t){var n=this._id;return arguments.length<2?xe(this.node(),n).on.on(e):this.each(fl(n,e,t))}function hl(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function ml(){return this.on("end.remove",hl(this._id))}function pl(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Vn(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],c=a.length,u=i[s]=new Array(c),l,f,d=0;d<c;++d)(l=a[d])&&(f=e.call(l,l.__data__,d,a))&&("__data__"in l&&(f.__data__=l.__data__),u[d]=f,tn(u[d],t,n,d,u,xe(l,n)));return new $e(i,this._parents,t,n)}function gl(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Jr(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var c=r[a],u=c.length,l,f=0;f<u;++f)if(l=c[f]){for(var d=e.call(l,l.__data__,f,c),m,y=xe(l,n),p=0,E=d.length;p<E;++p)(m=d[p])&&tn(m,t,n,p,d,y);i.push(d),s.push(l)}return new $e(i,s,t,n)}var yl=kt.prototype.constructor;function wl(){return new yl(this._groups,this._parents)}function xl(e,t){var n,r,o;return function(){var i=ct(this,e),s=(this.style.removeProperty(e),ct(this,e));return i===s?null:i===n&&s===r?o:o=t(n=i,r=s)}}function yo(e){return function(){this.style.removeProperty(e)}}function vl(e,t,n){var r,o=n+"",i;return function(){var s=ct(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}function _l(e,t,n){var r,o,i;return function(){var s=ct(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),ct(this,e))),s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a))}}function Sl(e,t){var n,r,o,i="style."+t,s="end."+i,a;return function(){var c=Ne(this,e),u=c.on,l=c.value[i]==null?a||(a=yo(t)):void 0;(u!==n||o!==l)&&(r=(n=u).copy()).on(s,o=l),c.on=r}}function El(e,t,n){var r=(e+="")=="transform"?xi:go;return t==null?this.styleTween(e,xl(e,r)).on("end.style."+e,yo(e)):typeof t=="function"?this.styleTween(e,_l(e,r,jn(this,"style."+e,t))).each(Sl(this._id,e)):this.styleTween(e,vl(e,r,t),n).on("end.style."+e,null)}function Nl(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function bl(e,t,n){var r,o;function i(){var s=t.apply(this,arguments);return s!==o&&(r=(o=s)&&Nl(e,s,n)),r}return i._value=t,i}function Cl(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,bl(e,t,n==null?"":n))}function kl(e){return function(){this.textContent=e}}function Ml(e){return function(){var t=e(this);this.textContent=t==null?"":t}}function Tl(e){return this.tween("text",typeof e=="function"?Ml(jn(this,"text",e)):kl(e==null?"":e+""))}function Al(e){return function(t){this.textContent=e.call(this,t)}}function $l(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&Al(o)),t}return r._value=e,r}function zl(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,$l(e))}function Il(){for(var e=this._name,t=this._id,n=wo(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,u=0;u<a;++u)if(c=s[u]){var l=xe(c,t);tn(c,e,n,u,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new $e(r,this._parents,e,n)}function Dl(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},c={value:function(){--o===0&&i()}};n.each(function(){var u=Ne(this,r),l=u.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),u.on=t}),o===0&&i()})}var Rl=0;function $e(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function wo(){return++Rl}var Me=kt.prototype;$e.prototype={constructor:$e,select:pl,selectAll:gl,selectChild:Me.selectChild,selectChildren:Me.selectChildren,filter:cl,merge:ll,selection:wl,transition:Il,call:Me.call,nodes:Me.nodes,node:Me.node,size:Me.size,empty:Me.empty,each:Me.each,on:dl,attr:Wc,attrTween:Kc,style:El,styleTween:Cl,text:Tl,textTween:zl,remove:ml,tween:Vc,delay:el,duration:rl,ease:sl,easeVarying:al,end:Dl,[Symbol.iterator]:Me[Symbol.iterator]};function Pl(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Hl={time:null,delay:0,duration:250,ease:Pl};function Ll(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Vl(e){var t,n;e instanceof $e?(t=e._id,e=e._name):(t=wo(),(n=Hl).time=Fn(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,u=0;u<a;++u)(c=s[u])&&tn(c,e,t,u,s,n||Ll(c,t));return new $e(r,this._parents,e,t)}kt.prototype.interrupt=Pc;kt.prototype.transition=Vl;const Rt=e=>()=>e;function Ol(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Te(e,t,n){this.k=e,this.x=t,this.y=n}Te.prototype={constructor:Te,scale:function(e){return e===1?this:new Te(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Te(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ae=new Te(1,0,0);Te.prototype;function yn(e){e.stopImmediatePropagation()}function pt(e){e.preventDefault(),e.stopImmediatePropagation()}function Fl(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Bl(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function _r(){return this.__zoom||Ae}function jl(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Yl(){return navigator.maxTouchPoints||"ontouchstart"in this}function Xl(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function xo(){var e=Fl,t=Bl,n=Xl,r=jl,o=Yl,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=Ni,u=Jt("start","zoom","end"),l,f,d,m=500,y=150,p=0,E=10;function g(h){h.property("__zoom",_r).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",H).filter(o).on("touchstart.zoom",P).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(h,N,w,z){var R=h.selection?h.selection():h;R.property("__zoom",_r),h!==R?$(h,N,w,z):R.interrupt().each(function(){I(this,arguments).event(z).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},g.scaleBy=function(h,N,w,z){g.scaleTo(h,function(){var R=this.__zoom.k,_=typeof N=="function"?N.apply(this,arguments):N;return R*_},w,z)},g.scaleTo=function(h,N,w,z){g.transform(h,function(){var R=t.apply(this,arguments),_=this.__zoom,v=w==null?x(R):typeof w=="function"?w.apply(this,arguments):w,A=_.invert(v),T=typeof N=="function"?N.apply(this,arguments):N;return n(M(b(_,T),v,A),R,s)},w,z)},g.translateBy=function(h,N,w,z){g.transform(h,function(){return n(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof w=="function"?w.apply(this,arguments):w),t.apply(this,arguments),s)},null,z)},g.translateTo=function(h,N,w,z,R){g.transform(h,function(){var _=t.apply(this,arguments),v=this.__zoom,A=z==null?x(_):typeof z=="function"?z.apply(this,arguments):z;return n(Ae.translate(A[0],A[1]).scale(v.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof w=="function"?-w.apply(this,arguments):-w),_,s)},z,R)};function b(h,N){return N=Math.max(i[0],Math.min(i[1],N)),N===h.k?h:new Te(N,h.x,h.y)}function M(h,N,w){var z=N[0]-w[0]*h.k,R=N[1]-w[1]*h.k;return z===h.x&&R===h.y?h:new Te(h.k,z,R)}function x(h){return[(+h[0][0]+ +h[1][0])/2,(+h[0][1]+ +h[1][1])/2]}function $(h,N,w,z){h.on("start.zoom",function(){I(this,arguments).event(z).start()}).on("interrupt.zoom end.zoom",function(){I(this,arguments).event(z).end()}).tween("zoom",function(){var R=this,_=arguments,v=I(R,_).event(z),A=t.apply(R,_),T=w==null?x(A):typeof w=="function"?w.apply(R,_):w,B=Math.max(A[1][0]-A[0][0],A[1][1]-A[0][1]),j=R.__zoom,W=typeof N=="function"?N.apply(R,_):N,Z=c(j.invert(T).concat(B/j.k),W.invert(T).concat(B/W.k));return function(U){if(U===1)U=W;else{var q=Z(U),Q=B/q[2];U=new Te(Q,T[0]-q[0]*Q,T[1]-q[1]*Q)}v.zoom(null,U)}})}function I(h,N,w){return!w&&h.__zooming||new V(h,N)}function V(h,N){this.that=h,this.args=N,this.active=0,this.sourceEvent=null,this.extent=t.apply(h,N),this.taps=0}V.prototype={event:function(h){return h&&(this.sourceEvent=h),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(h,N){return this.mouse&&h!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&h!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&h!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(h){var N=me(this.that).datum();u.call(h,this.that,new Ol(h,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:u}),N)}};function O(h,...N){if(!e.apply(this,arguments))return;var w=I(this,N).event(h),z=this.__zoom,R=Math.max(i[0],Math.min(i[1],z.k*Math.pow(2,r.apply(this,arguments)))),_=ye(h);if(w.wheel)(w.mouse[0][0]!==_[0]||w.mouse[0][1]!==_[1])&&(w.mouse[1]=z.invert(w.mouse[0]=_)),clearTimeout(w.wheel);else{if(z.k===R)return;w.mouse=[_,z.invert(_)],jt(this),w.start()}pt(h),w.wheel=setTimeout(v,y),w.zoom("mouse",n(M(b(z,R),w.mouse[0],w.mouse[1]),w.extent,s));function v(){w.wheel=null,w.end()}}function D(h,...N){if(d||!e.apply(this,arguments))return;var w=h.currentTarget,z=I(this,N,!0).event(h),R=me(h.view).on("mousemove.zoom",T,!0).on("mouseup.zoom",B,!0),_=ye(h,w),v=h.clientX,A=h.clientY;lo(h.view),yn(h),z.mouse=[_,this.__zoom.invert(_)],jt(this),z.start();function T(j){if(pt(j),!z.moved){var W=j.clientX-v,Z=j.clientY-A;z.moved=W*W+Z*Z>p}z.event(j).zoom("mouse",n(M(z.that.__zoom,z.mouse[0]=ye(j,w),z.mouse[1]),z.extent,s))}function B(j){R.on("mousemove.zoom mouseup.zoom",null),uo(j.view,z.moved),pt(j),z.event(j).end()}}function H(h,...N){if(e.apply(this,arguments)){var w=this.__zoom,z=ye(h.changedTouches?h.changedTouches[0]:h,this),R=w.invert(z),_=w.k*(h.shiftKey?.5:2),v=n(M(b(w,_),z,R),t.apply(this,N),s);pt(h),a>0?me(this).transition().duration(a).call($,v,z,h):me(this).call(g.transform,v,z,h)}}function P(h,...N){if(e.apply(this,arguments)){var w=h.touches,z=w.length,R=I(this,N,h.changedTouches.length===z).event(h),_,v,A,T;for(yn(h),v=0;v<z;++v)A=w[v],T=ye(A,this),T=[T,this.__zoom.invert(T),A.identifier],R.touch0?!R.touch1&&R.touch0[2]!==T[2]&&(R.touch1=T,R.taps=0):(R.touch0=T,_=!0,R.taps=1+!!l);l&&(l=clearTimeout(l)),_&&(R.taps<2&&(f=T[0],l=setTimeout(function(){l=null},m)),jt(this),R.start())}}function F(h,...N){if(this.__zooming){var w=I(this,N).event(h),z=h.changedTouches,R=z.length,_,v,A,T;for(pt(h),_=0;_<R;++_)v=z[_],A=ye(v,this),w.touch0&&w.touch0[2]===v.identifier?w.touch0[0]=A:w.touch1&&w.touch1[2]===v.identifier&&(w.touch1[0]=A);if(v=w.that.__zoom,w.touch1){var B=w.touch0[0],j=w.touch0[1],W=w.touch1[0],Z=w.touch1[1],U=(U=W[0]-B[0])*U+(U=W[1]-B[1])*U,q=(q=Z[0]-j[0])*q+(q=Z[1]-j[1])*q;v=b(v,Math.sqrt(U/q)),A=[(B[0]+W[0])/2,(B[1]+W[1])/2],T=[(j[0]+Z[0])/2,(j[1]+Z[1])/2]}else if(w.touch0)A=w.touch0[0],T=w.touch0[1];else return;w.zoom("touch",n(M(v,A,T),w.extent,s))}}function L(h,...N){if(this.__zooming){var w=I(this,N).event(h),z=h.changedTouches,R=z.length,_,v;for(yn(h),d&&clearTimeout(d),d=setTimeout(function(){d=null},m),_=0;_<R;++_)v=z[_],w.touch0&&w.touch0[2]===v.identifier?delete w.touch0:w.touch1&&w.touch1[2]===v.identifier&&delete w.touch1;if(w.touch1&&!w.touch0&&(w.touch0=w.touch1,delete w.touch1),w.touch0)w.touch0[1]=this.__zoom.invert(w.touch0[0]);else if(w.end(),w.taps===2&&(v=ye(v,this),Math.hypot(f[0]-v[0],f[1]-v[1])<E)){var A=me(this).on("dblclick.zoom");A&&A.apply(this,arguments)}}}return g.wheelDelta=function(h){return arguments.length?(r=typeof h=="function"?h:Rt(+h),g):r},g.filter=function(h){return arguments.length?(e=typeof h=="function"?h:Rt(!!h),g):e},g.touchable=function(h){return arguments.length?(o=typeof h=="function"?h:Rt(!!h),g):o},g.extent=function(h){return arguments.length?(t=typeof h=="function"?h:Rt([[+h[0][0],+h[0][1]],[+h[1][0],+h[1][1]]]),g):t},g.scaleExtent=function(h){return arguments.length?(i[0]=+h[0],i[1]=+h[1],g):[i[0],i[1]]},g.translateExtent=function(h){return arguments.length?(s[0][0]=+h[0][0],s[1][0]=+h[1][0],s[0][1]=+h[0][1],s[1][1]=+h[1][1],g):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},g.constrain=function(h){return arguments.length?(n=h,g):n},g.duration=function(h){return arguments.length?(a=+h,g):a},g.interpolate=function(h){return arguments.length?(c=h,g):c},g.on=function(){var h=u.on.apply(u,arguments);return h===u?g:h},g.clickDistance=function(h){return arguments.length?(p=(h=+h)*h,g):Math.sqrt(p)},g.tapDistance=function(h){return arguments.length?(E=+h,g):E},g}const nn=S.createContext(null),Wl=nn.Provider,ze={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},vo=ze.error001();function te(e,t){const n=S.useContext(nn);if(n===null)throw new Error(vo);return qr(n,e,t)}const ie=()=>{const e=S.useContext(nn);if(e===null)throw new Error(vo);return S.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Ul=e=>e.userSelectionActive?"none":"all";function Yn({position:e,children:t,className:n,style:r,...o}){const i=te(Ul),s=`${e}`.split("-");return k.createElement("div",{className:le(["react-flow__panel",n,...s]),style:{...r,pointerEvents:i},...o},t)}function Zl({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:k.createElement(Yn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},k.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Gl=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:c,className:u,...l})=>{const f=S.useRef(null),[d,m]=S.useState({x:0,y:0,width:0,height:0}),y=le(["react-flow__edge-textwrapper",u]);return S.useEffect(()=>{if(f.current){const p=f.current.getBBox();m({x:p.x,y:p.y,width:p.width,height:p.height})}},[n]),typeof n>"u"||!n?null:k.createElement("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:y,visibility:d.width?"visible":"hidden",...l},o&&k.createElement("rect",{width:d.width+2*s[0],x:-s[0],y:-s[1],height:d.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),k.createElement("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:f,style:r},n),c)};var ql=S.memo(Gl);const Xn=e=>({width:e.offsetWidth,height:e.offsetHeight}),ut=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Wn=(e={x:0,y:0},t)=>({x:ut(e.x,t[0][0],t[1][0]),y:ut(e.y,t[0][1],t[1][1])}),Sr=(e,t,n)=>e<t?ut(Math.abs(e-t),1,50)/50:e>n?-ut(Math.abs(e-n),1,50)/50:0,_o=(e,t)=>{const n=Sr(e.x,35,t.width-35)*20,r=Sr(e.y,35,t.height-35)*20;return[n,r]},So=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Eo=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Nt=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),No=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Er=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Kl=(e,t)=>No(Eo(Nt(e),Nt(t))),$n=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Jl=e=>pe(e.width)&&pe(e.height)&&pe(e.x)&&pe(e.y),pe=e=>!isNaN(e)&&isFinite(e),re=Symbol.for("internals"),bo=["Enter"," ","Escape"],Ql=(e,t)=>{},eu=e=>"nativeEvent"in e;function zn(e){var o,i;const t=eu(e)?e.nativeEvent:e,n=((i=(o=t.composedPath)==null?void 0:o.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const Co=e=>"clientX"in e,He=(e,t)=>{var i,s,a,c;const n=Co(e),r=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,o=n?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:r-((a=t==null?void 0:t.left)!=null?a:0),y:o-((c=t==null?void 0:t.top)!=null?c:0)}},Zt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Mt=({id:e,path:t,labelX:n,labelY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:d,interactionWidth:m=20})=>k.createElement(k.Fragment,null,k.createElement("path",{id:e,style:l,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:d}),m&&k.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:m,className:"react-flow__edge-interaction"}),o&&pe(n)&&pe(r)?k.createElement(ql,{x:n,y:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u}):null);Mt.displayName="BaseEdge";function gt(e,t,n){return n===void 0?n:r=>{const o=t().edges.find(i=>i.id===e);o&&n(r,{...o})}}function ko({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[i,a,o,s]}function Mo({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){const c=e*.125+o*.375+s*.375+n*.125,u=t*.125+i*.375+a*.375+r*.125,l=Math.abs(c-e),f=Math.abs(u-t);return[c,u,l,f]}var qe;(function(e){e.Strict="strict",e.Loose="loose"})(qe||(qe={}));var Ue;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ue||(Ue={}));var bt;(function(e){e.Partial="partial",e.Full="full"})(bt||(bt={}));var Pe;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Pe||(Pe={}));var Gt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Gt||(Gt={}));var Y;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Y||(Y={}));function Nr({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===Y.Left||e===Y.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function To({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:r,targetY:o,targetPosition:i=Y.Top}){const[s,a]=Nr({pos:n,x1:e,y1:t,x2:r,y2:o}),[c,u]=Nr({pos:i,x1:r,y1:o,x2:e,y2:t}),[l,f,d,m]=Mo({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${e},${t} C${s},${a} ${c},${u} ${r},${o}`,l,f,d,m]}const Un=S.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=Y.Bottom,targetPosition:i=Y.Top,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:d,markerEnd:m,markerStart:y,interactionWidth:p})=>{const[E,g,b]=To({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i});return k.createElement(Mt,{path:E,labelX:g,labelY:b,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:d,markerEnd:m,markerStart:y,interactionWidth:p})});Un.displayName="SimpleBezierEdge";const br={[Y.Left]:{x:-1,y:0},[Y.Right]:{x:1,y:0},[Y.Top]:{x:0,y:-1},[Y.Bottom]:{x:0,y:1}},tu=({source:e,sourcePosition:t=Y.Bottom,target:n})=>t===Y.Left||t===Y.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Cr=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function nu({source:e,sourcePosition:t=Y.Bottom,target:n,targetPosition:r=Y.Top,center:o,offset:i}){var V,O;const s=br[t],a=br[r],c={x:e.x+s.x*i,y:e.y+s.y*i},u={x:n.x+a.x*i,y:n.y+a.y*i},l=tu({source:c,sourcePosition:t,target:u}),f=l.x!==0?"x":"y",d=l[f];let m=[],y,p;const E={x:0,y:0},g={x:0,y:0},[b,M,x,$]=ko({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[f]*a[f]===-1){y=(V=o.x)!=null?V:b,p=(O=o.y)!=null?O:M;const D=[{x:y,y:c.y},{x:y,y:u.y}],H=[{x:c.x,y:p},{x:u.x,y:p}];s[f]===d?m=f==="x"?D:H:m=f==="x"?H:D}else{const D=[{x:c.x,y:u.y}],H=[{x:u.x,y:c.y}];if(f==="x"?m=s.x===d?H:D:m=s.y===d?D:H,t===r){const N=Math.abs(e[f]-n[f]);if(N<=i){const w=Math.min(i-1,i-N);s[f]===d?E[f]=(c[f]>e[f]?-1:1)*w:g[f]=(u[f]>n[f]?-1:1)*w}}if(t!==r){const N=f==="x"?"y":"x",w=s[f]===a[N],z=c[N]>u[N],R=c[N]<u[N];(s[f]===1&&(!w&&z||w&&R)||s[f]!==1&&(!w&&R||w&&z))&&(m=f==="x"?D:H)}const P={x:c.x+E.x,y:c.y+E.y},F={x:u.x+g.x,y:u.y+g.y},L=Math.max(Math.abs(P.x-m[0].x),Math.abs(F.x-m[0].x)),h=Math.max(Math.abs(P.y-m[0].y),Math.abs(F.y-m[0].y));L>=h?(y=(P.x+F.x)/2,p=m[0].y):(y=m[0].x,p=(P.y+F.y)/2)}return[[e,{x:c.x+E.x,y:c.y+E.y},...m,{x:u.x+g.x,y:u.y+g.y},n],y,p,x,$]}function ru(e,t,n,r){const o=Math.min(Cr(e,t)/2,Cr(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const u=e.x<n.x?-1:1,l=e.y<n.y?1:-1;return`L ${i+o*u},${s}Q ${i},${s} ${i},${s+o*l}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${s+o*c}Q ${i},${s} ${i+o*a},${s}`}function In({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:r,targetY:o,targetPosition:i=Y.Top,borderRadius:s=5,centerX:a,centerY:c,offset:u=20}){const[l,f,d,m,y]=nu({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:c},offset:u});return[l.reduce((E,g,b)=>{let M="";return b>0&&b<l.length-1?M=ru(l[b-1],g,l[b+1],s):M=`${b===0?"M":"L"}${g.x} ${g.y}`,E+=M,E},""),f,d,m,y]}const rn=S.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,sourcePosition:f=Y.Bottom,targetPosition:d=Y.Top,markerEnd:m,markerStart:y,pathOptions:p,interactionWidth:E})=>{const[g,b,M]=In({sourceX:e,sourceY:t,sourcePosition:f,targetX:n,targetY:r,targetPosition:d,borderRadius:p==null?void 0:p.borderRadius,offset:p==null?void 0:p.offset});return k.createElement(Mt,{path:g,labelX:b,labelY:M,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:m,markerStart:y,interactionWidth:E})});rn.displayName="SmoothStepEdge";const Zn=S.memo(e=>{var t;return k.createElement(rn,{...e,pathOptions:S.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Zn.displayName="StepEdge";function ou({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,s,a]=ko({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}const Gn=S.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:d,interactionWidth:m})=>{const[y,p,E]=ou({sourceX:e,sourceY:t,targetX:n,targetY:r});return k.createElement(Mt,{path:y,labelX:p,labelY:E,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:d,interactionWidth:m})});Gn.displayName="StraightEdge";function Pt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function kr({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case Y.Left:return[t-Pt(t-r,i),n];case Y.Right:return[t+Pt(r-t,i),n];case Y.Top:return[t,n-Pt(n-o,i)];case Y.Bottom:return[t,n+Pt(o-n,i)]}}function Ao({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:r,targetY:o,targetPosition:i=Y.Top,curvature:s=.25}){const[a,c]=kr({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[u,l]=kr({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[f,d,m,y]=Mo({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:l});return[`M${e},${t} C${a},${c} ${u},${l} ${r},${o}`,f,d,m,y]}const qt=S.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=Y.Bottom,targetPosition:i=Y.Top,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:d,markerEnd:m,markerStart:y,pathOptions:p,interactionWidth:E})=>{const[g,b,M]=Ao({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i,curvature:p==null?void 0:p.curvature});return k.createElement(Mt,{path:g,labelX:b,labelY:M,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:d,markerEnd:m,markerStart:y,interactionWidth:E})});qt.displayName="BezierEdge";const qn=S.createContext(null),su=qn.Provider;qn.Consumer;const iu=()=>S.useContext(qn),au=e=>"id"in e&&"source"in e&&"target"in e,cu=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,Dn=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,lu=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),$o=(e,t)=>{if(!e.source||!e.target)return t;let n;return au(e)?n={...e}:n={...e,id:cu(e)},lu(n,t)?t:t.concat(n)},Rn=({x:e,y:t},[n,r,o],i,[s,a])=>{const c={x:(e-n)/o,y:(t-r)/o};return i?{x:s*Math.round(c.x/s),y:a*Math.round(c.y/a)}:c},zo=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),Ze=(e,t=[0,0])=>{var i,s;if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=((i=e.width)!=null?i:0)*t[0],r=((s=e.height)!=null?s:0)*t[1],o={x:e.position.x-n,y:e.position.y-r};return{...o,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:o}},on=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const{x:i,y:s}=Ze(o,t).positionAbsolute;return Eo(r,Nt({x:i,y:s,width:o.width||0,height:o.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return No(n)},Io=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1,a=[0,0])=>{const c={x:(t.x-n)/o,y:(t.y-r)/o,width:t.width/o,height:t.height/o},u=[];return e.forEach(l=>{const{width:f,height:d,selectable:m=!0,hidden:y=!1}=l;if(s&&!m||y)return!1;const{positionAbsolute:p}=Ze(l,a),E={x:p.x,y:p.y,width:f||0,height:d||0},g=$n(c,E),b=typeof f>"u"||typeof d>"u"||f===null||d===null,M=i&&g>0,x=(f||0)*(d||0);(b||M||g>=x||l.dragging)&&u.push(l)}),u},Do=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},Ro=(e,t,n,r,o,i=.1)=>{const s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),c=Math.min(s,a),u=ut(c,r,o),l=e.x+e.width/2,f=e.y+e.height/2,d=t/2-l*u,m=n/2-f*u;return{x:d,y:m,zoom:u}},We=(e,t=0)=>e.transition().duration(t);function Mr(e,t,n,r){return(t[n]||[]).reduce((o,i)=>{var s,a,c,u;return`${e.id}-${i.id}-${n}`!==r&&o.push({id:i.id||null,type:n,nodeId:e.id,x:((a=(s=e.positionAbsolute)==null?void 0:s.x)!=null?a:0)+i.x+i.width/2,y:((u=(c=e.positionAbsolute)==null?void 0:c.y)!=null?u:0)+i.y+i.height/2}),o},[])}function uu(e,t,n,r,o,i){const{x:s,y:a}=He(e),u=t.elementsFromPoint(s,a).find(y=>y.classList.contains("react-flow__handle"));if(u){const y=u.getAttribute("data-nodeid");if(y){const p=Kn(void 0,u),E=u.getAttribute("data-handleid"),g=i({nodeId:y,id:E,type:p});if(g){const b=o.find(M=>M.nodeId===y&&M.type===p&&M.id===E);return{handle:{id:E,type:p,nodeId:y,x:(b==null?void 0:b.x)||n.x,y:(b==null?void 0:b.y)||n.y},validHandleResult:g}}}}let l=[],f=1/0;if(o.forEach(y=>{const p=Math.sqrt((y.x-n.x)**2+(y.y-n.y)**2);if(p<=r){const E=i(y);p<=f&&(p<f?l=[{handle:y,validHandleResult:E}]:p===f&&l.push({handle:y,validHandleResult:E}),f=p)}}),!l.length)return{handle:null,validHandleResult:Po()};if(l.length===1)return l[0];const d=l.some(({validHandleResult:y})=>y.isValid),m=l.some(({handle:y})=>y.type==="target");return l.find(({handle:y,validHandleResult:p})=>m?y.type==="target":d?p.isValid:!0)||l[0]}const fu={source:null,target:null,sourceHandle:null,targetHandle:null},Po=()=>({handleDomNode:null,isValid:!1,connection:fu,endHandle:null});function Ho(e,t,n,r,o,i,s){const a=o==="target",c=s.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...Po(),handleDomNode:c};if(c){const l=Kn(void 0,c),f=c.getAttribute("data-nodeid"),d=c.getAttribute("data-handleid"),m=c.classList.contains("connectable"),y=c.classList.contains("connectableend"),p={source:a?f:n,sourceHandle:a?d:r,target:a?n:f,targetHandle:a?r:d};u.connection=p,m&&y&&(t===qe.Strict?a&&l==="source"||!a&&l==="target":f!==n||d!==r)&&(u.endHandle={nodeId:f,handleId:d,type:l},u.isValid=i(p))}return u}function du({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((o,i)=>{if(i[re]){const{handleBounds:s}=i[re];let a=[],c=[];s&&(a=Mr(i,s,"source",`${t}-${n}-${r}`),c=Mr(i,s,"target",`${t}-${n}-${r}`)),o.push(...a,...c)}return o},[])}function Kn(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function wn(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function hu(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Lo({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:o,getState:i,setState:s,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:u}){const l=So(e.target),{connectionMode:f,domNode:d,autoPanOnConnect:m,connectionRadius:y,onConnectStart:p,panBy:E,getNodes:g,cancelConnection:b}=i();let M=0,x;const{x:$,y:I}=He(e),V=l==null?void 0:l.elementFromPoint($,I),O=Kn(c,V),D=d==null?void 0:d.getBoundingClientRect();if(!D||!O)return;let H,P=He(e,D),F=!1,L=null,h=!1,N=null;const w=du({nodes:g(),nodeId:n,handleId:t,handleType:O}),z=()=>{if(!m)return;const[v,A]=_o(P,D);E({x:v,y:A}),M=requestAnimationFrame(z)};s({connectionPosition:P,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:O,connectionStartHandle:{nodeId:n,handleId:t,type:O},connectionEndHandle:null}),p==null||p(e,{nodeId:n,handleId:t,handleType:O});function R(v){const{transform:A}=i();P=He(v,D);const{handle:T,validHandleResult:B}=uu(v,l,Rn(P,A,!1,[1,1]),y,w,j=>Ho(j,f,n,t,o?"target":"source",a,l));if(x=T,F||(z(),F=!0),N=B.handleDomNode,L=B.connection,h=B.isValid,s({connectionPosition:x&&h?zo({x:x.x,y:x.y},A):P,connectionStatus:hu(!!x,h),connectionEndHandle:B.endHandle}),!x&&!h&&!N)return wn(H);L.source!==L.target&&N&&(wn(H),H=N,N.classList.add("connecting","react-flow__handle-connecting"),N.classList.toggle("valid",h),N.classList.toggle("react-flow__handle-valid",h))}function _(v){var A,T;(x||N)&&L&&h&&(r==null||r(L)),(T=(A=i()).onConnectEnd)==null||T.call(A,v),c&&(u==null||u(v)),wn(H),b(),cancelAnimationFrame(M),F=!1,h=!1,L=null,N=null,l.removeEventListener("mousemove",R),l.removeEventListener("mouseup",_),l.removeEventListener("touchmove",R),l.removeEventListener("touchend",_)}l.addEventListener("mousemove",R),l.addEventListener("mouseup",_),l.addEventListener("touchmove",R),l.addEventListener("touchend",_)}const Tr=()=>!0,mu=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),pu=(e,t,n)=>r=>{const{connectionStartHandle:o,connectionEndHandle:i,connectionClickStartHandle:s}=r;return{connecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n}},Vo=S.forwardRef(({type:e="source",position:t=Y.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:c,className:u,onMouseDown:l,onTouchStart:f,...d},m)=>{var D,H;const y=s||null,p=e==="target",E=ie(),g=iu(),{connectOnClick:b,noPanClassName:M}=te(mu,de),{connecting:x,clickConnecting:$}=te(pu(g,y,e),de);g||(H=(D=E.getState()).onError)==null||H.call(D,"010",ze.error010());const I=P=>{const{defaultEdgeOptions:F,onConnect:L,hasDefaultEdges:h}=E.getState(),N={...F,...P};if(h){const{edges:w,setEdges:z}=E.getState();z($o(N,w))}L==null||L(N),a==null||a(N)},V=P=>{if(!g)return;const F=Co(P);o&&(F&&P.button===0||!F)&&Lo({event:P,handleId:y,nodeId:g,onConnect:I,isTarget:p,getState:E.getState,setState:E.setState,isValidConnection:n||E.getState().isValidConnection||Tr}),F?l==null||l(P):f==null||f(P)},O=P=>{const{onClickConnectStart:F,onClickConnectEnd:L,connectionClickStartHandle:h,connectionMode:N,isValidConnection:w}=E.getState();if(!g||!h&&!o)return;if(!h){F==null||F(P,{nodeId:g,handleId:y,handleType:e}),E.setState({connectionClickStartHandle:{nodeId:g,type:e,handleId:y}});return}const z=So(P.target),R=n||w||Tr,{connection:_,isValid:v}=Ho({nodeId:g,id:y,type:e},N,h.nodeId,h.handleId||null,h.type,R,z);v&&I(_),L==null||L(P),E.setState({connectionClickStartHandle:null})};return k.createElement("div",{"data-handleid":y,"data-nodeid":g,"data-handlepos":t,"data-id":`${g}-${y}-${e}`,className:le(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",M,u,{source:!p,target:p,connectable:r,connectablestart:o,connectableend:i,connecting:$,connectionindicator:r&&(o&&!x||i&&x)}]),onMouseDown:V,onTouchStart:V,onClick:b?O:void 0,ref:m,...d},c)});Vo.displayName="Handle";var Ee=S.memo(Vo);const Oo=({data:e,isConnectable:t,targetPosition:n=Y.Top,sourcePosition:r=Y.Bottom})=>k.createElement(k.Fragment,null,k.createElement(Ee,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,k.createElement(Ee,{type:"source",position:r,isConnectable:t}));Oo.displayName="DefaultNode";var Pn=S.memo(Oo);const Fo=({data:e,isConnectable:t,sourcePosition:n=Y.Bottom})=>k.createElement(k.Fragment,null,e==null?void 0:e.label,k.createElement(Ee,{type:"source",position:n,isConnectable:t}));Fo.displayName="InputNode";var Bo=S.memo(Fo);const jo=({data:e,isConnectable:t,targetPosition:n=Y.Top})=>k.createElement(k.Fragment,null,k.createElement(Ee,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);jo.displayName="OutputNode";var Yo=S.memo(jo);const Jn=()=>null;Jn.displayName="GroupNode";const gu=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Ht=e=>e.id;function yu(e,t){return de(e.selectedNodes.map(Ht),t.selectedNodes.map(Ht))&&de(e.selectedEdges.map(Ht),t.selectedEdges.map(Ht))}const Xo=S.memo(({onSelectionChange:e})=>{const t=ie(),{selectedNodes:n,selectedEdges:r}=te(gu,yu);return S.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChange.forEach(i=>i(o))},[n,r,e]),null});Xo.displayName="SelectionListener";const wu=e=>!!e.onSelectionChange;function xu({onSelectionChange:e}){const t=te(wu);return e||t?k.createElement(Xo,{onSelectionChange:e}):null}const vu=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function tt(e,t){S.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function G(e,t,n){S.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const _u=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:o,onConnectStart:i,onConnectEnd:s,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:l,nodesFocusable:f,edgesFocusable:d,edgesUpdatable:m,elevateNodesOnSelect:y,minZoom:p,maxZoom:E,nodeExtent:g,onNodesChange:b,onEdgesChange:M,elementsSelectable:x,connectionMode:$,snapGrid:I,snapToGrid:V,translateExtent:O,connectOnClick:D,defaultEdgeOptions:H,fitView:P,fitViewOptions:F,onNodesDelete:L,onEdgesDelete:h,onNodeDrag:N,onNodeDragStart:w,onNodeDragStop:z,onSelectionDrag:R,onSelectionDragStart:_,onSelectionDragStop:v,noPanClassName:A,nodeOrigin:T,rfId:B,autoPanOnConnect:j,autoPanOnNodeDrag:W,onError:Z,connectionRadius:U,isValidConnection:q,nodeDragThreshold:Q})=>{const{setNodes:oe,setEdges:ne,setDefaultNodesAndEdges:K,setMinZoom:ae,setMaxZoom:se,setTranslateExtent:ee,setNodeExtent:ce,reset:J}=te(vu,de),X=ie();return S.useEffect(()=>{const ue=r==null?void 0:r.map(be=>({...be,...H}));return K(n,ue),()=>{J()}},[]),G("defaultEdgeOptions",H,X.setState),G("connectionMode",$,X.setState),G("onConnect",o,X.setState),G("onConnectStart",i,X.setState),G("onConnectEnd",s,X.setState),G("onClickConnectStart",a,X.setState),G("onClickConnectEnd",c,X.setState),G("nodesDraggable",u,X.setState),G("nodesConnectable",l,X.setState),G("nodesFocusable",f,X.setState),G("edgesFocusable",d,X.setState),G("edgesUpdatable",m,X.setState),G("elementsSelectable",x,X.setState),G("elevateNodesOnSelect",y,X.setState),G("snapToGrid",V,X.setState),G("snapGrid",I,X.setState),G("onNodesChange",b,X.setState),G("onEdgesChange",M,X.setState),G("connectOnClick",D,X.setState),G("fitViewOnInit",P,X.setState),G("fitViewOnInitOptions",F,X.setState),G("onNodesDelete",L,X.setState),G("onEdgesDelete",h,X.setState),G("onNodeDrag",N,X.setState),G("onNodeDragStart",w,X.setState),G("onNodeDragStop",z,X.setState),G("onSelectionDrag",R,X.setState),G("onSelectionDragStart",_,X.setState),G("onSelectionDragStop",v,X.setState),G("noPanClassName",A,X.setState),G("nodeOrigin",T,X.setState),G("rfId",B,X.setState),G("autoPanOnConnect",j,X.setState),G("autoPanOnNodeDrag",W,X.setState),G("onError",Z,X.setState),G("connectionRadius",U,X.setState),G("isValidConnection",q,X.setState),G("nodeDragThreshold",Q,X.setState),tt(e,oe),tt(t,ne),tt(p,ae),tt(E,se),tt(O,ee),tt(g,ce),null},Ar={display:"none"},Su={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Wo="react-flow__node-desc",Uo="react-flow__edge-desc",Eu="react-flow__aria-live",Nu=e=>e.ariaLiveMessage;function bu({rfId:e}){const t=te(Nu);return k.createElement("div",{id:`${Eu}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Su},t)}function Cu({rfId:e,disableKeyboardA11y:t}){return k.createElement(k.Fragment,null,k.createElement("div",{id:`${Wo}-${e}`,style:Ar},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),k.createElement("div",{id:`${Uo}-${e}`,style:Ar},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&k.createElement(bu,{rfId:e}))}var Ct=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=S.useState(!1),o=S.useRef(!1),i=S.useRef(new Set([])),[s,a]=S.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),l=u.reduce((f,d)=>f.concat(...d),[]);return[u,l]}return[[],[]]},[e]);return S.useEffect(()=>{const c=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||c;if(e!==null){const l=m=>{if(o.current=m.ctrlKey||m.metaKey||m.shiftKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&zn(m))return!1;const p=zr(m.code,a);i.current.add(m[p]),$r(s,i.current,!1)&&(m.preventDefault(),r(!0))},f=m=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&zn(m))return!1;const p=zr(m.code,a);$r(s,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(m[p]),m.key==="Meta"&&i.current.clear(),o.current=!1},d=()=>{i.current.clear(),r(!1)};return u==null||u.addEventListener("keydown",l),u==null||u.addEventListener("keyup",f),window.addEventListener("blur",d),()=>{u==null||u.removeEventListener("keydown",l),u==null||u.removeEventListener("keyup",f),window.removeEventListener("blur",d)}}},[e,r]),n};function $r(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function zr(e,t){return t.includes(e)?"code":"key"}function Zo(e,t,n,r){var a,c,u,l,f,d,m,y;const o=e.parentNode||e.parentId;if(!o)return n;const i=t.get(o),s=Ze(i,r);return Zo(i,t,{x:((a=n.x)!=null?a:0)+s.x,y:((c=n.y)!=null?c:0)+s.y,z:((l=(u=i[re])==null?void 0:u.z)!=null?l:0)>((f=n.z)!=null?f:0)?(m=(d=i[re])==null?void 0:d.z)!=null?m:0:(y=n.z)!=null?y:0},r)}function Go(e,t,n){e.forEach(r=>{var i,s;const o=r.parentNode||r.parentId;if(o&&!e.has(o))throw new Error(`Parent node ${o} not found`);if(o||n!=null&&n[r.id]){const{x:a,y:c,z:u}=Zo(r,e,{...r.position,z:(s=(i=r[re])==null?void 0:i.z)!=null?s:0},t);r.positionAbsolute={x:a,y:c},r[re].z=u,n!=null&&n[r.id]&&(r[re].isParent=!0)}})}function xn(e,t,n,r){const o=new Map,i={},s=r?1e3:0;return e.forEach(a=>{var m;const c=(pe(a.zIndex)?a.zIndex:0)+(a.selected?s:0),u=t.get(a.id),l={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},f=a.parentNode||a.parentId;f&&(i[f]=!0);const d=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==a.type;Object.defineProperty(l,re,{enumerable:!1,value:{handleBounds:d||(m=u==null?void 0:u[re])==null?void 0:m.handleBounds,z:c}}),o.set(a.id,l)}),Go(o,n,i),o}function qo(e,t={}){var y,p,E;const{getNodes:n,width:r,height:o,minZoom:i,maxZoom:s,d3Zoom:a,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:l,nodeOrigin:f}=e(),d=t.initial&&!u&&l;if(a&&c&&(d||!t.initial)){const g=n().filter(M=>{var $;const x=t.includeHiddenNodes?M.width&&M.height:!M.hidden;return($=t.nodes)!=null&&$.length?x&&t.nodes.some(I=>I.id===M.id):x}),b=g.every(M=>M.width&&M.height);if(g.length>0&&b){const M=on(g,f),{x,y:$,zoom:I}=Ro(M,r,o,(y=t.minZoom)!=null?y:i,(p=t.maxZoom)!=null?p:s,(E=t.padding)!=null?E:.1),V=Ae.translate(x,$).scale(I);return typeof t.duration=="number"&&t.duration>0?a.transform(We(c,t.duration),V):a.transform(c,V),!0}}return!1}function ku(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[re]:r[re],selected:n.selected})}),new Map(t)}function Mu(e,t){return t.map(n=>{const r=e.find(o=>o.id===n.id);return r&&(n.selected=r.selected),n})}function Lt({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:o,edges:i,onNodesChange:s,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:u}=n();e!=null&&e.length&&(c&&r({nodeInternals:ku(e,o)}),s==null||s(e)),t!=null&&t.length&&(u&&r({edges:Mu(t,i)}),a==null||a(t))}const nt=()=>{},Tu={zoomIn:nt,zoomOut:nt,zoomTo:nt,getZoom:()=>1,setViewport:nt,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:nt,fitBounds:nt,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Au=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),$u=()=>{const e=ie(),{d3Zoom:t,d3Selection:n}=te(Au,de);return S.useMemo(()=>n&&t?{zoomIn:o=>t.scaleBy(We(n,o==null?void 0:o.duration),1.2),zoomOut:o=>t.scaleBy(We(n,o==null?void 0:o.duration),1/1.2),zoomTo:(o,i)=>t.scaleTo(We(n,i==null?void 0:i.duration),o),getZoom:()=>e.getState().transform[2],setViewport:(o,i)=>{var l,f,d;const[s,a,c]=e.getState().transform,u=Ae.translate((l=o.x)!=null?l:s,(f=o.y)!=null?f:a).scale((d=o.zoom)!=null?d:c);t.transform(We(n,i==null?void 0:i.duration),u)},getViewport:()=>{const[o,i,s]=e.getState().transform;return{x:o,y:i,zoom:s}},fitView:o=>qo(e.getState,o),setCenter:(o,i,s)=>{const{width:a,height:c,maxZoom:u}=e.getState(),l=typeof(s==null?void 0:s.zoom)<"u"?s.zoom:u,f=a/2-o*l,d=c/2-i*l,m=Ae.translate(f,d).scale(l);t.transform(We(n,s==null?void 0:s.duration),m)},fitBounds:(o,i)=>{var y;const{width:s,height:a,minZoom:c,maxZoom:u}=e.getState(),{x:l,y:f,zoom:d}=Ro(o,s,a,c,u,(y=i==null?void 0:i.padding)!=null?y:.1),m=Ae.translate(l,f).scale(d);t.transform(We(n,i==null?void 0:i.duration),m)},project:o=>{const{transform:i,snapToGrid:s,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Rn(o,i,s,a)},screenToFlowPosition:o=>{const{transform:i,snapToGrid:s,snapGrid:a,domNode:c}=e.getState();if(!c)return o;const{x:u,y:l}=c.getBoundingClientRect(),f={x:o.x-u,y:o.y-l};return Rn(f,i,s,a)},flowToScreenPosition:o=>{const{transform:i,domNode:s}=e.getState();if(!s)return o;const{x:a,y:c}=s.getBoundingClientRect(),u=zo(o,i);return{x:u.x+a,y:u.y+c}},viewportInitialized:!0}:Tu,[t,n])};function Qn(){const e=$u(),t=ie(),n=S.useCallback(()=>t.getState().getNodes().map(p=>({...p})),[]),r=S.useCallback(p=>t.getState().nodeInternals.get(p),[]),o=S.useCallback(()=>{const{edges:p=[]}=t.getState();return p.map(E=>({...E}))},[]),i=S.useCallback(p=>{const{edges:E=[]}=t.getState();return E.find(g=>g.id===p)},[]),s=S.useCallback(p=>{const{getNodes:E,setNodes:g,hasDefaultNodes:b,onNodesChange:M}=t.getState(),x=E(),$=typeof p=="function"?p(x):p;if(b)g($);else if(M){const I=$.length===0?x.map(V=>({type:"remove",id:V.id})):$.map(V=>({item:V,type:"reset"}));M(I)}},[]),a=S.useCallback(p=>{const{edges:E=[],setEdges:g,hasDefaultEdges:b,onEdgesChange:M}=t.getState(),x=typeof p=="function"?p(E):p;if(b)g(x);else if(M){const $=x.length===0?E.map(I=>({type:"remove",id:I.id})):x.map(I=>({item:I,type:"reset"}));M($)}},[]),c=S.useCallback(p=>{const E=Array.isArray(p)?p:[p],{getNodes:g,setNodes:b,hasDefaultNodes:M,onNodesChange:x}=t.getState();if(M){const I=[...g(),...E];b(I)}else if(x){const $=E.map(I=>({item:I,type:"add"}));x($)}},[]),u=S.useCallback(p=>{const E=Array.isArray(p)?p:[p],{edges:g=[],setEdges:b,hasDefaultEdges:M,onEdgesChange:x}=t.getState();if(M)b([...g,...E]);else if(x){const $=E.map(I=>({item:I,type:"add"}));x($)}},[]),l=S.useCallback(()=>{const{getNodes:p,edges:E=[],transform:g}=t.getState(),[b,M,x]=g;return{nodes:p().map($=>({...$})),edges:E.map($=>({...$})),viewport:{x:b,y:M,zoom:x}}},[]),f=S.useCallback(({nodes:p,edges:E})=>{const{nodeInternals:g,getNodes:b,edges:M,hasDefaultNodes:x,hasDefaultEdges:$,onNodesDelete:I,onEdgesDelete:V,onNodesChange:O,onEdgesChange:D}=t.getState(),H=(p||[]).map(N=>N.id),P=(E||[]).map(N=>N.id),F=b().reduce((N,w)=>{const z=w.parentNode||w.parentId,R=!H.includes(w.id)&&z&&N.find(v=>v.id===z);return(typeof w.deletable=="boolean"?w.deletable:!0)&&(H.includes(w.id)||R)&&N.push(w),N},[]),L=M.filter(N=>typeof N.deletable=="boolean"?N.deletable:!0),h=L.filter(N=>P.includes(N.id));if(F||h){const N=Do(F,L),w=[...h,...N],z=w.reduce((R,_)=>(R.includes(_.id)||R.push(_.id),R),[]);if(($||x)&&($&&t.setState({edges:M.filter(R=>!z.includes(R.id))}),x&&(F.forEach(R=>{g.delete(R.id)}),t.setState({nodeInternals:new Map(g)}))),z.length>0&&(V==null||V(w),D&&D(z.map(R=>({id:R,type:"remove"})))),F.length>0&&(I==null||I(F),O)){const R=F.map(_=>({id:_.id,type:"remove"}));O(R)}}},[]),d=S.useCallback(p=>{const E=Jl(p),g=E?null:t.getState().nodeInternals.get(p.id);return!E&&!g?[null,null,E]:[E?p:Er(g),g,E]},[]),m=S.useCallback((p,E=!0,g)=>{const[b,M,x]=d(p);return b?(g||t.getState().getNodes()).filter($=>{if(!x&&($.id===M.id||!$.positionAbsolute))return!1;const I=Er($),V=$n(I,b);return E&&V>0||V>=b.width*b.height}):[]},[]),y=S.useCallback((p,E,g=!0)=>{const[b]=d(p);if(!b)return!1;const M=$n(b,E);return g&&M>0||M>=b.width*b.height},[]);return S.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:o,getEdge:i,setNodes:s,setEdges:a,addNodes:c,addEdges:u,toObject:l,deleteElements:f,getIntersectingNodes:m,isNodeIntersecting:y}),[e,n,r,o,i,s,a,c,u,l,f,m,y])}const zu={actInsideInputWithModifier:!1};var Iu=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ie(),{deleteElements:r}=Qn(),o=Ct(e,zu),i=Ct(t);S.useEffect(()=>{if(o){const{edges:s,getNodes:a}=n.getState(),c=a().filter(l=>l.selected),u=s.filter(l=>l.selected);r({nodes:c,edges:u}),n.setState({nodesSelectionActive:!1})}},[o]),S.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function Du(e){const t=ie();S.useEffect(()=>{let n;const r=()=>{var i,s;if(!e.current)return;const o=Xn(e.current);(o.height===0||o.width===0)&&((s=(i=t.getState()).onError)==null||s.call(i,"004",ze.error004())),t.setState({width:o.width||500,height:o.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const er={position:"absolute",width:"100%",height:"100%",top:0,left:0},Ru=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Vt=e=>({x:e.x,y:e.y,zoom:e.k}),rt=(e,t)=>e.target.closest(`.${t}`),Ir=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Dr=e=>{const t=e.ctrlKey&&Zt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Pu=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Hu=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:o=!0,zoomOnPinch:i=!0,panOnScroll:s=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=Ue.Free,zoomOnDoubleClick:u=!0,elementsSelectable:l,panOnDrag:f=!0,defaultViewport:d,translateExtent:m,minZoom:y,maxZoom:p,zoomActivationKeyCode:E,preventScrolling:g=!0,children:b,noWheelClassName:M,noPanClassName:x})=>{const $=S.useRef(),I=ie(),V=S.useRef(!1),O=S.useRef(!1),D=S.useRef(null),H=S.useRef({x:0,y:0,zoom:0}),{d3Zoom:P,d3Selection:F,d3ZoomHandler:L,userSelectionActive:h}=te(Pu,de),N=Ct(E),w=S.useRef(0),z=S.useRef(!1),R=S.useRef();return Du(D),S.useEffect(()=>{if(D.current){const _=D.current.getBoundingClientRect(),v=xo().scaleExtent([y,p]).translateExtent(m),A=me(D.current).call(v),T=Ae.translate(d.x,d.y).scale(ut(d.zoom,y,p)),B=[[0,0],[_.width,_.height]],j=v.constrain()(T,B,m);v.transform(A,j),v.wheelDelta(Dr),I.setState({d3Zoom:v,d3Selection:A,d3ZoomHandler:A.on("wheel.zoom"),transform:[j.x,j.y,j.k],domNode:D.current.closest(".react-flow")})}},[]),S.useEffect(()=>{F&&P&&(s&&!N&&!h?F.on("wheel.zoom",_=>{if(rt(_,M))return!1;_.preventDefault(),_.stopImmediatePropagation();const v=F.property("__zoom").k||1;if(_.ctrlKey&&i){const q=ye(_),Q=Dr(_),oe=v*Math.pow(2,Q);P.scaleTo(F,oe,q,_);return}const A=_.deltaMode===1?20:1;let T=c===Ue.Vertical?0:_.deltaX*A,B=c===Ue.Horizontal?0:_.deltaY*A;!Zt()&&_.shiftKey&&c!==Ue.Vertical&&(T=_.deltaY*A,B=0),P.translateBy(F,-(T/v)*a,-(B/v)*a,{internal:!0});const j=Vt(F.property("__zoom")),{onViewportChangeStart:W,onViewportChange:Z,onViewportChangeEnd:U}=I.getState();clearTimeout(R.current),z.current||(z.current=!0,t==null||t(_,j),W==null||W(j)),z.current&&(e==null||e(_,j),Z==null||Z(j),R.current=setTimeout(()=>{n==null||n(_,j),U==null||U(j),z.current=!1},150))},{passive:!1}):typeof L<"u"&&F.on("wheel.zoom",function(_,v){if(!g&&_.type==="wheel"&&!_.ctrlKey||rt(_,M))return null;_.preventDefault(),L.call(this,_,v)},{passive:!1}))},[h,s,c,F,P,L,N,i,g,M,t,e,n]),S.useEffect(()=>{P&&P.on("start",_=>{var T,B;if(!_.sourceEvent||_.sourceEvent.internal)return null;w.current=(T=_.sourceEvent)==null?void 0:T.button;const{onViewportChangeStart:v}=I.getState(),A=Vt(_.transform);V.current=!0,H.current=A,((B=_.sourceEvent)==null?void 0:B.type)==="mousedown"&&I.setState({paneDragging:!0}),v==null||v(A),t==null||t(_.sourceEvent,A)})},[P,t]),S.useEffect(()=>{P&&(h&&!V.current?P.on("zoom",null):h||P.on("zoom",_=>{var A,T;const{onViewportChange:v}=I.getState();if(I.setState({transform:[_.transform.x,_.transform.y,_.transform.k]}),O.current=!!(r&&Ir(f,(A=w.current)!=null?A:0)),(e||v)&&!((T=_.sourceEvent)!=null&&T.internal)){const B=Vt(_.transform);v==null||v(B),e==null||e(_.sourceEvent,B)}}))},[h,P,e,f,r]),S.useEffect(()=>{P&&P.on("end",_=>{var A;if(!_.sourceEvent||_.sourceEvent.internal)return null;const{onViewportChangeEnd:v}=I.getState();if(V.current=!1,I.setState({paneDragging:!1}),r&&Ir(f,(A=w.current)!=null?A:0)&&!O.current&&r(_.sourceEvent),O.current=!1,(n||v)&&Ru(H.current,_.transform)){const T=Vt(_.transform);H.current=T,clearTimeout($.current),$.current=setTimeout(()=>{v==null||v(T),n==null||n(_.sourceEvent,T)},s?150:0)}})},[P,s,f,n,r]),S.useEffect(()=>{P&&P.filter(_=>{const v=N||o,A=i&&_.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&_.button===1&&_.type==="mousedown"&&(rt(_,"react-flow__node")||rt(_,"react-flow__edge")))return!0;if(!f&&!v&&!s&&!u&&!i||h||!u&&_.type==="dblclick"||rt(_,M)&&_.type==="wheel"||rt(_,x)&&(_.type!=="wheel"||s&&_.type==="wheel"&&!N)||!i&&_.ctrlKey&&_.type==="wheel"||!v&&!s&&!A&&_.type==="wheel"||!f&&(_.type==="mousedown"||_.type==="touchstart")||Array.isArray(f)&&!f.includes(_.button)&&_.type==="mousedown")return!1;const T=Array.isArray(f)&&f.includes(_.button)||!_.button||_.button<=1;return(!_.ctrlKey||_.type==="wheel")&&T})},[h,P,o,i,s,u,f,l,N]),k.createElement("div",{className:"react-flow__renderer",ref:D,style:er},b)},Lu=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Vu(){const{userSelectionActive:e,userSelectionRect:t}=te(Lu,de);return e&&t?k.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Rr(e,t){var o,i;const n=t.parentNode||t.parentId,r=e.find(s=>s.id===n);if(r){const s=t.position.x+t.width-r.width,a=t.position.y+t.height-r.height;if(s>0||a>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=(o=r.style.width)!=null?o:r.width,r.style.height=(i=r.style.height)!=null?i:r.height,s>0&&(r.style.width+=s),a>0&&(r.style.height+=a),t.position.x<0){const c=Math.abs(t.position.x);r.position.x=r.position.x-c,r.style.width+=c,t.position.x=0}if(t.position.y<0){const c=Math.abs(t.position.y);r.position.y=r.position.y-c,r.style.height+=c,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function Ko(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,o)=>{const i=e.filter(a=>a.id===o.id);if(i.length===0)return r.push(o),r;const s={...o};for(const a of i)if(a)switch(a.type){case"select":{s.selected=a.selected;break}case"position":{typeof a.position<"u"&&(s.position=a.position),typeof a.positionAbsolute<"u"&&(s.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(s.dragging=a.dragging),s.expandParent&&Rr(r,s);break}case"dimensions":{typeof a.dimensions<"u"&&(s.width=a.dimensions.width,s.height=a.dimensions.height),typeof a.updateStyle<"u"&&(s.style={...s.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(s.resizing=a.resizing),s.expandParent&&Rr(r,s);break}case"remove":return r}return r.push(s),r},n)}function Jo(e,t){return Ko(e,t)}function Ou(e,t){return Ko(e,t)}const Re=(e,t)=>({id:e,type:"select",selected:t});function st(e,t){return e.reduce((n,r)=>{const o=t.includes(r.id);return!r.selected&&o?(r.selected=!0,n.push(Re(r.id,!0))):r.selected&&!o&&(r.selected=!1,n.push(Re(r.id,!1))),n},[])}const vn=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Fu=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Qo=S.memo(({isSelecting:e,selectionMode:t=bt.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:o,onPaneClick:i,onPaneContextMenu:s,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:l,children:f})=>{const d=S.useRef(null),m=ie(),y=S.useRef(0),p=S.useRef(0),E=S.useRef(),{userSelectionActive:g,elementsSelectable:b,dragging:M}=te(Fu,de),x=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),y.current=0,p.current=0},$=L=>{i==null||i(L),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},I=L=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){L.preventDefault();return}s==null||s(L)},V=a?L=>a(L):void 0,O=L=>{const{resetSelectedElements:h,domNode:N}=m.getState();if(E.current=N==null?void 0:N.getBoundingClientRect(),!b||!e||L.button!==0||L.target!==d.current||!E.current)return;const{x:w,y:z}=He(L,E.current);h(),m.setState({userSelectionRect:{width:0,height:0,startX:w,startY:z,x:w,y:z}}),r==null||r(L)},D=L=>{var oe,ne;const{userSelectionRect:h,nodeInternals:N,edges:w,transform:z,onNodesChange:R,onEdgesChange:_,nodeOrigin:v,getNodes:A}=m.getState();if(!e||!E.current||!h)return;m.setState({userSelectionActive:!0,nodesSelectionActive:!1});const T=He(L,E.current),B=(oe=h.startX)!=null?oe:0,j=(ne=h.startY)!=null?ne:0,W={...h,x:T.x<B?T.x:B,y:T.y<j?T.y:j,width:Math.abs(T.x-B),height:Math.abs(T.y-j)},Z=A(),U=Io(N,W,z,t===bt.Partial,!0,v),q=Do(U,w).map(K=>K.id),Q=U.map(K=>K.id);if(y.current!==Q.length){y.current=Q.length;const K=st(Z,Q);K.length&&(R==null||R(K))}if(p.current!==q.length){p.current=q.length;const K=st(w,q);K.length&&(_==null||_(K))}m.setState({userSelectionRect:W})},H=L=>{if(L.button!==0)return;const{userSelectionRect:h}=m.getState();!g&&h&&L.target===d.current&&($==null||$(L)),m.setState({nodesSelectionActive:y.current>0}),x(),o==null||o(L)},P=L=>{g&&(m.setState({nodesSelectionActive:y.current>0}),o==null||o(L)),x()},F=b&&(e||g);return k.createElement("div",{className:le(["react-flow__pane",{dragging:M,selection:e}]),onClick:F?void 0:vn($,d),onContextMenu:vn(I,d),onWheel:vn(V,d),onMouseEnter:F?void 0:c,onMouseDown:F?O:void 0,onMouseMove:F?D:u,onMouseUp:F?H:void 0,onMouseLeave:F?P:l,ref:d,style:er},f,k.createElement(Vu,null))});Qo.displayName="Pane";function es(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:es(r,t):!1}function Pr(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function Bu(e,t,n,r){return Array.from(e.values()).filter(o=>(o.selected||o.id===r)&&(!o.parentNode||o.parentId||!es(o,e))&&(o.draggable||t&&typeof o.draggable>"u")).map(o=>{var i,s,a,c;return{id:o.id,position:o.position||{x:0,y:0},positionAbsolute:o.positionAbsolute||{x:0,y:0},distance:{x:n.x-((s=(i=o.positionAbsolute)==null?void 0:i.x)!=null?s:0),y:n.y-((c=(a=o.positionAbsolute)==null?void 0:a.y)!=null?c:0)},delta:{x:0,y:0},extent:o.extent,parentNode:o.parentNode||o.parentId,parentId:o.parentNode||o.parentId,width:o.width,height:o.height,expandParent:o.expandParent}})}function ju(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function ts(e,t,n,r,o=[0,0],i){const s=ju(e,e.extent||r);let a=s;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=n.get(c),{x:d,y:m}=Ze(f,o).positionAbsolute;a=f&&pe(d)&&pe(m)&&pe(f.width)&&pe(f.height)?[[d+e.width*o[0],m+e.height*o[1]],[d+f.width-e.width+e.width*o[0],m+f.height-e.height+e.height*o[1]]]:a}else i==null||i("005",ze.error005()),a=s;else if(e.extent&&c&&e.extent!=="parent"){const f=n.get(c),{x:d,y:m}=Ze(f,o).positionAbsolute;a=[[e.extent[0][0]+d,e.extent[0][1]+m],[e.extent[1][0]+d,e.extent[1][1]+m]]}let u={x:0,y:0};if(c){const f=n.get(c);u=Ze(f,o).positionAbsolute}const l=a&&a!=="parent"?Wn(t,a):t;return{position:{x:l.x-u.x,y:l.y-u.y},positionAbsolute:l}}function _n({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(o=>({...n.get(o.id),position:o.position,positionAbsolute:o.positionAbsolute}));return[e?r.find(o=>o.id===e):r[0],r]}const Hr=(e,t,n,r)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const i=Array.from(o),s=t.getBoundingClientRect(),a={x:s.width*r[0],y:s.height*r[1]};return i.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-s.left-a.x)/n,y:(u.top-s.top-a.y)/n,...Xn(c)}})};function yt(e,t,n){return n===void 0?n:r=>{const o=t().nodeInternals.get(e);o&&n(r,{...o})}}function Hn({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:s,nodeInternals:a,onError:c}=t.getState(),u=a.get(e);if(!u){c==null||c("012",ze.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&s)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var l;return(l=r==null?void 0:r.current)==null?void 0:l.blur()})):o([e])}function Yu(){const e=ie();return S.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:o,snapToGrid:i}=e.getState(),s=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,c={x:(s-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:i?o[0]*Math.round(c.x/o[0]):c.x,ySnapped:i?o[1]*Math.round(c.y/o[1]):c.y,...c}},[])}function Sn(e){return(t,n,r)=>e==null?void 0:e(t,r)}function ns({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:i,selectNodesOnDrag:s}){const a=ie(),[c,u]=S.useState(!1),l=S.useRef([]),f=S.useRef({x:null,y:null}),d=S.useRef(0),m=S.useRef(null),y=S.useRef({x:0,y:0}),p=S.useRef(null),E=S.useRef(!1),g=S.useRef(!1),b=S.useRef(!1),M=Yu();return S.useEffect(()=>{if(e!=null&&e.current){const x=me(e.current),$=({x:O,y:D})=>{const{nodeInternals:H,onNodeDrag:P,onSelectionDrag:F,updateNodePositions:L,nodeExtent:h,snapGrid:N,snapToGrid:w,nodeOrigin:z,onError:R}=a.getState();f.current={x:O,y:D};let _=!1,v={x:0,y:0,x2:0,y2:0};if(l.current.length>1&&h){const T=on(l.current,z);v=Nt(T)}if(l.current=l.current.map(T=>{var Z,U;const B={x:O-T.distance.x,y:D-T.distance.y};w&&(B.x=N[0]*Math.round(B.x/N[0]),B.y=N[1]*Math.round(B.y/N[1]));const j=[[h[0][0],h[0][1]],[h[1][0],h[1][1]]];l.current.length>1&&h&&!T.extent&&(j[0][0]=T.positionAbsolute.x-v.x+h[0][0],j[1][0]=T.positionAbsolute.x+((Z=T.width)!=null?Z:0)-v.x2+h[1][0],j[0][1]=T.positionAbsolute.y-v.y+h[0][1],j[1][1]=T.positionAbsolute.y+((U=T.height)!=null?U:0)-v.y2+h[1][1]);const W=ts(T,B,H,j,z,R);return _=_||T.position.x!==W.position.x||T.position.y!==W.position.y,T.position=W.position,T.positionAbsolute=W.positionAbsolute,T}),!_)return;L(l.current,!0,!0),u(!0);const A=o?P:Sn(F);if(A&&p.current){const[T,B]=_n({nodeId:o,dragItems:l.current,nodeInternals:H});A(p.current,T,B)}},I=()=>{var H,P;if(!m.current)return;const[O,D]=_o(y.current,m.current);if(O!==0||D!==0){const{transform:F,panBy:L}=a.getState();f.current.x=((H=f.current.x)!=null?H:0)-O/F[2],f.current.y=((P=f.current.y)!=null?P:0)-D/F[2],L({x:O,y:D})&&$(f.current)}d.current=requestAnimationFrame(I)},V=O=>{var z;const{nodeInternals:D,multiSelectionActive:H,nodesDraggable:P,unselectNodesAndEdges:F,onNodeDragStart:L,onSelectionDragStart:h}=a.getState();g.current=!0;const N=o?L:Sn(h);(!s||!i)&&!H&&o&&((z=D.get(o))!=null&&z.selected||F()),o&&i&&s&&Hn({id:o,store:a,nodeRef:e});const w=M(O);if(f.current=w,l.current=Bu(D,P,w,o),N&&l.current){const[R,_]=_n({nodeId:o,dragItems:l.current,nodeInternals:D});N(O.sourceEvent,R,_)}};if(t)x.on(".drag",null);else{const O=Mc().on("start",D=>{const{domNode:H,nodeDragThreshold:P}=a.getState();P===0&&V(D),b.current=!1;const F=M(D);f.current=F,m.current=(H==null?void 0:H.getBoundingClientRect())||null,y.current=He(D.sourceEvent,m.current)}).on("drag",D=>{var L,h,N,w;const H=M(D),{autoPanOnNodeDrag:P,nodeDragThreshold:F}=a.getState();if(D.sourceEvent.type==="touchmove"&&D.sourceEvent.touches.length>1&&(b.current=!0),!b.current){if(!E.current&&g.current&&P&&(E.current=!0,I()),!g.current){const z=H.xSnapped-((h=(L=f==null?void 0:f.current)==null?void 0:L.x)!=null?h:0),R=H.ySnapped-((w=(N=f==null?void 0:f.current)==null?void 0:N.y)!=null?w:0);Math.sqrt(z*z+R*R)>F&&V(D)}(f.current.x!==H.xSnapped||f.current.y!==H.ySnapped)&&l.current&&g.current&&(p.current=D.sourceEvent,y.current=He(D.sourceEvent,m.current),$(H))}}).on("end",D=>{if(!(!g.current||b.current)&&(u(!1),E.current=!1,g.current=!1,cancelAnimationFrame(d.current),l.current)){const{updateNodePositions:H,nodeInternals:P,onNodeDragStop:F,onSelectionDragStop:L}=a.getState(),h=o?F:Sn(L);if(H(l.current,!1,!1),h){const[N,w]=_n({nodeId:o,dragItems:l.current,nodeInternals:P});h(D.sourceEvent,N,w)}}}).filter(D=>{const H=D.target;return!D.button&&(!n||!Pr(H,`.${n}`,e))&&(!r||Pr(H,r,e))});return x.call(O),()=>{x.on(".drag",null)}}}},[e,t,n,r,i,a,o,s,M]),c}function rs(){const e=ie();return S.useCallback(n=>{const{nodeInternals:r,nodeExtent:o,updateNodePositions:i,getNodes:s,snapToGrid:a,snapGrid:c,onError:u,nodesDraggable:l}=e.getState(),f=s().filter(b=>b.selected&&(b.draggable||l&&typeof b.draggable>"u")),d=a?c[0]:5,m=a?c[1]:5,y=n.isShiftPressed?4:1,p=n.x*d*y,E=n.y*m*y,g=f.map(b=>{if(b.positionAbsolute){const M={x:b.positionAbsolute.x+p,y:b.positionAbsolute.y+E};a&&(M.x=c[0]*Math.round(M.x/c[0]),M.y=c[1]*Math.round(M.y/c[1]));const{positionAbsolute:x,position:$}=ts(b,M,r,o,void 0,u);b.position=$,b.positionAbsolute=x}return b});i(g,!0,!1)},[])}const at={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var wt=e=>{const t=({id:n,type:r,data:o,xPos:i,yPos:s,xPosOrigin:a,yPosOrigin:c,selected:u,onClick:l,onMouseEnter:f,onMouseMove:d,onMouseLeave:m,onContextMenu:y,onDoubleClick:p,style:E,className:g,isDraggable:b,isSelectable:M,isConnectable:x,isFocusable:$,selectNodesOnDrag:I,sourcePosition:V,targetPosition:O,hidden:D,resizeObserver:H,dragHandle:P,zIndex:F,isParent:L,noDragClassName:h,noPanClassName:N,initialized:w,disableKeyboardA11y:z,ariaLabel:R,rfId:_,hasHandleBounds:v})=>{const A=ie(),T=S.useRef(null),B=S.useRef(null),j=S.useRef(V),W=S.useRef(O),Z=S.useRef(r),U=M||b||l||f||d||m,q=rs(),Q=yt(n,A.getState,f),oe=yt(n,A.getState,d),ne=yt(n,A.getState,m),K=yt(n,A.getState,y),ae=yt(n,A.getState,p),se=J=>{const{nodeDragThreshold:X}=A.getState();if(M&&(!I||!b||X>0)&&Hn({id:n,store:A,nodeRef:T}),l){const ue=A.getState().nodeInternals.get(n);ue&&l(J,{...ue})}},ee=J=>{if(!zn(J)&&!z)if(bo.includes(J.key)&&M){const X=J.key==="Escape";Hn({id:n,store:A,unselect:X,nodeRef:T})}else b&&u&&Object.prototype.hasOwnProperty.call(at,J.key)&&(A.setState({ariaLiveMessage:`Moved selected node ${J.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~s}`}),q({x:at[J.key].x,y:at[J.key].y,isShiftPressed:J.shiftKey}))};S.useEffect(()=>()=>{B.current&&(H==null||H.unobserve(B.current),B.current=null)},[]),S.useEffect(()=>{if(T.current&&!D){const J=T.current;(!w||!v||B.current!==J)&&(B.current&&(H==null||H.unobserve(B.current)),H==null||H.observe(J),B.current=J)}},[D,w,v]),S.useEffect(()=>{const J=Z.current!==r,X=j.current!==V,ue=W.current!==O;T.current&&(J||X||ue)&&(J&&(Z.current=r),X&&(j.current=V),ue&&(W.current=O),A.getState().updateNodeDimensions([{id:n,nodeElement:T.current,forceUpdate:!0}]))},[n,r,V,O]);const ce=ns({nodeRef:T,disabled:D||!b,noDragClassName:h,handleSelector:P,nodeId:n,isSelectable:M,selectNodesOnDrag:I});return D?null:k.createElement("div",{className:le(["react-flow__node",`react-flow__node-${r}`,{[N]:b},g,{selected:u,selectable:M,parent:L,dragging:ce}]),ref:T,style:{zIndex:F,transform:`translate(${a}px,${c}px)`,pointerEvents:U?"all":"none",visibility:w?"visible":"hidden",...E},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:Q,onMouseMove:oe,onMouseLeave:ne,onContextMenu:K,onClick:se,onDoubleClick:ae,onKeyDown:$?ee:void 0,tabIndex:$?0:void 0,role:$?"button":void 0,"aria-describedby":z?void 0:`${Wo}-${_}`,"aria-label":R},k.createElement(su,{value:n},k.createElement(e,{id:n,data:o,type:r,xPos:i,yPos:s,selected:u,isConnectable:x,sourcePosition:V,targetPosition:O,dragging:ce,dragHandle:P,zIndex:F})))};return t.displayName="NodeWrapper",S.memo(t)};const Xu=e=>{const t=e.getNodes().filter(n=>n.selected);return{...on(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Wu({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ie(),{width:o,height:i,x:s,y:a,transformString:c,userSelectionActive:u}=te(Xu,de),l=rs(),f=S.useRef(null);if(S.useEffect(()=>{var y;n||(y=f.current)==null||y.focus({preventScroll:!0})},[n]),ns({nodeRef:f}),u||!o||!i)return null;const d=e?y=>{const p=r.getState().getNodes().filter(E=>E.selected);e(y,p)}:void 0,m=y=>{Object.prototype.hasOwnProperty.call(at,y.key)&&l({x:at[y.key].x,y:at[y.key].y,isShiftPressed:y.shiftKey})};return k.createElement("div",{className:le(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},k.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:m,style:{width:o,height:i,top:a,left:s}}))}var Uu=S.memo(Wu);const Zu=e=>e.nodesSelectionActive,os=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,deleteKeyCode:a,onMove:c,onMoveStart:u,onMoveEnd:l,selectionKeyCode:f,selectionOnDrag:d,selectionMode:m,onSelectionStart:y,onSelectionEnd:p,multiSelectionKeyCode:E,panActivationKeyCode:g,zoomActivationKeyCode:b,elementsSelectable:M,zoomOnScroll:x,zoomOnPinch:$,panOnScroll:I,panOnScrollSpeed:V,panOnScrollMode:O,zoomOnDoubleClick:D,panOnDrag:H,defaultViewport:P,translateExtent:F,minZoom:L,maxZoom:h,preventScrolling:N,onSelectionContextMenu:w,noWheelClassName:z,noPanClassName:R,disableKeyboardA11y:_})=>{const v=te(Zu),A=Ct(f),T=Ct(g),B=T||H,j=T||I,W=A||d&&B!==!0;return Iu({deleteKeyCode:a,multiSelectionKeyCode:E}),k.createElement(Hu,{onMove:c,onMoveStart:u,onMoveEnd:l,onPaneContextMenu:i,elementsSelectable:M,zoomOnScroll:x,zoomOnPinch:$,panOnScroll:j,panOnScrollSpeed:V,panOnScrollMode:O,zoomOnDoubleClick:D,panOnDrag:!A&&B,defaultViewport:P,translateExtent:F,minZoom:L,maxZoom:h,zoomActivationKeyCode:b,preventScrolling:N,noWheelClassName:z,noPanClassName:R},k.createElement(Qo,{onSelectionStart:y,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:B,isSelecting:!!W,selectionMode:m},e,v&&k.createElement(Uu,{onSelectionContextMenu:w,noPanClassName:R,disableKeyboardA11y:_})))};os.displayName="FlowRenderer";var Gu=S.memo(os);function qu(e){return te(S.useCallback(n=>e?Io(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Ku(e){const t={input:wt(e.input||Bo),default:wt(e.default||Pn),output:wt(e.output||Yo),group:wt(e.group||Jn)},n={},r=Object.keys(e).filter(o=>!["input","default","output","group"].includes(o)).reduce((o,i)=>(o[i]=wt(e[i]||Pn),o),n);return{...t,...r}}const Ju=({x:e,y:t,width:n,height:r,origin:o})=>!n||!r?{x:e,y:t}:o[0]<0||o[1]<0||o[0]>1||o[1]>1?{x:e,y:t}:{x:e-n*o[0],y:t-r*o[1]},Qu=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),ss=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,updateNodeDimensions:i,onError:s}=te(Qu,de),a=qu(e.onlyRenderVisibleElements),c=S.useRef(),u=S.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const l=new ResizeObserver(f=>{const d=f.map(m=>({id:m.target.getAttribute("data-id"),nodeElement:m.target,forceUpdate:!0}));i(d)});return c.current=l,l},[]);return S.useEffect(()=>()=>{var l;(l=c==null?void 0:c.current)==null||l.disconnect()},[]),k.createElement("div",{className:"react-flow__nodes",style:er},a.map(l=>{var $,I,V,O,D,H,P,F;let f=l.type||"default";e.nodeTypes[f]||(s==null||s("003",ze.error003(f)),f="default");const d=e.nodeTypes[f]||e.nodeTypes.default,m=!!(l.draggable||t&&typeof l.draggable>"u"),y=!!(l.selectable||o&&typeof l.selectable>"u"),p=!!(l.connectable||n&&typeof l.connectable>"u"),E=!!(l.focusable||r&&typeof l.focusable>"u"),g=e.nodeExtent?Wn(l.positionAbsolute,e.nodeExtent):l.positionAbsolute,b=($=g==null?void 0:g.x)!=null?$:0,M=(I=g==null?void 0:g.y)!=null?I:0,x=Ju({x:b,y:M,width:(V=l.width)!=null?V:0,height:(O=l.height)!=null?O:0,origin:e.nodeOrigin});return k.createElement(d,{key:l.id,id:l.id,className:l.className,style:l.style,type:f,data:l.data,sourcePosition:l.sourcePosition||Y.Bottom,targetPosition:l.targetPosition||Y.Top,hidden:l.hidden,xPos:b,yPos:M,xPosOrigin:x.x,yPosOrigin:x.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!l.selected,isDraggable:m,isSelectable:y,isConnectable:p,isFocusable:E,resizeObserver:u,dragHandle:l.dragHandle,zIndex:(H=(D=l[re])==null?void 0:D.z)!=null?H:0,isParent:!!((P=l[re])!=null&&P.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!l.width&&!!l.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:l.ariaLabel,hasHandleBounds:!!((F=l[re])!=null&&F.handleBounds)})}))};ss.displayName="NodeRenderer";var ef=S.memo(ss);const tf=(e,t,n)=>n===Y.Left?e-t:n===Y.Right?e+t:e,nf=(e,t,n)=>n===Y.Top?e-t:n===Y.Bottom?e+t:e,Lr="react-flow__edgeupdater",Vr=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:a})=>k.createElement("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:le([Lr,`${Lr}-${a}`]),cx:tf(t,r,e),cy:nf(n,r,e),r,stroke:"transparent",fill:"transparent"}),rf=()=>!0;var ot=e=>{const t=({id:n,className:r,type:o,data:i,onClick:s,onEdgeDoubleClick:a,selected:c,animated:u,label:l,labelStyle:f,labelShowBg:d,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:p,style:E,source:g,target:b,sourceX:M,sourceY:x,targetX:$,targetY:I,sourcePosition:V,targetPosition:O,elementsSelectable:D,hidden:H,sourceHandleId:P,targetHandleId:F,onContextMenu:L,onMouseEnter:h,onMouseMove:N,onMouseLeave:w,reconnectRadius:z,onReconnect:R,onReconnectStart:_,onReconnectEnd:v,markerEnd:A,markerStart:T,rfId:B,ariaLabel:j,isFocusable:W,isReconnectable:Z,pathOptions:U,interactionWidth:q,disableKeyboardA11y:Q})=>{const oe=S.useRef(null),[ne,K]=S.useState(!1),[ae,se]=S.useState(!1),ee=ie(),ce=S.useMemo(()=>`url('#${Dn(T,B)}')`,[T,B]),J=S.useMemo(()=>`url('#${Dn(A,B)}')`,[A,B]);if(H)return null;const X=fe=>{var ve;const{edges:ge,addSelectedEdges:Fe,unselectNodesAndEdges:Be,multiSelectionActive:je}=ee.getState(),ke=ge.find(dt=>dt.id===n);ke&&(D&&(ee.setState({nodesSelectionActive:!1}),ke.selected&&je?(Be({nodes:[],edges:[ke]}),(ve=oe.current)==null||ve.blur()):Fe([n])),s&&s(fe,ke))},ue=gt(n,ee.getState,a),be=gt(n,ee.getState,L),Le=gt(n,ee.getState,h),Ie=gt(n,ee.getState,N),Ke=gt(n,ee.getState,w),Ce=(fe,ge)=>{if(fe.button!==0)return;const{edges:Fe,isValidConnection:Be}=ee.getState(),je=ge?b:g,ke=(ge?F:P)||null,ve=ge?"target":"source",dt=Be||rf,sn=ge,ht=Fe.find(Ye=>Ye.id===n);se(!0),_==null||_(fe,ht,ve);const an=Ye=>{se(!1),v==null||v(Ye,ht,ve)};Lo({event:fe,handleId:ke,nodeId:je,onConnect:Ye=>R==null?void 0:R(ht,Ye),isTarget:sn,getState:ee.getState,setState:ee.setState,isValidConnection:dt,edgeUpdaterType:ve,onReconnectEnd:an})},Je=fe=>Ce(fe,!0),Ve=fe=>Ce(fe,!1),Oe=()=>K(!0),Qe=()=>K(!1),et=!D&&!s,ft=fe=>{var ge;if(!Q&&bo.includes(fe.key)&&D){const{unselectNodesAndEdges:Fe,addSelectedEdges:Be,edges:je}=ee.getState();fe.key==="Escape"?((ge=oe.current)==null||ge.blur(),Fe({edges:[je.find(ve=>ve.id===n)]})):Be([n])}};return k.createElement("g",{className:le(["react-flow__edge",`react-flow__edge-${o}`,r,{selected:c,animated:u,inactive:et,updating:ne}]),onClick:X,onDoubleClick:ue,onContextMenu:be,onMouseEnter:Le,onMouseMove:Ie,onMouseLeave:Ke,onKeyDown:W?ft:void 0,tabIndex:W?0:void 0,role:W?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":j===null?void 0:j||`Edge from ${g} to ${b}`,"aria-describedby":W?`${Uo}-${B}`:void 0,ref:oe},!ae&&k.createElement(e,{id:n,source:g,target:b,selected:c,animated:u,label:l,labelStyle:f,labelShowBg:d,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:p,data:i,style:E,sourceX:M,sourceY:x,targetX:$,targetY:I,sourcePosition:V,targetPosition:O,sourceHandleId:P,targetHandleId:F,markerStart:ce,markerEnd:J,pathOptions:U,interactionWidth:q}),Z&&k.createElement(k.Fragment,null,(Z==="source"||Z===!0)&&k.createElement(Vr,{position:V,centerX:M,centerY:x,radius:z,onMouseDown:Je,onMouseEnter:Oe,onMouseOut:Qe,type:"source"}),(Z==="target"||Z===!0)&&k.createElement(Vr,{position:O,centerX:$,centerY:I,radius:z,onMouseDown:Ve,onMouseEnter:Oe,onMouseOut:Qe,type:"target"})))};return t.displayName="EdgeWrapper",S.memo(t)};function of(e){const t={default:ot(e.default||qt),straight:ot(e.bezier||Gn),step:ot(e.step||Zn),smoothstep:ot(e.step||rn),simplebezier:ot(e.simplebezier||Un)},n={},r=Object.keys(e).filter(o=>!["default","bezier"].includes(o)).reduce((o,i)=>(o[i]=ot(e[i]||qt),o),n);return{...t,...r}}function Or(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,o=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,s=(n==null?void 0:n.height)||t.height;switch(e){case Y.Top:return{x:r+i/2,y:o};case Y.Right:return{x:r+i,y:o+s/2};case Y.Bottom:return{x:r+i/2,y:o+s};case Y.Left:return{x:r,y:o+s/2}}}function Fr(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const sf=(e,t,n,r,o,i)=>{const s=Or(n,e,t),a=Or(i,r,o);return{sourceX:s.x,sourceY:s.y,targetX:a.x,targetY:a.y}};function af({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:o,targetHeight:i,width:s,height:a,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+o),y2:Math.max(e.y+r,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const l=Nt({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:s/c[2],height:a/c[2]}),f=Math.max(0,Math.min(l.x2,u.x2)-Math.max(l.x,u.x)),d=Math.max(0,Math.min(l.y2,u.y2)-Math.max(l.y,u.y));return Math.ceil(f*d)>0}function Br(e){var r,o,i,s,a;const t=((r=e==null?void 0:e[re])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const cf=[{level:0,isMaxLevel:!0,edges:[]}];function lf(e,t,n=!1){let r=-1;const o=e.reduce((s,a)=>{var l,f;const c=pe(a.zIndex);let u=c?a.zIndex:0;if(n){const d=t.get(a.target),m=t.get(a.source),y=a.selected||(d==null?void 0:d.selected)||(m==null?void 0:m.selected),p=Math.max(((l=m==null?void 0:m[re])==null?void 0:l.z)||0,((f=d==null?void 0:d[re])==null?void 0:f.z)||0,1e3);u=(c?a.zIndex:0)+(y?p:0)}return s[u]?s[u].push(a):s[u]=[a],r=u>r?u:r,s},{}),i=Object.entries(o).map(([s,a])=>{const c=+s;return{edges:a,level:c,isMaxLevel:c===r}});return i.length===0?cf:i}function uf(e,t,n){const r=te(S.useCallback(o=>e?o.edges.filter(i=>{const s=t.get(i.source),a=t.get(i.target);return(s==null?void 0:s.width)&&(s==null?void 0:s.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&af({sourcePos:s.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:s.width,sourceHeight:s.height,targetWidth:a.width,targetHeight:a.height,width:o.width,height:o.height,transform:o.transform})}):o.edges,[e,t]));return lf(r,t,n)}const ff=({color:e="none",strokeWidth:t=1})=>k.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),df=({color:e="none",strokeWidth:t=1})=>k.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),jr={[Gt.Arrow]:ff,[Gt.ArrowClosed]:df};function hf(e){const t=ie();return S.useMemo(()=>{var o,i;return Object.prototype.hasOwnProperty.call(jr,e)?jr[e]:((i=(o=t.getState()).onError)==null||i.call(o,"009",ze.error009(e)),null)},[e])}const mf=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const c=hf(t);return c?k.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0"},k.createElement(c,{color:n,strokeWidth:s})):null},pf=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((o,i)=>([i.markerStart,i.markerEnd].forEach(s=>{if(s&&typeof s=="object"){const a=Dn(s,t);r.includes(a)||(o.push({id:a,color:s.color||e,...s}),r.push(a))}}),o),[]).sort((o,i)=>o.id.localeCompare(i.id))},is=({defaultColor:e,rfId:t})=>{const n=te(S.useCallback(pf({defaultColor:e,rfId:t}),[e,t]),(r,o)=>!(r.length!==o.length||r.some((i,s)=>i.id!==o[s].id)));return k.createElement("defs",null,n.map(r=>k.createElement(mf,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};is.displayName="MarkerDefinitions";var gf=S.memo(is);const yf=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),as=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:o,noPanClassName:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:l,onEdgeDoubleClick:f,onReconnect:d,onReconnectStart:m,onReconnectEnd:y,reconnectRadius:p,children:E,disableKeyboardA11y:g})=>{const{edgesFocusable:b,edgesUpdatable:M,elementsSelectable:x,width:$,height:I,connectionMode:V,nodeInternals:O,onError:D}=te(yf,de),H=uf(t,O,n);return $?k.createElement(k.Fragment,null,H.map(({level:P,edges:F,isMaxLevel:L})=>k.createElement("svg",{key:P,style:{zIndex:P},width:$,height:I,className:"react-flow__edges react-flow__container"},L&&k.createElement(gf,{defaultColor:e,rfId:r}),k.createElement("g",null,F.map(h=>{var ee,ce;const[N,w,z]=Br(O.get(h.source)),[R,_,v]=Br(O.get(h.target));if(!z||!v)return null;let A=h.type||"default";o[A]||(D==null||D("011",ze.error011(A)),A="default");const T=o[A]||o.default,B=V===qe.Strict?_.target:((ee=_.target)!=null?ee:[]).concat((ce=_.source)!=null?ce:[]),j=Fr(w.source,h.sourceHandle),W=Fr(B,h.targetHandle),Z=(j==null?void 0:j.position)||Y.Bottom,U=(W==null?void 0:W.position)||Y.Top,q=!!(h.focusable||b&&typeof h.focusable>"u"),Q=h.reconnectable||h.updatable,oe=typeof d<"u"&&(Q||M&&typeof Q>"u");if(!j||!W)return D==null||D("008",ze.error008(j,h)),null;const{sourceX:ne,sourceY:K,targetX:ae,targetY:se}=sf(N,j,Z,R,W,U);return k.createElement(T,{key:h.id,id:h.id,className:le([h.className,i]),type:A,data:h.data,selected:!!h.selected,animated:!!h.animated,hidden:!!h.hidden,label:h.label,labelStyle:h.labelStyle,labelShowBg:h.labelShowBg,labelBgStyle:h.labelBgStyle,labelBgPadding:h.labelBgPadding,labelBgBorderRadius:h.labelBgBorderRadius,style:h.style,source:h.source,target:h.target,sourceHandleId:h.sourceHandle,targetHandleId:h.targetHandle,markerEnd:h.markerEnd,markerStart:h.markerStart,sourceX:ne,sourceY:K,targetX:ae,targetY:se,sourcePosition:Z,targetPosition:U,elementsSelectable:x,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:u,onClick:l,onEdgeDoubleClick:f,onReconnect:d,onReconnectStart:m,onReconnectEnd:y,reconnectRadius:p,rfId:r,ariaLabel:h.ariaLabel,isFocusable:q,isReconnectable:oe,pathOptions:"pathOptions"in h?h.pathOptions:void 0,interactionWidth:h.interactionWidth,disableKeyboardA11y:g})})))),E):null};as.displayName="EdgeRenderer";var wf=S.memo(as);const xf=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function vf({children:e}){const t=te(xf);return k.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function _f(e){const t=Qn(),n=S.useRef(!1);S.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Sf={[Y.Left]:Y.Right,[Y.Right]:Y.Left,[Y.Top]:Y.Bottom,[Y.Bottom]:Y.Top},cs=({nodeId:e,handleType:t,style:n,type:r=Pe.Bezier,CustomComponent:o,connectionStatus:i})=>{var I,V,O,D,H,P,F;const{fromNode:s,handleId:a,toX:c,toY:u,connectionMode:l}=te(S.useCallback(L=>({fromNode:L.nodeInternals.get(e),handleId:L.connectionHandleId,toX:(L.connectionPosition.x-L.transform[0])/L.transform[2],toY:(L.connectionPosition.y-L.transform[1])/L.transform[2],connectionMode:L.connectionMode}),[e]),de),f=(I=s==null?void 0:s[re])==null?void 0:I.handleBounds;let d=f==null?void 0:f[t];if(l===qe.Loose&&(d=d||(f==null?void 0:f[t==="source"?"target":"source"])),!s||!d)return null;const m=a?d.find(L=>L.id===a):d[0],y=m?m.x+m.width/2:((V=s.width)!=null?V:0)/2,p=m?m.y+m.height/2:(O=s.height)!=null?O:0,E=((H=(D=s.positionAbsolute)==null?void 0:D.x)!=null?H:0)+y,g=((F=(P=s.positionAbsolute)==null?void 0:P.y)!=null?F:0)+p,b=m==null?void 0:m.position,M=b?Sf[b]:null;if(!b||!M)return null;if(o)return k.createElement(o,{connectionLineType:r,connectionLineStyle:n,fromNode:s,fromHandle:m,fromX:E,fromY:g,toX:c,toY:u,fromPosition:b,toPosition:M,connectionStatus:i});let x="";const $={sourceX:E,sourceY:g,sourcePosition:b,targetX:c,targetY:u,targetPosition:M};return r===Pe.Bezier?[x]=Ao($):r===Pe.Step?[x]=In({...$,borderRadius:0}):r===Pe.SmoothStep?[x]=In($):r===Pe.SimpleBezier?[x]=To($):x=`M${E},${g} ${c},${u}`,k.createElement("path",{d:x,fill:"none",className:"react-flow__connection-path",style:n})};cs.displayName="ConnectionLine";const Ef=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function Nf({containerStyle:e,style:t,type:n,component:r}){const{nodeId:o,handleType:i,nodesConnectable:s,width:a,height:c,connectionStatus:u}=te(Ef,de);return!(o&&i&&a&&s)?null:k.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},k.createElement("g",{className:le(["react-flow__connection",u])},k.createElement(cs,{nodeId:o,handleType:i,style:t,type:n,CustomComponent:r,connectionStatus:u})))}function Yr(e,t){return S.useRef(null),ie(),S.useMemo(()=>t(e),[e])}const ls=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:o,onInit:i,onNodeClick:s,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:l,onNodeMouseMove:f,onNodeMouseLeave:d,onNodeContextMenu:m,onSelectionContextMenu:y,onSelectionStart:p,onSelectionEnd:E,connectionLineType:g,connectionLineStyle:b,connectionLineComponent:M,connectionLineContainerStyle:x,selectionKeyCode:$,selectionOnDrag:I,selectionMode:V,multiSelectionKeyCode:O,panActivationKeyCode:D,zoomActivationKeyCode:H,deleteKeyCode:P,onlyRenderVisibleElements:F,elementsSelectable:L,selectNodesOnDrag:h,defaultViewport:N,translateExtent:w,minZoom:z,maxZoom:R,preventScrolling:_,defaultMarkerColor:v,zoomOnScroll:A,zoomOnPinch:T,panOnScroll:B,panOnScrollSpeed:j,panOnScrollMode:W,zoomOnDoubleClick:Z,panOnDrag:U,onPaneClick:q,onPaneMouseEnter:Q,onPaneMouseMove:oe,onPaneMouseLeave:ne,onPaneScroll:K,onPaneContextMenu:ae,onEdgeContextMenu:se,onEdgeMouseEnter:ee,onEdgeMouseMove:ce,onEdgeMouseLeave:J,onReconnect:X,onReconnectStart:ue,onReconnectEnd:be,reconnectRadius:Le,noDragClassName:Ie,noWheelClassName:Ke,noPanClassName:Ce,elevateEdgesOnSelect:Je,disableKeyboardA11y:Ve,nodeOrigin:Oe,nodeExtent:Qe,rfId:et})=>{const ft=Yr(e,Ku),fe=Yr(t,of);return _f(i),k.createElement(Gu,{onPaneClick:q,onPaneMouseEnter:Q,onPaneMouseMove:oe,onPaneMouseLeave:ne,onPaneContextMenu:ae,onPaneScroll:K,deleteKeyCode:P,selectionKeyCode:$,selectionOnDrag:I,selectionMode:V,onSelectionStart:p,onSelectionEnd:E,multiSelectionKeyCode:O,panActivationKeyCode:D,zoomActivationKeyCode:H,elementsSelectable:L,onMove:n,onMoveStart:r,onMoveEnd:o,zoomOnScroll:A,zoomOnPinch:T,zoomOnDoubleClick:Z,panOnScroll:B,panOnScrollSpeed:j,panOnScrollMode:W,panOnDrag:U,defaultViewport:N,translateExtent:w,minZoom:z,maxZoom:R,onSelectionContextMenu:y,preventScrolling:_,noDragClassName:Ie,noWheelClassName:Ke,noPanClassName:Ce,disableKeyboardA11y:Ve},k.createElement(vf,null,k.createElement(wf,{edgeTypes:fe,onEdgeClick:a,onEdgeDoubleClick:u,onlyRenderVisibleElements:F,onEdgeContextMenu:se,onEdgeMouseEnter:ee,onEdgeMouseMove:ce,onEdgeMouseLeave:J,onReconnect:X,onReconnectStart:ue,onReconnectEnd:be,reconnectRadius:Le,defaultMarkerColor:v,noPanClassName:Ce,elevateEdgesOnSelect:!!Je,disableKeyboardA11y:Ve,rfId:et},k.createElement(Nf,{style:b,type:g,component:M,containerStyle:x})),k.createElement("div",{className:"react-flow__edgelabel-renderer"}),k.createElement(ef,{nodeTypes:ft,onNodeClick:s,onNodeDoubleClick:c,onNodeMouseEnter:l,onNodeMouseMove:f,onNodeMouseLeave:d,onNodeContextMenu:m,selectNodesOnDrag:h,onlyRenderVisibleElements:F,noPanClassName:Ce,noDragClassName:Ie,disableKeyboardA11y:Ve,nodeOrigin:Oe,nodeExtent:Qe,rfId:et})))};ls.displayName="GraphView";var bf=S.memo(ls);const Ln=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],De={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Ln,nodeExtent:Ln,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:qe.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Ql,isValidConnection:void 0},Cf=()=>Oi((e,t)=>({...De,setNodes:n=>{const{nodeInternals:r,nodeOrigin:o,elevateNodesOnSelect:i}=t();e({nodeInternals:xn(n,r,o,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(o=>({...r,...o}))})},setDefaultNodesAndEdges:(n,r)=>{const o=typeof n<"u",i=typeof r<"u",s=o?xn(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:s,edges:i?r:[],hasDefaultNodes:o,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:o,fitViewOnInit:i,fitViewOnInitDone:s,fitViewOnInitOptions:a,domNode:c,nodeOrigin:u}=t(),l=c==null?void 0:c.querySelector(".react-flow__viewport");if(!l)return;const f=window.getComputedStyle(l),{m22:d}=new window.DOMMatrixReadOnly(f.transform),m=n.reduce((p,E)=>{const g=o.get(E.id);if(g!=null&&g.hidden)o.set(g.id,{...g,[re]:{...g[re],handleBounds:void 0}});else if(g){const b=Xn(E.nodeElement);!!(b.width&&b.height&&(g.width!==b.width||g.height!==b.height||E.forceUpdate))&&(o.set(g.id,{...g,[re]:{...g[re],handleBounds:{source:Hr(".source",E.nodeElement,d,u),target:Hr(".target",E.nodeElement,d,u)}},...b}),p.push({id:g.id,type:"dimensions",dimensions:b}))}return p},[]);Go(o,u);const y=s||i&&!s&&qo(t,{initial:!0,...a});e({nodeInternals:new Map(o),fitViewOnInitDone:y}),(m==null?void 0:m.length)>0&&(r==null||r(m))},updateNodePositions:(n,r=!0,o=!1)=>{const{triggerNodeChanges:i}=t(),s=n.map(a=>{const c={id:a.id,type:"position",dragging:o};return r&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});i(s)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:o,hasDefaultNodes:i,nodeOrigin:s,getNodes:a,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(i){const u=Jo(n,a()),l=xn(u,o,s,c);e({nodeInternals:l})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let s,a=null;r?s=n.map(c=>Re(c,!0)):(s=st(i(),n),a=st(o,[])),Lt({changedNodes:s,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let s,a=null;r?s=n.map(c=>Re(c,!0)):(s=st(o,n),a=st(i(),[])),Lt({changedNodes:a,changedEdges:s,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:o,getNodes:i}=t(),s=n||i(),a=r||o,c=s.map(l=>(l.selected=!1,Re(l.id,!1))),u=a.map(l=>Re(l.id,!1));Lt({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:o}=t();r==null||r.scaleExtent([n,o]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:o}=t();r==null||r.scaleExtent([o,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),i=r().filter(a=>a.selected).map(a=>Re(a.id,!1)),s=n.filter(a=>a.selected).map(a=>Re(a.id,!1));Lt({changedNodes:i,changedEdges:s,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(o=>{o.positionAbsolute=Wn(o.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:o,height:i,d3Zoom:s,d3Selection:a,translateExtent:c}=t();if(!s||!a||!n.x&&!n.y)return!1;const u=Ae.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),l=[[0,0],[o,i]],f=s==null?void 0:s.constrain()(u,l,c);return s.transform(a,f),r[0]!==f.x||r[1]!==f.y||r[2]!==f.k},cancelConnection:()=>e({connectionNodeId:De.connectionNodeId,connectionHandleId:De.connectionHandleId,connectionHandleType:De.connectionHandleType,connectionStatus:De.connectionStatus,connectionStartHandle:De.connectionStartHandle,connectionEndHandle:De.connectionEndHandle}),reset:()=>e({...De})}),Object.is),us=({children:e})=>{const t=S.useRef(null);return t.current||(t.current=Cf()),k.createElement(Wl,{value:t.current},e)};us.displayName="ReactFlowProvider";const fs=({children:e})=>S.useContext(nn)?k.createElement(k.Fragment,null,e):k.createElement(us,null,e);fs.displayName="ReactFlowWrapper";const kf={input:Bo,default:Pn,output:Yo,group:Jn},Mf={default:qt,straight:Gn,step:Zn,smoothstep:rn,simplebezier:Un},Tf=[0,0],Af=[15,15],$f={x:0,y:0,zoom:1},zf={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ds=S.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i=kf,edgeTypes:s=Mf,onNodeClick:a,onEdgeClick:c,onInit:u,onMove:l,onMoveStart:f,onMoveEnd:d,onConnect:m,onConnectStart:y,onConnectEnd:p,onClickConnectStart:E,onClickConnectEnd:g,onNodeMouseEnter:b,onNodeMouseMove:M,onNodeMouseLeave:x,onNodeContextMenu:$,onNodeDoubleClick:I,onNodeDragStart:V,onNodeDrag:O,onNodeDragStop:D,onNodesDelete:H,onEdgesDelete:P,onSelectionChange:F,onSelectionDragStart:L,onSelectionDrag:h,onSelectionDragStop:N,onSelectionContextMenu:w,onSelectionStart:z,onSelectionEnd:R,connectionMode:_=qe.Strict,connectionLineType:v=Pe.Bezier,connectionLineStyle:A,connectionLineComponent:T,connectionLineContainerStyle:B,deleteKeyCode:j="Backspace",selectionKeyCode:W="Shift",selectionOnDrag:Z=!1,selectionMode:U=bt.Full,panActivationKeyCode:q="Space",multiSelectionKeyCode:Q=Zt()?"Meta":"Control",zoomActivationKeyCode:oe=Zt()?"Meta":"Control",snapToGrid:ne=!1,snapGrid:K=Af,onlyRenderVisibleElements:ae=!1,selectNodesOnDrag:se=!0,nodesDraggable:ee,nodesConnectable:ce,nodesFocusable:J,nodeOrigin:X=Tf,edgesFocusable:ue,edgesUpdatable:be,elementsSelectable:Le,defaultViewport:Ie=$f,minZoom:Ke=.5,maxZoom:Ce=2,translateExtent:Je=Ln,preventScrolling:Ve=!0,nodeExtent:Oe,defaultMarkerColor:Qe="#b1b1b7",zoomOnScroll:et=!0,zoomOnPinch:ft=!0,panOnScroll:fe=!1,panOnScrollSpeed:ge=.5,panOnScrollMode:Fe=Ue.Free,zoomOnDoubleClick:Be=!0,panOnDrag:je=!0,onPaneClick:ke,onPaneMouseEnter:ve,onPaneMouseMove:dt,onPaneMouseLeave:sn,onPaneScroll:ht,onPaneContextMenu:an,children:tr,onEdgeContextMenu:Ye,onEdgeDoubleClick:xs,onEdgeMouseEnter:vs,onEdgeMouseMove:_s,onEdgeMouseLeave:Ss,onEdgeUpdate:Es,onEdgeUpdateStart:Ns,onEdgeUpdateEnd:bs,onReconnect:cn,onReconnectStart:ln,onReconnectEnd:un,reconnectRadius:fn=10,edgeUpdaterRadius:Cs=10,onNodesChange:ks,onEdgesChange:Ms,noDragClassName:Ts="nodrag",noWheelClassName:As="nowheel",noPanClassName:nr="nopan",fitView:$s=!1,fitViewOptions:zs,connectOnClick:Is=!0,attributionPosition:Ds,proOptions:Rs,defaultEdgeOptions:Ps,elevateNodesOnSelect:Hs=!0,elevateEdgesOnSelect:Ls=!1,disableKeyboardA11y:rr=!1,autoPanOnConnect:Vs=!0,autoPanOnNodeDrag:Os=!0,connectionRadius:Fs=20,isValidConnection:Bs,onError:js,style:Ys,id:or,nodeDragThreshold:Xs,...Ws},Us)=>{const dn=or||"1";return k.createElement("div",{...Ws,style:{...Ys,...zf},ref:Us,className:le(["react-flow",o]),"data-testid":"rf__wrapper",id:or},k.createElement(fs,null,k.createElement(bf,{onInit:u,onMove:l,onMoveStart:f,onMoveEnd:d,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:b,onNodeMouseMove:M,onNodeMouseLeave:x,onNodeContextMenu:$,onNodeDoubleClick:I,nodeTypes:i,edgeTypes:s,connectionLineType:v,connectionLineStyle:A,connectionLineComponent:T,connectionLineContainerStyle:B,selectionKeyCode:W,selectionOnDrag:Z,selectionMode:U,deleteKeyCode:j,multiSelectionKeyCode:Q,panActivationKeyCode:q,zoomActivationKeyCode:oe,onlyRenderVisibleElements:ae,selectNodesOnDrag:se,defaultViewport:Ie,translateExtent:Je,minZoom:Ke,maxZoom:Ce,preventScrolling:Ve,zoomOnScroll:et,zoomOnPinch:ft,zoomOnDoubleClick:Be,panOnScroll:fe,panOnScrollSpeed:ge,panOnScrollMode:Fe,panOnDrag:je,onPaneClick:ke,onPaneMouseEnter:ve,onPaneMouseMove:dt,onPaneMouseLeave:sn,onPaneScroll:ht,onPaneContextMenu:an,onSelectionContextMenu:w,onSelectionStart:z,onSelectionEnd:R,onEdgeContextMenu:Ye,onEdgeDoubleClick:xs,onEdgeMouseEnter:vs,onEdgeMouseMove:_s,onEdgeMouseLeave:Ss,onReconnect:cn!=null?cn:Es,onReconnectStart:ln!=null?ln:Ns,onReconnectEnd:un!=null?un:bs,reconnectRadius:fn!=null?fn:Cs,defaultMarkerColor:Qe,noDragClassName:Ts,noWheelClassName:As,noPanClassName:nr,elevateEdgesOnSelect:Ls,rfId:dn,disableKeyboardA11y:rr,nodeOrigin:X,nodeExtent:Oe}),k.createElement(_u,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:m,onConnectStart:y,onConnectEnd:p,onClickConnectStart:E,onClickConnectEnd:g,nodesDraggable:ee,nodesConnectable:ce,nodesFocusable:J,edgesFocusable:ue,edgesUpdatable:be,elementsSelectable:Le,elevateNodesOnSelect:Hs,minZoom:Ke,maxZoom:Ce,nodeExtent:Oe,onNodesChange:ks,onEdgesChange:Ms,snapToGrid:ne,snapGrid:K,connectionMode:_,translateExtent:Je,connectOnClick:Is,defaultEdgeOptions:Ps,fitView:$s,fitViewOptions:zs,onNodesDelete:H,onEdgesDelete:P,onNodeDragStart:V,onNodeDrag:O,onNodeDragStop:D,onSelectionDrag:h,onSelectionDragStart:L,onSelectionDragStop:N,noPanClassName:nr,nodeOrigin:X,rfId:dn,autoPanOnConnect:Vs,autoPanOnNodeDrag:Os,onError:js,connectionRadius:Fs,isValidConnection:Bs,nodeDragThreshold:Xs}),k.createElement(xu,{onSelectionChange:F}),tr,k.createElement(Zl,{proOptions:Rs,position:Ds}),k.createElement(Cu,{rfId:dn,disableKeyboardA11y:rr})))});ds.displayName="ReactFlow";function hs(e){return t=>{const[n,r]=S.useState(t),o=S.useCallback(i=>r(s=>e(i,s)),[]);return[n,r,o]}}const If=hs(Jo),Df=hs(Ou);function ms(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const ps=({id:e,x:t,y:n,width:r,height:o,style:i,color:s,strokeColor:a,strokeWidth:c,className:u,borderRadius:l,shapeRendering:f,onClick:d,selected:m})=>{const{background:y,backgroundColor:p}=i||{},E=s||y||p;return k.createElement("rect",{className:le(["react-flow__minimap-node",{selected:m},u]),x:t,y:n,rx:l,ry:l,width:r,height:o,fill:E,stroke:a,strokeWidth:c,shapeRendering:f,onClick:d?g=>d(g,e):void 0})};ps.displayName="MiniMapNode";var Rf=S.memo(ps);const Pf=e=>e.nodeOrigin,Hf=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),En=e=>e instanceof Function?e:()=>e;function Lf({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o=2,nodeComponent:i=Rf,onClick:s}){const a=te(Hf,ms),c=te(Pf),u=En(t),l=En(e),f=En(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return k.createElement(k.Fragment,null,a.map(m=>{const{x:y,y:p}=Ze(m,c).positionAbsolute;return k.createElement(i,{key:m.id,x:y,y:p,width:m.width,height:m.height,style:m.style,selected:m.selected,className:f(m),color:u(m),borderRadius:r,strokeColor:l(m),strokeWidth:o,shapeRendering:d,onClick:s,id:m.id})}))}var Vf=S.memo(Lf);const Of=200,Ff=150,Bf=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?Kl(on(t,e.nodeOrigin),n):n,rfId:e.rfId}},jf="react-flow__minimap-desc";function gs({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:o="",nodeBorderRadius:i=5,nodeStrokeWidth:s=2,nodeComponent:a,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:l=1,position:f="bottom-right",onClick:d,onNodeClick:m,pannable:y=!1,zoomable:p=!1,ariaLabel:E="React Flow mini map",inversePan:g=!1,zoomStep:b=10,offsetScale:M=5}){var W,Z;const x=ie(),$=S.useRef(null),{boundingRect:I,viewBB:V,rfId:O}=te(Bf,ms),D=(W=e==null?void 0:e.width)!=null?W:Of,H=(Z=e==null?void 0:e.height)!=null?Z:Ff,P=I.width/D,F=I.height/H,L=Math.max(P,F),h=L*D,N=L*H,w=M*L,z=I.x-(h-I.width)/2-w,R=I.y-(N-I.height)/2-w,_=h+w*2,v=N+w*2,A=`${jf}-${O}`,T=S.useRef(0);T.current=L,S.useEffect(()=>{if($.current){const U=me($.current),q=ne=>{const{transform:K,d3Selection:ae,d3Zoom:se}=x.getState();if(ne.sourceEvent.type!=="wheel"||!ae||!se)return;const ee=-ne.sourceEvent.deltaY*(ne.sourceEvent.deltaMode===1?.05:ne.sourceEvent.deltaMode?1:.002)*b,ce=K[2]*Math.pow(2,ee);se.scaleTo(ae,ce)},Q=ne=>{const{transform:K,d3Selection:ae,d3Zoom:se,translateExtent:ee,width:ce,height:J}=x.getState();if(ne.sourceEvent.type!=="mousemove"||!ae||!se)return;const X=T.current*Math.max(1,K[2])*(g?-1:1),ue={x:K[0]-ne.sourceEvent.movementX*X,y:K[1]-ne.sourceEvent.movementY*X},be=[[0,0],[ce,J]],Le=Ae.translate(ue.x,ue.y).scale(K[2]),Ie=se.constrain()(Le,be,ee);se.transform(ae,Ie)},oe=xo().on("zoom",y?Q:null).on("zoom.wheel",p?q:null);return U.call(oe),()=>{U.on("zoom",null)}}},[y,p,g,b]);const B=d?U=>{const q=ye(U);d(U,{x:q[0],y:q[1]})}:void 0,j=m?(U,q)=>{const Q=x.getState().nodeInternals.get(q);m(U,Q)}:void 0;return k.createElement(Yn,{position:f,style:e,className:le(["react-flow__minimap",t]),"data-testid":"rf__minimap"},k.createElement("svg",{width:D,height:H,viewBox:`${z} ${R} ${_} ${v}`,role:"img","aria-labelledby":A,ref:$,onClick:B},E&&k.createElement("title",{id:A},E),k.createElement(Vf,{onClick:j,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:o,nodeStrokeWidth:s,nodeComponent:a}),k.createElement("path",{className:"react-flow__minimap-mask",d:`M${z-w},${R-w}h${_+w*2}v${v+w*2}h${-_-w*2}z
        M${V.x},${V.y}h${V.width}v${V.height}h${-V.width}z`,fill:c,fillRule:"evenodd",stroke:u,strokeWidth:l,pointerEvents:"none"})))}gs.displayName="MiniMap";var Yf=S.memo(gs);function Xf(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}function Wf(){return k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},k.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Uf(){return k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},k.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Zf(){return k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},k.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Gf(){return k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},k.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function qf(){return k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},k.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const _t=({children:e,className:t,...n})=>k.createElement("button",{type:"button",className:le(["react-flow__controls-button",t]),...n},e);_t.displayName="ControlButton";const Kf=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),ys=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:c,className:u,children:l,position:f="bottom-left"})=>{const d=ie(),[m,y]=S.useState(!1),{isInteractive:p,minZoomReached:E,maxZoomReached:g}=te(Kf,Xf),{zoomIn:b,zoomOut:M,fitView:x}=Qn();if(S.useEffect(()=>{y(!0)},[]),!m)return null;const $=()=>{b(),i==null||i()},I=()=>{M(),s==null||s()},V=()=>{x(o),a==null||a()},O=()=>{d.setState({nodesDraggable:!p,nodesConnectable:!p,elementsSelectable:!p}),c==null||c(!p)};return k.createElement(Yn,{className:le(["react-flow__controls",u]),position:f,style:e,"data-testid":"rf__controls"},t&&k.createElement(k.Fragment,null,k.createElement(_t,{onClick:$,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:g},k.createElement(Wf,null)),k.createElement(_t,{onClick:I,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:E},k.createElement(Uf,null))),n&&k.createElement(_t,{className:"react-flow__controls-fitview",onClick:V,title:"fit view","aria-label":"fit view"},k.createElement(Zf,null)),r&&k.createElement(_t,{className:"react-flow__controls-interactive",onClick:O,title:"toggle interactivity","aria-label":"toggle interactivity"},p?k.createElement(qf,null):k.createElement(Gf,null)),l)};ys.displayName="Controls";var Jf=S.memo(ys);function Qf(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var we;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(we||(we={}));function ed({color:e,dimensions:t,lineWidth:n}){return k.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function td({color:e,radius:t}){return k.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const nd={[we.Dots]:"#91919a",[we.Lines]:"#eee",[we.Cross]:"#e2e2e2"},rd={[we.Dots]:1,[we.Lines]:1,[we.Cross]:6},od=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function ws({id:e,variant:t=we.Dots,gap:n=20,size:r,lineWidth:o=1,offset:i=2,color:s,style:a,className:c}){const u=S.useRef(null),{transform:l,patternId:f}=te(od,Qf),d=s||nd[t],m=r||rd[t],y=t===we.Dots,p=t===we.Cross,E=Array.isArray(n)?n:[n,n],g=[E[0]*l[2]||1,E[1]*l[2]||1],b=m*l[2],M=p?[b,b]:g,x=y?[b/i,b/i]:[M[0]/i,M[1]/i];return k.createElement("svg",{className:le(["react-flow__background",c]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},k.createElement("pattern",{id:f+e,x:l[0]%g[0],y:l[1]%g[1],width:g[0],height:g[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${x[0]},-${x[1]})`},y?k.createElement(td,{color:d,radius:b/i}):k.createElement(ed,{dimensions:M,color:d,lineWidth:o})),k.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${f+e})`}))}ws.displayName="Background";var sd=S.memo(ws);const id=({data:e})=>{const t=n=>{switch(n){case"running":return"bg-blue-500";case"success":return"bg-green-500";case"error":return"bg-red-500";default:return"bg-gray-500"}};return C.jsxs("div",{className:"bg-card border-2 border-border rounded-lg p-4 min-w-[200px] shadow-lg relative",children:[C.jsx(Ee,{type:"target",position:Y.Left}),C.jsxs("div",{className:"flex items-center justify-between mb-2",children:[C.jsx("div",{className:`w-3 h-3 rounded-full ${t(e.status)}`}),C.jsxs(Nn,{variant:"secondary",className:"text-xs",children:[e.performance.successRate,"%"]})]}),C.jsx("h3",{className:"font-semibold text-sm mb-1",children:e.agentName}),C.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:e.agentId}),C.jsxs("div",{className:"text-xs space-y-1",children:[C.jsxs("div",{className:"flex justify-between",children:[C.jsx("span",{children:"Response:"}),C.jsxs("span",{children:[e.performance.avgResponseTime,"ms"]})]}),C.jsxs("div",{className:"flex justify-between",children:[C.jsx("span",{children:"Status:"}),C.jsx("span",{className:"capitalize",children:e.status})]})]}),C.jsx(Ee,{type:"source",position:Y.Right})]})},ad=({data:e})=>C.jsxs("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-lg p-4 min-w-[150px] relative",children:[C.jsx(Ee,{type:"target",position:Y.Left}),C.jsxs("div",{className:"text-center",children:[C.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-full mx-auto mb-2 flex items-center justify-center",children:C.jsx("span",{className:"text-white text-xs",children:"?"})}),C.jsx("h3",{className:"font-semibold text-sm",children:"Condition"}),C.jsx("p",{className:"text-xs text-gray-600",children:e.condition||"If/Then/Else"})]}),C.jsx(Ee,{type:"source",position:Y.Right,id:"true",style:{top:"30%"}}),C.jsx(Ee,{type:"source",position:Y.Right,id:"false",style:{top:"70%"}})]}),cd=({data:e})=>C.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg p-4 min-w-[150px] relative",children:[C.jsxs("div",{className:"text-center",children:[C.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full mx-auto mb-2 flex items-center justify-center",children:C.jsx(Xr,{className:"w-4 h-4 text-white"})}),C.jsx("h3",{className:"font-semibold text-sm",children:"Trigger"}),C.jsx("p",{className:"text-xs text-gray-600",children:e.trigger||"Workflow Start"})]}),C.jsx(Ee,{type:"source",position:Y.Right})]}),ld={agent:id,conditional:ad,trigger:cd},ud=[{id:"1",type:"trigger",position:{x:100,y:100},data:{trigger:"User Request"}}],fd=[],_d=({agents:e,onSaveWorkflow:t,onExecuteWorkflow:n})=>{const[r,o,i]=If(ud),[s,a,c]=Df(fd),[u,l]=S.useState([]),[f,d]=S.useState(""),[m,y]=S.useState("all"),[p,E]=S.useState(""),[g,b]=S.useState(!0),[M,x]=S.useState(""),[$,I]=S.useState(""),[V,O]=S.useState(!1),[D,H]=S.useState(!1);S.useEffect(()=>{P()},[]);const P=async()=>{try{H(!0);const{data:v,error:A}=await hn.from("orchestration_workflows").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(A)throw A;l(v||[])}catch(v){console.error("Failed to load workflow templates:",v),_e.error("Failed to load workflow templates"),l([{id:"1",workflow_name:"Customer Onboarding",description:"Complete customer onboarding process",trigger_conditions:{},agent_sequence:{nodes:[{id:"1",type:"trigger",position:{x:100,y:100},data:{trigger:"New Customer"}},{id:"2",type:"agent",position:{x:300,y:100},data:{agentName:"Welcome Agent",agentId:"welcome-agent",status:"idle",performance:{successRate:95,avgResponseTime:150}}}],edges:[{id:"e1-2",source:"1",target:"2"}]},workflow_config:{},is_active:!0,execution_count:0,success_rate:0,created_by:"",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}])}finally{H(!1)}},F=S.useCallback(v=>a(A=>$o(v,A)),[a]),L=v=>{const A={id:`agent-${Date.now()}`,type:"agent",position:{x:Math.random()*300+100,y:Math.random()*200+200},data:{agentId:v.agent_id,agentName:v.display_name,status:"idle",config:v.configuration,performance:{successRate:Math.round(Math.random()*20+80),avgResponseTime:Math.round(Math.random()*200+100)}}};o(T=>[...T,A])},h=()=>{const v={id:`conditional-${Date.now()}`,type:"conditional",position:{x:Math.random()*300+100,y:Math.random()*200+300},data:{condition:"New Condition"}};o(A=>[...A,v])},N=v=>{const A=u.find(T=>T.id===v);if(A)try{const T=A.workflow_config||A.agent_sequence;T&&T.nodes?(o([]),a([]),setTimeout(()=>{o(T.nodes||[]),a(T.edges||[])},100),d(v),x(A.workflow_name),I(A.description),_e.success(`Template "${A.workflow_name}" loaded. You can now edit and save changes.`)):_e.error("Template data is invalid or missing")}catch(T){console.error("Error loading template:",T),_e.error("Failed to load template")}},w=async()=>{if(!M.trim()){_e.error("Please enter a workflow name");return}try{const A={nodes:r.map(T=>({...T,position:{x:T.position.x,y:T.position.y},selected:void 0,dragging:void 0})),edges:s};if(f){const{error:T}=await hn.from("orchestration_workflows").update({workflow_name:M,description:$,workflow_config:JSON.parse(JSON.stringify(A)),updated_at:new Date().toISOString()}).eq("id",f);if(T)throw T;_e.success("Template updated successfully")}else{const{error:T}=await hn.from("orchestration_workflows").insert({workflow_name:M,description:$,workflow_config:JSON.parse(JSON.stringify(A)),agent_sequence:{},trigger_conditions:{}});if(T)throw T;_e.success("Workflow saved as new template")}P(),O(!1),d("")}catch(v){console.error("Failed to save template:",v),_e.error("Failed to save template")}},z=()=>{if(!M.trim()){O(!0);return}const v={nodes:r,edges:s,name:M,description:$,created:new Date().toISOString()};t(v),_e.success("Workflow saved successfully")},R=()=>{n({nodes:r,edges:s}),_e.success("Workflow execution started")},_=u.filter(v=>v.workflow_name.toLowerCase().includes(p.toLowerCase())||v.description.toLowerCase().includes(p.toLowerCase()));return C.jsx("div",{className:"space-y-6",children:C.jsxs(di,{defaultValue:"builder",className:"space-y-4",children:[C.jsxs(hi,{children:[C.jsx(mn,{value:"builder",children:"Workflow Builder"}),C.jsx(mn,{value:"templates",children:"Template Library"}),C.jsx(mn,{value:"analytics",children:"Analytics"})]}),C.jsx(pn,{value:"builder",className:"space-y-4",children:C.jsxs("div",{className:"grid grid-cols-4 gap-6 h-[800px]",children:[C.jsx("div",{className:"col-span-3",children:C.jsxs(Tt,{className:"h-full",children:[C.jsxs(At,{className:"flex flex-row items-center justify-between",children:[C.jsx($t,{children:"Workflow Builder"}),C.jsxs("div",{className:"flex gap-2",children:[C.jsxs(oi,{open:V,onOpenChange:O,children:[C.jsx(si,{asChild:!0,children:C.jsxs(Se,{variant:"outline",size:"sm",children:[C.jsx(gi,{className:"w-4 h-4 mr-2"}),"Save"]})}),C.jsxs(ii,{children:[C.jsxs(ai,{children:[C.jsx(ci,{children:f?"Update Template":"Save Workflow"}),C.jsx(li,{children:f?"Update the existing template with your changes.":"Save your workflow for future use or as a template."})]}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx(cr,{htmlFor:"name",children:"Workflow Name"}),C.jsx(sr,{id:"name",value:M,onChange:v=>x(v.target.value),placeholder:"Enter workflow name"})]}),C.jsxs("div",{children:[C.jsx(cr,{htmlFor:"description",children:"Description"}),C.jsx(fi,{id:"description",value:$,onChange:v=>I(v.target.value),placeholder:"Describe your workflow"})]})]}),C.jsxs(ui,{children:[C.jsx(Se,{onClick:z,variant:"outline",children:"Save Workflow"}),C.jsx(Se,{onClick:w,children:f?"Update Template":"Save as Template"}),f&&C.jsx(Se,{variant:"outline",onClick:()=>{d(""),x(""),I(""),O(!1)},children:"Save as New"})]})]})]}),C.jsxs(Se,{size:"sm",onClick:R,children:[C.jsx(Xr,{className:"w-4 h-4 mr-2"}),"Execute"]})]})]}),C.jsx(zt,{className:"p-0 h-full",children:C.jsx("div",{className:"h-[700px]",children:C.jsxs(ds,{nodes:r,edges:s,onNodesChange:i,onEdgesChange:c,onConnect:F,nodeTypes:ld,fitView:!0,className:"bg-background",children:[C.jsx(sd,{}),C.jsx(Jf,{}),C.jsx(Yf,{})]})})})]})}),C.jsx("div",{className:"col-span-1 space-y-4",children:C.jsx(Tt,{children:C.jsxs(ti,{open:g,onOpenChange:b,children:[C.jsx(At,{className:"pb-2",children:C.jsx(ni,{asChild:!0,children:C.jsxs(Se,{variant:"ghost",className:"w-full justify-between p-0 h-auto",children:[C.jsx($t,{className:"text-sm",children:"Available Agents"}),g?C.jsx(Ks,{className:"h-4 w-4"}):C.jsx(Js,{className:"h-4 w-4"})]})})}),C.jsx(ri,{children:C.jsxs(zt,{className:"space-y-2 pt-0",children:[e.map(v=>C.jsx(Se,{variant:"ghost",size:"sm",className:"w-full justify-start h-auto p-3",onClick:()=>L(v),children:C.jsxs("div",{className:"text-left",children:[C.jsx("div",{className:"font-medium text-xs",children:v.display_name}),C.jsx("div",{className:"text-xs text-muted-foreground",children:v.category})]})},v.agent_id)),C.jsx(ei,{className:"my-3"}),C.jsxs(Se,{variant:"outline",size:"sm",className:"w-full",onClick:h,children:[C.jsx(Qs,{className:"w-4 h-4 mr-2"}),"Add Condition"]})]})})]})})})]})}),C.jsxs(pn,{value:"templates",className:"space-y-4",children:[C.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[C.jsx("div",{className:"flex-1",children:C.jsxs("div",{className:"relative",children:[C.jsx(pi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),C.jsx(sr,{placeholder:"Search templates...",value:p,onChange:v=>E(v.target.value),className:"pl-10"})]})}),C.jsx(Se,{onClick:()=>o([]),variant:"outline",size:"sm",children:"Clear Canvas"}),C.jsxs(Se,{onClick:P,variant:"outline",size:"sm",children:[C.jsx(ir,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),D?C.jsxs("div",{className:"flex items-center justify-center py-8",children:[C.jsx(ir,{className:"h-6 w-6 animate-spin mr-2"}),C.jsx("span",{children:"Loading templates..."})]}):C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[_.map(v=>{var A,T,B,j;return C.jsxs(Tt,{className:`cursor-pointer transition-all hover:shadow-md ${f===v.id?"ring-2 ring-primary":""}`,onClick:()=>N(v.id),children:[C.jsxs(At,{children:[C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx($t,{className:"text-lg",children:v.workflow_name}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsxs(Nn,{variant:"secondary",children:[v.success_rate,"% Success"]}),f===v.id&&C.jsx(Nn,{variant:"default",className:"bg-primary",children:"Loaded"})]})]}),C.jsx(ar,{children:v.description})]}),C.jsxs(zt,{children:[C.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[C.jsxs("span",{children:[((T=(A=v.workflow_config)==null?void 0:A.nodes)==null?void 0:T.length)||((j=(B=v.agent_sequence)==null?void 0:B.nodes)==null?void 0:j.length)||0," nodes"]}),C.jsxs("span",{children:[v.execution_count," executions"]})]}),C.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["Created: ",new Date(v.created_at).toLocaleDateString()]}),f===v.id&&C.jsx("div",{className:"mt-3 text-xs text-primary font-medium",children:" Template loaded in builder - Make changes and save to update"})]})]},v.id)}),_.length===0&&C.jsx("div",{className:"col-span-full text-center py-8 text-muted-foreground",children:p?"No templates match your search":"No templates available"})]})]}),C.jsx(pn,{value:"analytics",className:"space-y-4",children:C.jsxs(Tt,{children:[C.jsxs(At,{children:[C.jsx($t,{children:"Workflow Analytics"}),C.jsx(ar,{children:"Performance metrics and insights for your agent workflows"})]}),C.jsx(zt,{children:C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[C.jsxs("div",{className:"p-4 border rounded-lg",children:[C.jsx("h4",{className:"font-semibold",children:"Total Workflows"}),C.jsx("p",{className:"text-2xl font-bold",children:u.length})]}),C.jsxs("div",{className:"p-4 border rounded-lg",children:[C.jsx("h4",{className:"font-semibold",children:"Active Templates"}),C.jsx("p",{className:"text-2xl font-bold",children:u.filter(v=>v.is_active).length})]}),C.jsxs("div",{className:"p-4 border rounded-lg",children:[C.jsx("h4",{className:"font-semibold",children:"Total Executions"}),C.jsx("p",{className:"text-2xl font-bold",children:u.reduce((v,A)=>v+A.execution_count,0)})]})]})})]})})]})})};export{_d as A};
