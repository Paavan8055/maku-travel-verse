import{r as p,h as U,s as l,j as e,a as f,d as v,e as N,b as y,B as h,f as w,u as V}from"./index-7HSUJgza-1759930941462.js";import{T as Y,a as I,b as A,c as P}from"./tabs-DHMIZsaK-1759930941462.js";import{N as H}from"./Navbar-o8_N-Duy-1759930941462.js";import{I as c}from"./input-B0BzcVH8-1759930941462.js";import{L as o}from"./label-BAuCWBD6-1759930941462.js";import{S as _,a as S,b as k,c as T,d}from"./select-BH1o79_M-1759930941462.js";import{S as R}from"./switch-Cm6lzc5X-1759930941462.js";import{B as u}from"./bell-CYjwSQrf-1759930941462.js";import{P as q}from"./plus-DLNEUELO-1759930941462.js";import{T as O}from"./trash-2-DWVSfY0s-1759930941462.js";import{T as G}from"./trending-down-uRTXsD9j-1759930941462.js";import{T as J}from"./trending-up-hDmOjmJw-1759930941462.js";import{C as K}from"./chevron-left-CK1xkntt-1759930941462.js";import{U as D}from"./user-rxp6EPp9-1759930941462.js";import"./useApiHealth-D7dXMEnM-1759930941462.js";import"./avatar-CAn_Sof--1759930941462.js";import"./index-CVZIOD8e-1759930941462.js";import"./globe-TPfiTbfc-1759930941462.js";import"./useHealthMonitor-yZrw-rWv-1759930941462.js";import"./useAIIntelligence-BAX8jRs9-1759930941462.js";import"./plane-CcAjdWCA-1759930941462.js";import"./map-pin-DWB_nDS6-1759930941462.js";import"./sparkles-txvMzh8g-1759930941462.js";import"./chevron-down-F990gvlW-1759930941462.js";import"./brain-DM9TtRFK-1759930941462.js";import"./calendar-DZe91egs-1759930941462.js";import"./zap-CHSdTv2p-1759930941462.js";import"./menu-B6RjQ9Ul-1759930941462.js";import"./users-Bzlfk3AE-1759930941462.js";import"./settings-hfDWc7pn-1759930941462.js";import"./shield-_-CGtLvW-1759930941462.js";import"./index-BdQq_4o_-1759930941462.js";import"./index-DMwMdLt4-1759930941462.js";const Q=()=>{const[m,F]=p.useState([]),[$,b]=p.useState(!0),[E,g]=p.useState(!1),[t,n]=p.useState({type:"hotel",destination:"",origin:"",startDate:"",endDate:"",passengers:2,rooms:1,targetPrice:0,threshold:10,notificationMethod:"email"}),{toast:i}=U();p.useEffect(()=>{j()},[]);const j=async()=>{try{b(!0);const{data:{session:s}}=await l.auth.getSession();if(!s){i({title:"Authentication Required",description:"Please log in to manage price alerts",variant:"destructive"});return}const{data:r,error:a}=await l.functions.invoke("price-alert-manager",{body:{action:"get_alerts"},headers:{Authorization:`Bearer ${s.access_token}`}});a?(console.error("Failed to load alerts:",a),i({title:"Error",description:"Failed to load your price alerts",variant:"destructive"})):F(r.alerts||[])}catch(s){console.error("Price alert loading error:",s),i({title:"Error",description:"An unexpected error occurred",variant:"destructive"})}finally{b(!1)}},B=async()=>{try{const{data:{session:s}}=await l.auth.getSession();if(!s)return;const r={search_criteria:{type:t.type,destination:t.destination,origin:t.origin||void 0,dates:{start:t.startDate,end:t.endDate||void 0},passengers:t.passengers,rooms:t.rooms},target_price:t.targetPrice,current_price:t.targetPrice,threshold_percentage:t.threshold,notification_method:t.notificationMethod},{data:a,error:x}=await l.functions.invoke("price-alert-manager",{body:{action:"create_alert",...r},headers:{Authorization:`Bearer ${s.access_token}`}});x?(console.error("Failed to create alert:",x),i({title:"Error",description:"Failed to create price alert",variant:"destructive"})):(i({title:"Alert Created",description:"Your price alert has been set up successfully"}),g(!1),j(),C())}catch(s){console.error("Alert creation error:",s),i({title:"Error",description:"An unexpected error occurred",variant:"destructive"})}},M=async(s,r)=>{try{const{data:{session:a}}=await l.auth.getSession();if(!a)return;const{error:x}=await l.functions.invoke("price-alert-manager",{body:{action:"update_alert",alert_id:s,updates:{is_active:r}},headers:{Authorization:`Bearer ${a.access_token}`}});x?(console.error("Failed to update alert:",x),i({title:"Error",description:"Failed to update alert status",variant:"destructive"})):(i({title:r?"Alert Activated":"Alert Paused",description:`Price monitoring has been ${r?"enabled":"disabled"}`}),j())}catch(a){console.error("Alert toggle error:",a)}},L=async s=>{try{const{data:{session:r}}=await l.auth.getSession();if(!r)return;const{error:a}=await l.functions.invoke("price-alert-manager",{body:{action:"delete_alert",alert_id:s},headers:{Authorization:`Bearer ${r.access_token}`}});a?(console.error("Failed to delete alert:",a),i({title:"Error",description:"Failed to delete price alert",variant:"destructive"})):(i({title:"Alert Deleted",description:"Price alert has been removed"}),j())}catch(r){console.error("Alert deletion error:",r)}},C=()=>{n({type:"hotel",destination:"",origin:"",startDate:"",endDate:"",passengers:2,rooms:1,targetPrice:0,threshold:10,notificationMethod:"email"})},z=s=>{const r=[];return s.origin&&r.push(`${s.origin} →`),r.push(s.destination),s.dates.end?r.push(`${s.dates.start} to ${s.dates.end}`):r.push(s.dates.start),s.passengers&&r.push(`${s.passengers} passengers`),s.rooms&&r.push(`${s.rooms} rooms`),r.join(" • ")};return $?e.jsxs(f,{children:[e.jsx(v,{children:e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),"Price Alerts"]})}),e.jsx(y,{children:e.jsx("div",{className:"animate-pulse space-y-4",children:[...Array(3)].map((s,r)=>e.jsx("div",{className:"h-20 bg-muted rounded-lg"},r))})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(f,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),"Price Alerts (",m.length,")"]}),e.jsxs(h,{onClick:()=>g(!0),size:"sm",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Create Alert"]})]})}),e.jsx(y,{children:m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(u,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Price Alerts"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Set up alerts to get notified when prices drop for your searches"}),e.jsx(h,{onClick:()=>g(!0),children:"Create Your First Alert"})]}):e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(w,{variant:"outline",className:"capitalize",children:s.search_criteria.type}),e.jsx(w,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Paused"})]}),e.jsx("p",{className:"text-sm font-medium",children:z(s.search_criteria)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{checked:s.is_active,onCheckedChange:r=>M(s.id,r)}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>L(s.id),children:e.jsx(O,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:["Target: $",s.target_price]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{children:["Current: $",s.current_price]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-4 w-4 text-yellow-600"}),e.jsxs("span",{children:["±",s.threshold_percentage,"% threshold"]})]})]}),s.last_checked&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Last checked: ",new Date(s.last_checked).toLocaleString()]})]},s.id))})})]}),E&&e.jsxs(f,{children:[e.jsx(v,{children:e.jsx(N,{children:"Create New Price Alert"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Travel Type"}),e.jsxs(_,{value:t.type,onValueChange:s=>n({...t,type:s}),children:[e.jsx(S,{children:e.jsx(k,{})}),e.jsxs(T,{children:[e.jsx(d,{value:"hotel",children:"Hotel"}),e.jsx(d,{value:"flight",children:"Flight"}),e.jsx(d,{value:"activity",children:"Activity"})]})]})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Destination"}),e.jsx(c,{placeholder:"e.g., Sydney, Melbourne, Paris",value:t.destination,onChange:s=>n({...t,destination:s.target.value})})]}),t.type==="flight"&&e.jsxs("div",{children:[e.jsx(o,{children:"Origin"}),e.jsx(c,{placeholder:"e.g., SYD, MEL, NYC",value:t.origin,onChange:s=>n({...t,origin:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Start Date"}),e.jsx(c,{type:"date",value:t.startDate,onChange:s=>n({...t,startDate:s.target.value})})]}),(t.type==="hotel"||t.type==="activity")&&e.jsxs("div",{children:[e.jsx(o,{children:"End Date"}),e.jsx(c,{type:"date",value:t.endDate,onChange:s=>n({...t,endDate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Target Price ($)"}),e.jsx(c,{type:"number",placeholder:"200",value:t.targetPrice||"",onChange:s=>n({...t,targetPrice:Number(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Alert Threshold (%)"}),e.jsx(c,{type:"number",placeholder:"10",value:t.threshold,onChange:s=>n({...t,threshold:Number(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Notification Method"}),e.jsxs(_,{value:t.notificationMethod,onValueChange:s=>n({...t,notificationMethod:s}),children:[e.jsx(S,{children:e.jsx(k,{})}),e.jsxs(T,{children:[e.jsx(d,{value:"email",children:"Email"}),e.jsx(d,{value:"push",children:"Push Notification"}),e.jsx(d,{value:"both",children:"Both"})]})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(h,{onClick:B,disabled:!t.destination||!t.targetPrice,children:"Create Alert"}),e.jsx(h,{variant:"outline",onClick:()=>{g(!1),C()},children:"Cancel"})]})]})]})]})},Te=()=>{const m=V();return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(H,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8 pt-24",children:[e.jsxs(h,{variant:"ghost",onClick:()=>m(-1),className:"mb-4",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("h1",{className:"text-3xl font-bold mb-8 flex items-center",children:[e.jsx(D,{className:"h-8 w-8 mr-3"}),"Profile"]}),e.jsxs(Y,{defaultValue:"alerts",className:"w-full",children:[e.jsxs(I,{className:"grid w-full grid-cols-2",children:[e.jsxs(A,{value:"alerts",className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-4 w-4"}),"Price Alerts"]}),e.jsxs(A,{value:"profile",className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"Profile Settings"]})]}),e.jsx(P,{value:"alerts",className:"mt-6",children:e.jsx(Q,{})}),e.jsx(P,{value:"profile",className:"mt-6",children:e.jsxs(f,{children:[e.jsx(v,{children:e.jsx(N,{children:"Profile Settings"})}),e.jsx(y,{children:e.jsx("p",{className:"text-muted-foreground",children:"Profile settings coming soon..."})})]})})]})]})]})};export{Te as default};
