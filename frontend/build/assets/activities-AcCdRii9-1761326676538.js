import{b as D,r as l,j as e,d as y,a as S,e as w,B as R,s as T,w as I,l as U,k as V,f as M,g as W}from"./index-DqGZ8t5e-1761326676538.js";import{S as j,a as v,b as N,c as b,d as i}from"./select-CF8MFyKO-1761326676538.js";import{S as q}from"./slider-CG2g7z67-1761326676538.js";import{C as K}from"./checkbox-f7g6EnJr-1761326676538.js";import{N as _}from"./Navbar-Cz4na1se-1761326676538.js";import{S as J}from"./star-BgZU3NAt-1761326676538.js";import{C as Q}from"./clock-Dpnm4X4o-1761326676538.js";import{M as X}from"./map-pin-qlXifRZs-1761326676538.js";import{U as Y}from"./users-Cryeq6Pw-1761326676538.js";import{P as Z}from"./PerformanceWrapper-eOV0bu1r-1761326676538.js";import{A as ee}from"./ActivitySearchBar-CXORZYv0-1761326676538.js";import{F as se}from"./filter-DLn3ta7Y-1761326676538.js";import{A as re}from"./arrow-up-narrow-wide-DeY1HEut-1761326676538.js";import"./index-BdQq_4o_-1761326676538.js";import"./index-CokBKAwC-1761326676538.js";import"./chevron-down-BFL4Uggs-1761326676538.js";import"./useApiHealth-Db_IXXK1-1761326676538.js";import"./avatar-UC1OGz2U-1761326676538.js";import"./index-DDmUqv8O-1761326676538.js";import"./globe-BxyFWwoN-1761326676538.js";import"./useHealthMonitor-FMCjsxDd-1761326676538.js";import"./useAIIntelligence-C7VN-tIR-1761326676538.js";import"./plane-BCnagIHK-1761326676538.js";import"./sparkles-vuoP1AWK-1761326676538.js";import"./brain-CtjJaEAD-1761326676538.js";import"./calendar-CL2YOCTx-1761326676538.js";import"./zap-DEjmRDpY-1761326676538.js";import"./settings-WM63zvrn-1761326676538.js";import"./shield-CC5acBqH-1761326676538.js";import"./user-BTI-sRzz-1761326676538.js";import"./input-D8JvpvT5-1761326676538.js";import"./usePerformanceOptimizer-DdHZ1vZC-1761326676538.js";import"./calendar-BEDTqozt-1761326676538.js";import"./en-US-CC7XSppg-1761326676538.js";import"./format-Bz5h0pkl-1761326676538.js";import"./endOfMonth-DHCiCas1-1761326676538.js";import"./chevron-left-B0CWu6Nq-1761326676538.js";import"./minus-IQfh0MjG-1761326676538.js";import"./plus-BAwQwn_Z-1761326676538.js";import"./search-BMXgCoIw-1761326676538.js";const te=({activity:s})=>{const h=D(),[d,x]=l.useState(!1),c=()=>{const n=new URLSearchParams({activityId:s.id,title:s.title,price:s.price.toString(),currency:s.currency,duration:s.duration,location:s.location,category:s.category,difficulty:s.difficulty});h(`/booking/activity?${n.toString()}`)},p=n=>{switch(n.toLowerCase()){case"easy":return"bg-green-100 text-green-800";case"moderate":return"bg-yellow-100 text-yellow-800";case"challenging":return"bg-red-100 text-red-800";default:return"bg-white text-gray-800"}},t=n=>{switch(n.toLowerCase()){case"adventure":return"bg-orange-100 text-orange-800";case"cultural":return"bg-purple-100 text-purple-800";case"food & drink":return"bg-pink-100 text-pink-800";case"nature":return"bg-green-100 text-green-800";case"sightseeing":return"bg-blue-100 text-blue-800";case"water sports":return"bg-cyan-100 text-cyan-800";default:return"bg-white text-gray-800"}};return e.jsxs(y,{className:"hover:shadow-md transition-shadow h-full",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:d?"/placeholder.svg":s.images[0]||"/placeholder.svg",alt:s.title,className:"w-full h-48 object-cover rounded-t-lg",onError:()=>x(!0)}),e.jsxs("div",{className:"absolute top-3 left-3 flex space-x-2",children:[e.jsx(S,{className:t(s.category),children:s.category}),e.jsx(S,{className:p(s.difficulty),children:s.difficulty})]}),s.instantConfirmation&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx(S,{className:"bg-green-500 text-white",children:"✓ Instant Confirmation"})})]}),e.jsxs(w,{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2 line-clamp-2",children:s.title}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"font-medium text-foreground",children:s.rating>0?s.rating.toFixed(1):"Not rated"}),e.jsx("span",{children:s.reviewCount>0?`(${s.reviewCount})`:"(No reviews)"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{children:s.duration||"Duration not specified"})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 mb-3",children:[e.jsx(X,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.location})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-3",children:s.description}),s.highlights.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-1",children:"Highlights:"}),e.jsx("ul",{className:"text-sm text-muted-foreground space-y-1",children:s.highlights.slice(0,2).map((n,a)=>e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"text-primary mt-1",children:"•"}),e.jsx("span",{className:"line-clamp-1",children:n})]},a))})]}),e.jsxs("div",{className:"flex items-center space-x-1 mb-3 text-sm text-muted-foreground",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.groupSize.min,"-",s.groupSize.max," participants"]})]}),e.jsx(S,{variant:"outline",className:"text-xs mb-3",children:s.cancellationPolicy})]}),e.jsx("div",{className:"border-t pt-4 mt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"From"}),e.jsx("p",{className:"text-xl font-bold text-foreground",children:s.price>0?`${s.currency}${s.price}`:"Price on request"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"per person"})]}),e.jsx(R,{onClick:c,disabled:s.price<=0,children:s.price>0?"Choose Activity":"Contact for Price"})]})})]})]})},ae=s=>{const[h,d]=l.useState([]),[x,c]=l.useState(!1),[p,t]=l.useState(null);return l.useEffect(()=>{if(!s.destination){d([]),t("Please select a destination to search for activities");return}(async()=>{c(!0),t(null);try{const{data:a,error:u}=await T.functions.invoke("provider-rotation",{body:{searchType:"activity",params:{destination:s.destination,date:s.date,participants:s.participants}}});if(u)throw u;if(a!=null&&a.success){const o=(a==null?void 0:a.data)||(a==null?void 0:a.activities)||[];a.fallbackUsed&&I.info("Showing sample activities while we restore full service."),Array.isArray(o)&&o.length>0?(console.log("Activity search success:",o.length,"activities found"),d(o)):(console.log("Activity search returned no data"),d([]),t("No activities found for your search criteria. Please try a different destination or check back later."))}else console.log("Activity search failed"),d([]),t((a==null?void 0:a.error)||"No activities found for your search criteria. Please try a different destination or check back later.")}catch(a){U.error("Activity search error:",a);const u=a instanceof Error?a.message:"Failed to search activities";t(`Provider API Error: ${u}. Please try a different destination or check our service status.`),I.error("Activity search temporarily unavailable. Please try again in a few minutes."),d([])}finally{c(!1)}})()},[s.destination,s.date,s.participants]),{activities:h,loading:x,error:p}},We=()=>{const[s]=V(),h=D(),[d,x]=l.useState("price"),[c,p]=l.useState([0,300]),[t,n]=l.useState({category:[],duration:"any",difficulty:"any",ageGroup:"any",groupSize:"any",accessibility:[]}),[a,u]=l.useState(s.get("destination")||""),[o,F]=l.useState(()=>{const r=s.get("checkIn");return r?new Date(r):new Date}),[C,E]=l.useState(()=>{const r=s.get("checkOut");return r?new Date(r):new Date}),[g,$]=l.useState(parseInt(s.get("adults")||"2")),[f,G]=l.useState(parseInt(s.get("children")||"0")),O={destination:a||"",date:o.toISOString().split("T")[0],participants:g+f},{activities:z,loading:P,error:k}=ae(O),A=z.filter(r=>!(c[0]>0&&r.price<c[0]||c[1]<300&&r.price>c[1]||t.category.length>0&&!t.category.includes(r.category)||t.duration!=="any"&&r.duration!==t.duration||t.difficulty!=="any"&&r.difficulty!==t.difficulty||t.ageGroup!=="any"&&r.ageGroup!==t.ageGroup)).sort((r,m)=>{switch(d){case"price":return r.price-m.price;case"rating":return m.rating-r.rating;case"duration":return r.durationHours-m.durationHours;default:return 0}}),B=(r,m)=>{n(m?{...t,category:[...t.category,r]}:{...t,category:t.category.filter(L=>L!==r)})},H=()=>{const r=new URLSearchParams;a&&r.set("destination",a),o&&r.set("checkIn",o.toISOString().split("T")[0]),C&&r.set("checkOut",C.toISOString().split("T")[0]),g>0&&r.set("adults",g.toString()),f>0&&r.set("children",f.toString()),h(`/search/activities?${r.toString()}`)};return e.jsx(Z,{componentName:"ActivitySearchPage",children:e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(_,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx(ee,{destination:a,setDestination:u,checkIn:o,setCheckIn:F,checkOut:C,setCheckOut:E,adults:g,setAdults:$,children:f,setChildren:G,onSearch:H})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold text-foreground mb-2",children:["Activities in ",a||"your destination"]}),e.jsxs("p",{className:"text-muted-foreground",children:[o&&`${o.toLocaleDateString()} • `,g+f," participant(s)"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(y,{children:[e.jsx(M,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5"}),"Filters"]})}),e.jsxs(w,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Price Range"}),e.jsx(q,{value:c,onValueChange:p,max:300,step:25,className:"mb-2"}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:["$",c[0]]}),e.jsxs("span",{children:["$",c[1]]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Category"}),e.jsx("div",{className:"space-y-2",children:["Adventure","Cultural","Food & Drink","Nature","Sightseeing","Water Sports","Wellness","Photography","Wildlife","Historical","Nightlife","Shopping"].map(r=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{id:`category-${r}`,checked:t.category.includes(r),onCheckedChange:m=>B(r,m)}),e.jsx("label",{htmlFor:`category-${r}`,className:"text-sm",children:r})]},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Duration"}),e.jsxs(j,{value:t.duration,onValueChange:r=>n({...t,duration:r}),children:[e.jsx(v,{children:e.jsx(N,{})}),e.jsxs(b,{children:[e.jsx(i,{value:"any",children:"Any duration"}),e.jsx(i,{value:"short",children:"Up to 3 hours"}),e.jsx(i,{value:"half-day",children:"Half day (3-6 hours)"}),e.jsx(i,{value:"full-day",children:"Full day (6+ hours)"}),e.jsx(i,{value:"multi-day",children:"Multi-day"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Difficulty"}),e.jsxs(j,{value:t.difficulty,onValueChange:r=>n({...t,difficulty:r}),children:[e.jsx(v,{children:e.jsx(N,{})}),e.jsxs(b,{children:[e.jsx(i,{value:"any",children:"Any difficulty"}),e.jsx(i,{value:"easy",children:"Easy"}),e.jsx(i,{value:"moderate",children:"Moderate"}),e.jsx(i,{value:"challenging",children:"Challenging"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Age Group"}),e.jsxs(j,{value:t.ageGroup,onValueChange:r=>n({...t,ageGroup:r}),children:[e.jsx(v,{children:e.jsx(N,{})}),e.jsxs(b,{children:[e.jsx(i,{value:"any",children:"Any age"}),e.jsx(i,{value:"family",children:"Family Friendly"}),e.jsx(i,{value:"adult",children:"Adults Only"}),e.jsx(i,{value:"senior",children:"Senior Friendly"}),e.jsx(i,{value:"kids",children:"Kids Special"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Group Size"}),e.jsxs(j,{value:t.groupSize,onValueChange:r=>n({...t,groupSize:r}),children:[e.jsx(v,{children:e.jsx(N,{})}),e.jsxs(b,{children:[e.jsx(i,{value:"any",children:"Any size"}),e.jsx(i,{value:"small",children:"Small (1-6 people)"}),e.jsx(i,{value:"medium",children:"Medium (7-15 people)"}),e.jsx(i,{value:"large",children:"Large (16+ people)"}),e.jsx(i,{value:"private",children:"Private Tour"})]})]})]})]})]})}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"}),e.jsxs(j,{value:d,onValueChange:x,children:[e.jsx(v,{className:"w-48",children:e.jsx(N,{})}),e.jsxs(b,{children:[e.jsx(i,{value:"price",children:"Best Price"}),e.jsx(i,{value:"rating",children:"Highest Rated"}),e.jsx(i,{value:"duration",children:"Duration"})]})]})]}),e.jsxs(S,{variant:"secondary",children:[A.length," activities found"]})]}),P&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[...Array(6)].map((r,m)=>e.jsx(y,{className:"animate-pulse",children:e.jsxs(w,{className:"p-6",children:[e.jsx("div",{className:"h-40 bg-muted rounded mb-4"}),e.jsx("div",{className:"h-6 bg-muted rounded mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded"})]})},m))}),k&&e.jsx(y,{children:e.jsx(w,{className:"p-6 text-center",children:e.jsxs("p",{className:"text-destructive",children:["Error loading activities: ",k]})})}),!P&&!k&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[A.map(r=>e.jsx(te,{activity:r},r.id)),A.length===0&&e.jsx("div",{className:"col-span-2",children:e.jsx(y,{children:e.jsx(w,{className:"p-6 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No activities found matching your criteria"})})})})]})]})]})]})]})})};export{We as default};
