import{r as h,j as e,f,A as M,T as A,q as w,a as p,d as j,e as g,i as v,b,B as N,w as y}from"./index-4Iw_Ltix-1760114379313.js";import{S as C}from"./switch-CXCaPesb-1760114379313.js";import{S as T}from"./smartphone-HKi5r1OX-1760114379313.js";import{K as k}from"./key-dzT7gVKW-1760114379313.js";import{S as F}from"./shield-BoMairJQ-1760114379313.js";import{C as r}from"./circle-check-big-B1l1SsQm-1760114379313.js";import"./index-CuWiMqUo-1760114379313.js";function K(){var u,x;const[i,S]=h.useState([{id:"totp",name:"Time-based OTP (TOTP)",description:"Use authenticator apps like Google Authenticator or Authy",enabled:!1,icon:e.jsx(T,{className:"h-5 w-5"}),status:"recommended"},{id:"sms",name:"SMS Verification",description:"Receive verification codes via SMS",enabled:!1,icon:e.jsx(k,{className:"h-5 w-5"}),status:"inactive"},{id:"email",name:"Email Verification",description:"Receive verification codes via email",enabled:!0,icon:e.jsx(F,{className:"h-5 w-5"}),status:"active"}]),[l,c]=h.useState(!1),d=async s=>{c(!0);try{await new Promise(t=>setTimeout(t,1e3)),S(t=>t.map(n=>n.id===s?{...n,enabled:!n.enabled,status:n.enabled?"inactive":"active"}:n));const a=i.find(t=>t.id===s);y.success(`${a==null?void 0:a.name} ${a!=null&&a.enabled?"disabled":"enabled"} successfully`)}catch{y.error("Failed to update MFA configuration")}finally{c(!1)}},o=i.filter(s=>s.enabled),m=Math.min(100,o.length*30+10);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Multi-Factor Authentication"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure additional security layers for admin access"})]}),e.jsxs(f,{variant:m>=70?"default":"destructive",children:["Security Score: ",m,"%"]})]}),o.length<2&&e.jsxs(M,{children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx(w,{children:"Your project has insufficient MFA options enabled. Enable at least 2 methods for optimal security."})]}),e.jsx("div",{className:"grid gap-4",children:i.map(s=>e.jsxs(p,{className:"border-l-4 border-l-primary/20",children:[e.jsx(j,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.icon,e.jsxs("div",{children:[e.jsx(g,{className:"text-lg",children:s.name}),e.jsx(v,{children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(f,{variant:s.status==="active"?"default":s.status==="recommended"?"secondary":"outline",children:[s.status==="active"&&e.jsx(r,{className:"h-3 w-3 mr-1"}),s.status]}),e.jsx(C,{checked:s.enabled,onCheckedChange:()=>d(s.id),disabled:l})]})]})}),s.enabled&&s.id==="totp"&&e.jsx(b,{children:e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Setup Instructions:"}),e.jsxs("ol",{className:"text-sm space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Install an authenticator app (Google Authenticator, Authy, etc.)"}),e.jsx("li",{children:"Scan the QR code or enter the secret key manually"}),e.jsx("li",{children:"Enter the 6-digit code to verify setup"})]})]})})]},s.id))}),e.jsxs(p,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Security Recommendations"}),e.jsx(v,{children:"Best practices for MFA implementation"})]}),e.jsxs(b,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:"h-5 w-5 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Enable TOTP (Recommended)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Most secure option that works offline and doesn't rely on SMS/email delivery"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:"h-5 w-5 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Backup Methods"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable multiple MFA methods to prevent account lockouts"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:"h-5 w-5 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Regular Security Audits"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Review MFA configurations monthly and remove unused methods"})]})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(N,{onClick:()=>d("totp"),disabled:l,variant:(u=i.find(s=>s.id==="totp"))!=null&&u.enabled?"outline":"default",children:[(x=i.find(s=>s.id==="totp"))!=null&&x.enabled?"Disable":"Enable"," TOTP"]}),e.jsx(N,{variant:"outline",disabled:l,children:"Test MFA Configuration"})]})]})}export{K as MFAConfiguration};
